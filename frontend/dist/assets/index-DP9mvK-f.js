const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Blt0uD8X.js","assets/vendor-DnY-W9X-.js"])))=>i.map(i=>d[i]);
import{r as o,a as st,R as Pe,u as rt,L as Ue,b as it,c as _e,B as ot}from"./vendor-DnY-W9X-.js";import{f as he,p as qe,C as B,B as Re,J as Ye,a as lt}from"./ethers-Bg9Q1_ah.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))i(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const u of y.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function r(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function i(p){if(p.ep)return;p.ep=!0;const y=r(p);fetch(p.href,y)}})();var Ge={exports:{}},Ee={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dt=o,ct=Symbol.for("react.element"),ut=Symbol.for("react.fragment"),pt=Object.prototype.hasOwnProperty,mt=dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yt={key:!0,ref:!0,__self:!0,__source:!0};function Je(n,a,r){var i,p={},y=null,u=null;r!==void 0&&(y=""+r),a.key!==void 0&&(y=""+a.key),a.ref!==void 0&&(u=a.ref);for(i in a)pt.call(a,i)&&!yt.hasOwnProperty(i)&&(p[i]=a[i]);if(n&&n.defaultProps)for(i in a=n.defaultProps,a)p[i]===void 0&&(p[i]=a[i]);return{$$typeof:ct,type:n,key:y,ref:u,props:p,_owner:mt.current}}Ee.Fragment=ut;Ee.jsx=Je;Ee.jsxs=Je;Ge.exports=Ee;var e=Ge.exports,Ke,ze=st;Ke=ze.createRoot,ze.hydrateRoot;const gt=[{inputs:[{internalType:"address",name:"_centralStonerFeePool",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidERC721",type:"error"},{inputs:[],name:"InvalidShareRange",type:"error"},{inputs:[],name:"PoolAlreadyExists",type:"error"},{inputs:[],name:"PoolDoesNotExist",type:"error"},{inputs:[],name:"ZeroAddressNotAllowed",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"swapFeeInWei",type:"uint256"},{indexed:!1,internalType:"uint256",name:"stonerShare",type:"uint256"}],name:"DefaultFeesUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"centralStonerFeePool",type:"address"},{indexed:!0,internalType:"address",name:"deployer",type:"address"}],name:"FactoryDeployed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftCollection",type:"address"},{indexed:!0,internalType:"address",name:"swapPool",type:"address"}],name:"PoolDeactivated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftCollection",type:"address"},{indexed:!0,internalType:"address",name:"swapPool",type:"address"},{indexed:!0,internalType:"address",name:"stakeReceipt",type:"address"},{indexed:!1,internalType:"address",name:"creator",type:"address"}],name:"PoolPairCreated",type:"event"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"allCollections",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"allPools",outputs:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"},{internalType:"bool",name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"centralStonerFeePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"collectionToPool",outputs:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"uint256",name:"customSwapFee",type:"uint256"},{internalType:"uint256",name:"customStonerShare",type:"uint256"}],name:"createPoolPair",outputs:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"}],name:"deactivatePool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"defaultStonerShare",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"defaultSwapFeeInWei",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getActivePools",outputs:[{components:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"},{internalType:"bool",name:"active",type:"bool"}],internalType:"struct MultiPoolFactoryNonProxy.PoolData[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllCollections",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllPools",outputs:[{components:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"},{internalType:"bool",name:"active",type:"bool"}],internalType:"struct MultiPoolFactoryNonProxy.PoolData[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getFactoryStats",outputs:[{internalType:"uint256",name:"totalPools",type:"uint256"},{internalType:"address",name:"centralPool",type:"address"},{internalType:"uint256",name:"defaultFee",type:"uint256"},{internalType:"uint256",name:"defaultShare",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"collections",type:"address[]"}],name:"getMultiplePoolInfos",outputs:[{components:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"}],internalType:"struct MultiPoolFactoryNonProxy.PoolInfo[]",name:"poolInfos",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"}],name:"getPoolInfo",outputs:[{components:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"}],internalType:"struct MultiPoolFactoryNonProxy.PoolInfo",name:"poolInfo",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"poolCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"}],name:"poolExists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"}],name:"registerPoolPair",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newSwapFeeInWei",type:"uint256"},{internalType:"uint256",name:"newStonerShare",type:"uint256"}],name:"setDefaultFees",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],ht=[{inputs:[{internalType:"string",name:"name_",type:"string"},{internalType:"string",name:"symbol_",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidURI",type:"error"},{inputs:[],name:"NonTransferable",type:"error"},{inputs:[],name:"OnlyPool",type:"error"},{inputs:[],name:"PoolAlreadySet",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"newBaseURI",type:"string"}],name:"BaseURIUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"pool",type:"address"}],name:"PoolSet",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"receiptTokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"originalTokenId",type:"uint256"}],name:"ReceiptBurned",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"originalTokenId",type:"uint256"}],name:"mint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"originalTokenIds",type:"uint256[]"}],name:"batchMint",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"receiptTokenIds",type:"uint256[]"}],name:"batchBurn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserReceipts",outputs:[{internalType:"uint256[]",name:"receipts",type:"uint256[]"},{internalType:"uint256[]",name:"originalTokens",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"getOriginalTokenId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"getReceiptInfo",outputs:[{internalType:"uint256",name:"originalTokenId",type:"uint256"},{internalType:"uint256",name:"mintTime",type:"uint256"},{internalType:"address",name:"originalMinter",type:"address"},{internalType:"uint256",name:"age",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserReceiptHistory",outputs:[{internalType:"uint256[]",name:"receiptIds",type:"uint256[]"},{internalType:"uint256[]",name:"originalTokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"mintTimes",type:"uint256[]"},{internalType:"uint256[]",name:"ages",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCollectionTimeline",outputs:[{internalType:"uint256",name:"totalMinted",type:"uint256"},{internalType:"uint256",name:"totalBurned",type:"uint256"},{internalType:"uint256",name:"currentSupply",type:"uint256"},{internalType:"uint256",name:"averageAge",type:"uint256"},{internalType:"uint256",name:"oldestActive",type:"uint256"},{internalType:"uint256",name:"newestActive",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserReceiptPortfolio",outputs:[{internalType:"uint256",name:"totalReceipts",type:"uint256"},{internalType:"uint256",name:"averageHoldingTime",type:"uint256"},{internalType:"uint256",name:"totalOriginalValue",type:"uint256"},{internalType:"uint256[]",name:"receiptIds",type:"uint256[]"},{internalType:"uint256[]",name:"originalTokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"holdingDurations",type:"uint256[]"},{internalType:"address[]",name:"poolAddresses",type:"address[]"},{internalType:"uint256",name:"oldestReceiptAge",type:"uint256"},{internalType:"uint256",name:"newestReceiptAge",type:"uint256"},{internalType:"bool",name:"hasLongTermHoldings",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"},{internalType:"address",name:"expectedPool",type:"address"}],name:"validateReceipt",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"uri",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_pool",type:"address"}],name:"setPool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"pool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptToOriginalToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptMintTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"approve",outputs:[],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"bool",name:"",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"pure",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"pure",type:"function"}],ke=[{inputs:[{internalType:"address",name:"_nftCollection",type:"address"},{internalType:"address",name:"_receiptContract",type:"address"},{internalType:"address",name:"_stonerPool",type:"address"},{internalType:"uint256",name:"_swapFeeInWei",type:"uint256"},{internalType:"uint256",name:"_stonerShare",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyInitialized",type:"error"},{inputs:[],name:"IncorrectFee",type:"error"},{inputs:[],name:"InvalidReceiptToken",type:"error"},{inputs:[],name:"InvalidStonerShare",type:"error"},{inputs:[],name:"NoRewardsToClaim",type:"error"},{inputs:[],name:"NoTokensAvailable",type:"error"},{inputs:[],name:"NotInitialized",type:"error"},{inputs:[],name:"NotSlotOwner",type:"error"},{inputs:[],name:"NotTokenOwner",type:"error"},{inputs:[],name:"SameTokenSwap",type:"error"},{inputs:[],name:"SlotNotActive",type:"error"},{inputs:[],name:"TokenNotApproved",type:"error"},{inputs:[],name:"TokenUnavailable",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newMaxBatchSize",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newMaxUnstakeAll",type:"uint256"}],name:"BatchLimitsUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"swapCount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"totalFeePaid",type:"uint256"}],name:"BatchSwapExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256[]",name:"receiptTokenIds",type:"uint256[]"},{indexed:!1,internalType:"uint256[]",name:"tokensReceived",type:"uint256[]"}],name:"BatchUnstaked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"stonerAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"rewardsAmount",type:"uint256"}],name:"FeeSplit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardsClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardsDistributed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"slotId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newShare",type:"uint256"}],name:"StonerShareUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenIdIn",type:"uint256"},{indexed:!1,internalType:"uint256",name:"tokenIdOut",type:"uint256"},{indexed:!1,internalType:"uint256",name:"slotId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"feePaid",type:"uint256"}],name:"SwapExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newFeeInWei",type:"uint256"}],name:"SwapFeeUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"slotId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"Unstaked",type:"event"},{inputs:[],name:"claimRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"emergencyWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"emergencyWithdrawETH",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"exit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getContractInfo",outputs:[{internalType:"address",name:"nft",type:"address"},{internalType:"address",name:"receipt",type:"address"},{internalType:"address",name:"stoner",type:"address"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"share",type:"uint256"},{internalType:"uint256",name:"poolSize",type:"uint256"},{internalType:"uint256",name:"stakedCount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolSize",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserActiveSlotCount",outputs:[{internalType:"uint256",name:"count",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserSlots",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserStakes",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"initialized",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"lastUpdateTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxBatchSize",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxUnstakeAllLimit",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextSlotId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftCollection",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"pendingRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"poolSlots",outputs:[{internalType:"address",name:"originalStaker",type:"address"},{internalType:"uint256",name:"stakedAt",type:"uint256"},{internalType:"bool",name:"active",type:"bool"},{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"poolTokens",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiptContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptToSlot",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rewardPerToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"newMaxBatchSize",type:"uint256"},{internalType:"uint256",name:"newMaxUnstakeAll",type:"uint256"}],name:"setBatchLimits",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newShare",type:"uint256"}],name:"setStonerShare",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newFeeInWei",type:"uint256"}],name:"setSwapFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"stakeNFT",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"stakeNFTBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"stonerPool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"stonerShare",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"swapFeeInWei",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenIdIn",type:"uint256"}],name:"swapNFT",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIdsIn",type:"uint256[]"}],name:"swapNFTBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tokenIndexInPool",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalActiveSlots",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalRewardsDistributed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unstakeAllNFTs",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"unstakeNFT",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"receiptTokenIds",type:"uint256[]"}],name:"unstakeNFTBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"userRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"userSlots",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];function Ie({image:n,tokenId:a,size:r=64,isReceiptToken:i=!1,poolSlotId:p,name:y}){const[u,f]=Pe.useState(!1),[t,d]=Pe.useState(!0);return i&&n&&!u?e.jsxs("div",{className:"relative",style:{width:r,height:r},children:[t&&e.jsx("div",{style:{width:r,height:r},className:"absolute inset-0 bg-gradient-to-br from-yellow-100 to-amber-200 dark:from-yellow-900/30 dark:to-amber-900/30 rounded-lg flex items-center justify-center animate-pulse border-2 border-yellow-300 dark:border-yellow-600",children:e.jsx("div",{className:"w-4 h-4 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin"})}),e.jsx("img",{src:n,alt:y||`Receipt Token #${a}`,style:{width:r,height:r},className:`object-cover rounded-lg border-2 border-yellow-400 dark:border-yellow-500 shadow-md ${t?"opacity-0":"opacity-100"} transition-opacity duration-200`,onLoad:()=>d(!1),onError:()=>f(!0)}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-[8px]",children:"🧾"})})]}):!n||u?i?e.jsx("div",{style:{width:r,height:r},className:"bg-gradient-to-br from-yellow-100 to-amber-200 dark:from-yellow-900/30 dark:to-amber-900/30 rounded-lg flex items-center justify-center text-yellow-800 dark:text-yellow-200 text-xs font-mono border-2 border-yellow-300 dark:border-yellow-600 shadow-md",title:y||`Receipt Token #${a}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"🧾"}),e.jsxs("div",{className:"text-[10px]",children:["#",p||a]})]})}):e.jsx("div",{style:{width:r,height:r},className:"bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-400 text-xs font-mono border border-gray-300 dark:border-gray-600 shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"🖼️"}),e.jsxs("div",{children:["#",a]})]})}):e.jsxs("div",{className:"relative",style:{width:r,height:r},children:[t&&e.jsx("div",{style:{width:r,height:r},className:"absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 rounded-lg flex items-center justify-center animate-pulse",children:e.jsx("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"})}),e.jsx("img",{src:n,alt:`NFT #${a}`,style:{width:r,height:r},className:"rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 object-cover",onError:()=>f(!0),onLoad:()=>d(!1)})]})}function $e({count:n=6,size:a=56}){return e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:Array.from({length:n}).map((r,i)=>e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"shimmer rounded-xl border-2 border-gray-200 dark:border-gray-700 shadow-sm",style:{width:a+8,height:a+32},children:[e.jsx("div",{className:"bg-gray-300 dark:bg-gray-600 rounded-lg m-1 animate-pulse",style:{width:a,height:a}}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-600 rounded mx-2 mt-2 animate-pulse"})]})},i))})}const Ze=o.createContext(),Le=()=>{const n=o.useContext(Ze);if(!n)throw new Error("useToast must be used within a ToastProvider");return n};function ft({children:n}){const[a,r]=o.useState([]),i=o.useCallback((d,l="info",h=5e3,v=null)=>{const x=Date.now()+Math.random(),V={id:x,message:d,type:l,txHash:v,createdAt:Date.now()};return r(M=>[...M,V]),h>0&&setTimeout(()=>{r(M=>M.filter(O=>O.id!==x))},h),x},[]),p=o.useCallback(d=>{r(l=>l.filter(h=>h.id!==d))},[]),y=o.useCallback((d,l=null,h=5e3)=>i(d,"success",h,l),[i]),u=o.useCallback((d,l=7e3)=>i(d,"error",l),[i]),f=o.useCallback((d,l=5e3)=>i(d,"info",l),[i]),t=o.useCallback((d,l=null)=>i(d,"loading",0,l),[i]);return e.jsxs(Ze.Provider,{value:{success:y,error:u,info:f,loading:t,removeToast:p},children:[n,e.jsx(xt,{toasts:a,onRemove:p})]})}function xt({toasts:n,onRemove:a}){return e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 pointer-events-none",children:n.map(r=>e.jsx(bt,{toast:r,onRemove:a},r.id))})}function bt({toast:n,onRemove:a}){const r=()=>{switch(n.type){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200";case"loading":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200";default:return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-800 text-gray-800 dark:text-gray-200"}},i=()=>{switch(n.type){case"success":return e.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})});case"error":return e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})});case"loading":return e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"});default:return e.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"ℹ"})})}};return e.jsx("div",{className:`max-w-md w-full p-4 rounded-xl border shadow-lg backdrop-blur-sm pointer-events-auto transform transition-all duration-300 animate-slide-in ${r()}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[i(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:n.message}),n.txHash&&e.jsx("a",{href:`https://sonicscan.org/tx/${n.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs underline opacity-75 hover:opacity-100 transition-opacity mt-1 inline-block",children:"View Transaction →"})]}),e.jsx("button",{onClick:()=>a(n.id),className:"opacity-50 hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}function wt(){const[n,a]=o.useState({}),r=Le();return{startTransaction:(d,l="Transaction pending...")=>{const h=r.loading(l);a(v=>({...v,[d]:{status:"pending",message:l,toastId:h,startTime:Date.now()}}))},updateTransaction:(d,l,h)=>{a(v=>{const x=v[d];if(!x)return v;r.removeToast(x.toastId);const V=r.success(h,l);return{...v,[d]:{...x,status:"success",txHash:l,message:h,toastId:V}}})},failTransaction:(d,l)=>{a(h=>{const v=h[d];if(!v)return h;r.removeToast(v.toastId);let x="Transaction failed";l!=null&&l.message&&(l.message.includes("user rejected")?x="Transaction cancelled by user":l.message.includes("insufficient funds")?x="Insufficient funds for transaction":x=l.message);const V=r.error(x);return{...h,[d]:{...v,status:"failed",message:x,toastId:V}}})},clearTransaction:d=>{a(l=>{const h=l[d];h!=null&&h.toastId&&r.removeToast(h.toastId);const{[d]:v,...x}=l;return x})},isTransactionPending:d=>{var l;return((l=n[d])==null?void 0:l.status)==="pending"},getTransactionState:d=>n[d]||null}}function Qe(){const n=wt();return Le(),{...n,executeTransaction:async(r,i,p={})=>{const{pendingMessage:y="Transaction pending...",successMessage:u="Transaction successful!",onSuccess:f,onError:t}=p;try{n.startTransaction(r,y);const d=await i();let l=null,h=u;if(d!=null&&d.hash&&(l=d.hash,d.wait&&(await d.wait()).status===0))throw new Error("Transaction failed during execution");return n.updateTransaction(r,l,h),f&&f(d),d}catch(d){throw console.error(`Transaction ${r} failed:`,d),n.failTransaction(r,d),t&&t(d),d}}}}function vt({walletNFTs:n,poolNFTs:a,loading:r,onSwap:i,status:p,swapFee:y,provider:u,userAddress:f}){const[t,d]=o.useState([]),[l,h]=o.useState("0"),[v,x]=o.useState(!1),V=Le(),{executeTransaction:M,isTransactionPending:O}=Qe(),re=async()=>{if(!u||!f||!y||t.length===0){x(!1);return}try{const P=await u.getBalance(f);h(P.toString());const E=qe((parseFloat(y)*t.length).toString()),ae=P<E;x(ae)}catch(P){console.error("Error checking balance:",P),x(!1)}};o.useEffect(()=>{re()},[t.length,y,f,u]);const ie=async()=>{if(t.length===0){V.error("Please select NFTs to swap");return}try{await M("swap",()=>i(t),{pendingMessage:`Swapping ${t.length} NFT${t.length>1?"s":""}...`,successMessage:`Successfully swapped ${t.length} NFT${t.length>1?"s":""}!`,onSuccess:()=>{d([])},onError:P=>{console.error("Swap failed:",P)}})}catch{}},A=O("swap");return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 1H4m0 0l4 4M4 12l4-4"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-indigo-400 bg-clip-text text-transparent",children:"Swap Your NFTs"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Exchange your NFTs with those available in the pool"})]})]})}),e.jsx("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-3 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selected:"}),e.jsxs("div",{className:`px-2 py-1 rounded-full text-sm font-medium ${t.length>8?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300":t.length>0?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400"}`,children:[t.length,"/10 NFTs"]})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Max 10 per batch"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("h3",{className:"text-base font-semibold text-gray-800 dark:text-gray-200",children:["Your NFTs (",n.length,")"]})]}),e.jsx("div",{className:"bg-white/75 dark:bg-gray-800/75 rounded-xl p-3 border border-gray-200 dark:border-gray-700",children:r?e.jsx($e,{count:6,size:56}):n.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-3xl mb-2",children:"🖼️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No NFTs found in your wallet"})]}):e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:n.map(P=>e.jsxs("button",{className:`relative border-2 rounded-lg p-1.5 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-sm transition-all duration-200 ${t.includes(P.tokenId)?"border-blue-400 scale-105 ring-2 ring-blue-400/50 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-blue-300 hover:shadow-md"} ${t.length>=10&&!t.includes(P.tokenId)?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{t.includes(P.tokenId)?d(E=>E.filter(ae=>ae!==P.tokenId)):t.length<10&&d(E=>[...E,P.tokenId])},disabled:r||t.length>=10&&!t.includes(P.tokenId),children:[e.jsx(Ie,{image:P.image,tokenId:P.tokenId,size:56}),e.jsxs("div",{className:"text-xs text-center mt-1 font-mono text-gray-500 dark:text-gray-400",children:["#",P.tokenId]}),t.includes(P.tokenId)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},P.tokenId))})})]}),e.jsxs("div",{className:"bg-white/95 dark:bg-gray-800/95 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:[t.length>0&&y&&e.jsxs("div",{className:"flex items-center justify-between mb-3 px-3 py-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsxs("span",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:["Total Cost: ",(parseFloat(y)*t.length).toFixed(2)," S"]})]}),e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:[t.length," × ",parseFloat(y).toFixed(2)," S"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:`flex-1 px-6 py-4 text-white rounded-xl shadow-lg font-semibold text-lg tracking-wide transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 ${a.length===0?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":A?"bg-gradient-to-r from-blue-400 to-indigo-400 animate-pulse-glow":"bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 hover:shadow-xl hover:scale-105"}`,onClick:ie,disabled:A||t.length===0||a.length===0,title:a.length===0?"Pool is empty - stake NFTs first to enable swapping":"",children:A?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Swapping"})]}):a.length===0?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Pool Empty - Stake NFTs First"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 1H4m0 0l4 4M4 12l4-4"})}),y?`Swap ${t.length} NFT${t.length>1?"s":""} (${(parseFloat(y)*t.length).toFixed(2)} S)`:`Swap Selected NFTs (${t.length})`]})}),t.length>0&&!A&&e.jsxs("button",{className:"px-4 py-4 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl shadow hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",onClick:()=>d([]),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})]}),v&&t.length>0&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 mt-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/40 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-red-800 dark:text-red-200 mb-1",children:"Insufficient Balance"}),e.jsxs("p",{className:"text-xs text-red-700 dark:text-red-300",children:["You need ",(parseFloat(y)*t.length).toFixed(4)," S to swap ",t.length," NFT",t.length>1?"s":"",", but you only have ",he(l)," S available."]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please add more funds to your wallet or reduce the number of NFTs to swap."})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("h3",{className:"text-base font-semibold text-gray-800 dark:text-gray-200",children:["Available in Pool (",a.length,")"]})]}),e.jsx("div",{className:"bg-white/75 dark:bg-gray-800/75 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:r?e.jsx($e,{count:6,size:48}):a.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-3xl mb-2",children:"🏊‍♂️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Pool is empty - stake NFTs first to enable swapping"})]}):e.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:a.map(P=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-1.5 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-sm",children:[e.jsx(Ie,{image:P.image,tokenId:P.tokenId,size:48}),e.jsxs("div",{className:"text-xs text-center mt-1 font-mono text-gray-500 dark:text-gray-400",children:["#",P.tokenId]})]},P.tokenId))})})})]}),p&&e.jsx("div",{className:`p-4 rounded-xl border transition-all duration-300 ${p.includes("successful")||p.includes("Swap successful")?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200":p.includes("failed")||p.includes("error")||p.includes("❌")?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":p.includes("Swapping")?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200":"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-800 dark:text-amber-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:p.includes("successful")||p.includes("Swap successful")?e.jsx("div",{className:"w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):p.includes("failed")||p.includes("error")||p.includes("❌")?e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}):p.includes("Swapping")?e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):e.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm leading-5",children:p}),p.includes("Swapping")&&e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"This may take a few moments to complete..."})]})]})})]})}function kt({nftAddress:n,tokenId:a,spender:r,provider:i,onApproved:p,disabled:y}){const[u,f]=o.useState(!1),[t,d]=o.useState(!1),[l,h]=o.useState("");o.useEffect(()=>{if(d(!1),h(""),!n||!a||!r||!i)return;(async()=>{try{const M=await new B(n,["function getApproved(uint256) view returns (address)","function approve(address,uint256) external"],i).getApproved(a);d(M.toLowerCase()===r.toLowerCase())}catch{h("Failed to check approval")}})()},[n,a,r,i]);const v=async()=>{f(!0),h("");try{if(!window.ethereum)throw new Error("Wallet not found");const x=new Re(window.ethereum).getSigner();await(await new B(n,["function approve(address,uint256) external"],await x).approve(r,a)).wait(),d(!0),p&&p()}catch(x){h(x.reason||x.message)}f(!1)};return a?t?e.jsxs("div",{className:"flex items-center gap-1 ml-2 px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-lg text-xs font-medium border border-green-200 dark:border-green-700",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Approved"]}):e.jsx("button",{className:"ml-2 px-3 py-1.5 bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 text-white rounded-lg text-xs font-medium shadow-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",onClick:v,disabled:u||y,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve"]})}):null}function Tt({walletNFTs:n,receiptNFTs:a,stakedNFTs:r,loading:i,receiptLoading:p,onStake:y,onUnstake:u,onClaimRewards:f,status:t,approvedMap:d,isApprovedForAll:l,onApproveAll:h,approvingAll:v,nftCollection:x,swapPool:V,provider:M,pendingRewards:O="0",stakerShare:re=null,swapFee:ie=null}){console.log("🖼️ StakingInterface received props:",{walletNFTs:(n==null?void 0:n.length)||0,receiptNFTs:(a==null?void 0:a.length)||0,stakedNFTs:(r==null?void 0:r.length)||0,receiptLoading:p,pendingRewards:O});const[A,P]=o.useState([]),[E,ae]=o.useState([]),pe=Le(),{executeTransaction:fe,isTransactionPending:H}=Qe(),Te=async()=>{if(A.length===0){pe.error("Please select NFTs to stake");return}try{await fe("stake",()=>y(A),{pendingMessage:`Staking ${A.length} NFT${A.length>1?"s":""}...`,successMessage:`Successfully staked ${A.length} NFT${A.length>1?"s":""}!`,onSuccess:()=>{P([])}})}catch{}},xe=async()=>{if(E.length===0){pe.error("Please select staked NFTs to unstake");return}try{await fe("unstake",()=>u(E),{pendingMessage:`Unstaking ${E.length} NFT${E.length>1?"s":""}...`,successMessage:`Successfully unstaked ${E.length} NFT${E.length>1?"s":""}!`,onSuccess:()=>{ae([])}})}catch{}},me=async()=>{if(O==="0"||O==="0.0"){pe.info("No rewards to claim at the moment");return}try{await fe("claim",()=>f(),{pendingMessage:"Claiming rewards...",successMessage:`Successfully claimed ${O} S tokens!`})}catch{}},be=A.length>0&&A.every(W=>d[W]||l),we=H("stake"),Ne=H("unstake"),oe=H("claim");return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent",children:"Stake Your NFTs"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Stake NFTs to earn rewards and contribute to the swap pool"})]})]})}),r.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 rounded-xl p-6 border border-yellow-200 dark:border-yellow-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-xl flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"💰"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-800 dark:text-yellow-200",children:"Staking Rewards"}),e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Earn from swap fees and trading activity"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-yellow-800 dark:text-yellow-200",children:[parseFloat(O).toFixed(4)," S"]}),e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Pending Rewards"})]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-yellow-600/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-500/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-400 text-sm",children:"💎"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-yellow-200",children:"Swap Fee Earnings"}),e.jsx("div",{className:"text-xs text-yellow-300/70",children:"From your staked NFTs generating trading fees"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-yellow-200",children:[r.length," NFT",r.length!==1?"s":""]}),e.jsx("div",{className:"text-xs text-yellow-300/70",children:"Currently Staked"})]})]}),re!==null&&ie!==null&&e.jsx("div",{className:"mb-3 p-3 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg border border-blue-500/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400 text-sm",children:"📊"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-200",children:"Staker Fee Share"}),e.jsxs("div",{className:"text-xs text-blue-300/70",children:["Of each ",ie," S swap fee"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-200",children:[re,"%"]}),e.jsx("div",{className:"text-xs text-blue-300/70",children:"Goes to Stakers"})]})]})}),e.jsx("button",{onClick:me,disabled:oe||parseFloat(O)===0,className:`w-full px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${oe?"bg-gradient-to-r from-yellow-400 to-amber-400 animate-pulse-glow":"bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600"}`,children:oe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Claiming"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15V3m0 12l-4-4m4 4l4-4m5 4v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6m14-4V5a2 2 0 00-2-2H9a2 2 0 00-2 2v6m10 0V9a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"})}),parseFloat(O)>0?`Claim ${parseFloat(O).toFixed(4)} S`:"No Rewards Available"]})})]}),parseFloat(O)===0&&r.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"text-xs text-yellow-300/60 bg-yellow-900/30 px-3 py-2 rounded-lg border border-yellow-700/30",children:["💡 ",e.jsx("strong",{children:"Tip:"})," Rewards accumulate as users swap NFTs in this pool. Check back later!"]})})]}),e.jsx("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selected to Stake:"}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${A.length>0?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-300":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 border border-gray-300"}`,children:[A.length," NFTs"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selected to Unstake:"}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${E.length>0?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-300":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 border border-gray-300"}`,children:[E.length," NFTs"]})]})]})}),n.length>0&&!l&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4 border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-200",children:"Approval Required"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Approve all NFTs for easier staking"})]})]}),e.jsx("button",{onClick:h,disabled:v,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve All"]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Available to Stake (",n.length,")"]})]}),e.jsx("div",{className:"min-h-[120px] bg-white/75 dark:bg-gray-800/75 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:i?e.jsx($e,{count:6,size:64}):n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🖼️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No NFTs available to stake"})]}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:n.map(W=>e.jsxs("div",{className:"relative",children:[e.jsxs("button",{className:`relative border-2 rounded-xl p-2 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-sm transition-all duration-200 w-full ${A.includes(W.tokenId)?"border-green-400 scale-105 ring-2 ring-green-400/50 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-green-300 hover:shadow-md"}`,onClick:()=>{A.includes(W.tokenId)?P(K=>K.filter(Me=>Me!==W.tokenId)):P(K=>[...K,W.tokenId])},disabled:i,children:[e.jsx(Ie,{image:W.image,tokenId:W.tokenId,size:64}),e.jsxs("div",{className:"text-xs text-center mt-2 font-mono text-gray-600 dark:text-gray-400",children:["#",W.tokenId]}),A.includes(W.tokenId)&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),!l&&!d[W.tokenId]&&A.includes(W.tokenId)&&e.jsx("div",{className:"mt-2",children:e.jsx(kt,{nftAddress:x,tokenId:W.tokenId,spender:V,provider:M,disabled:i})})]},W.tokenId))})})]}),console.log("🧪 Checking receiptNFTs for render:",a,a==null?void 0:a.length,(a==null?void 0:a.length)>0),a.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Currently Staked (",a.length,")"]})]}),e.jsx("div",{className:"min-h-[120px] bg-white/75 dark:bg-gray-800/75 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:p?e.jsx($e,{count:6,size:64}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:a.map(W=>e.jsxs("button",{className:`relative border-2 rounded-xl p-2 bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 shadow-sm transition-all duration-200 ${E.includes(W.tokenId)?"border-red-400 scale-105 ring-2 ring-red-400/50 shadow-lg":"border-yellow-200 dark:border-yellow-700 hover:border-red-300 hover:shadow-md"}`,onClick:()=>{E.includes(W.tokenId)?ae(K=>K.filter(Me=>Me!==W.tokenId)):ae(K=>[...K,W.tokenId])},disabled:i,children:[e.jsx(Ie,{image:W.image,tokenId:W.tokenId,size:64,isReceiptToken:W.isReceiptToken,poolSlotId:W.poolSlotId,name:W.name}),e.jsxs("div",{className:"text-xs text-center mt-2 font-mono text-yellow-700 dark:text-yellow-300",children:["#",W.tokenId]}),E.includes(W.tokenId)&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("div",{className:"absolute -bottom-1 -left-1 bg-yellow-500 text-white text-xs px-1 py-0.5 rounded text-[10px] font-bold",children:"STAKED"})]},W.tokenId))})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:`w-full px-6 py-4 text-white rounded-xl shadow-lg font-semibold text-lg tracking-wide transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 ${A.length===0||!be?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":we?"bg-gradient-to-r from-green-400 to-emerald-400 animate-pulse-glow":"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 hover:shadow-xl hover:scale-105"}`,onClick:Te,disabled:we||A.length===0||!be,children:we?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Staking"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),"Stake Selected (",A.length,")"]})}),A.length>0&&e.jsxs("button",{className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center justify-center gap-2",onClick:()=>P([]),disabled:i,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear Selection"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:`w-full px-6 py-4 text-white rounded-xl shadow-lg font-semibold text-lg tracking-wide transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 ${E.length===0?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":Ne?"bg-gradient-to-r from-red-400 to-pink-400 animate-pulse-glow":"bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 hover:shadow-xl hover:scale-105"}`,onClick:xe,disabled:Ne||E.length===0,children:Ne?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Unstaking"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z"})}),"Unstake Selected (",E.length,")"]})}),E.length>0&&e.jsxs("button",{className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center justify-center gap-2",onClick:()=>ae([]),disabled:i,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear Selection"]})]})]}),t&&e.jsx("div",{className:`p-4 rounded-xl border transition-all duration-300 ${t.includes("successful")||t.includes("claimed")||t.includes("Stake successful")||t.includes("Unstake successful")||t.includes("Rewards claimed")?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200":t.includes("failed")||t.includes("error")||t.includes("❌")||t.includes("Cannot")?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":t.includes("Staking...")||t.includes("Unstaking...")||t.includes("Claiming")?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200":"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-800 dark:text-amber-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:t.includes("successful")||t.includes("claimed")||t.includes("Stake successful")||t.includes("Unstake successful")||t.includes("Rewards claimed")?e.jsx("div",{className:"w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):t.includes("failed")||t.includes("error")||t.includes("❌")||t.includes("Cannot")?e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}):t.includes("Staking...")||t.includes("Unstaking...")||t.includes("Claiming")?e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):e.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm leading-5",children:t}),(t.includes("Staking...")||t.includes("Unstaking...")||t.includes("Claiming"))&&e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"This may take a few moments to complete..."})]})]})})]})}const Xe=o.createContext(),Be=()=>{const n=o.useContext(Xe);if(!n)throw new Error("useWallet must be used within a WalletProvider");return n},Nt=({children:n})=>{const[a,r]=o.useState(""),[i,p]=o.useState(null),[y,u]=o.useState(null),[f,t]=o.useState(!1),[d,l]=o.useState(!1);o.useEffect(()=>{(async()=>{if(window.ethereum)try{(await window.ethereum.request({method:"eth_accounts"})).length>0&&await h()}catch{console.log("No existing wallet connection found")}})()},[]),o.useEffect(()=>{const M=async re=>{re.length===0?v():re[0]!==a&&await h()},O=()=>{window.location.reload()};return window.ethereum&&(window.ethereum.on("accountsChanged",M),window.ethereum.on("chainChanged",O)),()=>{window.ethereum&&(window.ethereum.removeListener("accountsChanged",M),window.ethereum.removeListener("chainChanged",O))}},[a]);const h=async()=>{if(!window.ethereum)throw new Error("Please install MetaMask or another wallet");t(!0);try{await window.ethereum.request({method:"eth_requestAccounts"});const M=new Re(window.ethereum),O=await M.getSigner(),re=await O.getAddress(),ie=await M.getNetwork(),A=ie.chainId===146n;return p(M),u(O),r(re),l(A),console.log(`🔗 Wallet connected: ${re}`),console.log(`🌐 Network: ${ie.name} (${ie.chainId})`),A||console.warn("⚠️ Not on Sonic network"),{address:re,provider:M,signer:O,isCorrectNetwork:A}}catch(M){throw console.error("Wallet connection failed:",M),M}finally{t(!1)}},v=()=>{r(""),p(null),u(null),l(!1),console.log("🔌 Wallet disconnected")},V={address:a,provider:i,signer:y,isConnecting:f,isCorrectNetwork:d,connectWallet:h,disconnect:v,switchToSonicNetwork:async()=>{if(!window.ethereum)return!1;try{return await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x92"}]}),!0}catch(M){if(M.code===4902)try{return await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x92",chainName:"Sonic Network",nativeCurrency:{name:"Sonic",symbol:"S",decimals:18},rpcUrls:["https://rpc.soniclabs.com/"],blockExplorerUrls:["https://sonicscan.org/"]}]}),!0}catch(O){return console.error("Failed to add Sonic network:",O),!1}return console.error("Failed to switch to Sonic network:",M),!1}},isConnected:!!a};return e.jsx(Xe.Provider,{value:V,children:n})};function jt({swapPool:n,stakeReceipt:a,provider:r}){const{address:i,isConnected:p}=Be(),[y,u]=o.useState(null),[f,t]=o.useState(""),[d,l]=o.useState(!1),[h,v]=o.useState([]),[x,V]=o.useState({}),[M,O]=o.useState(null),[re,ie]=o.useState(!1),[A,P]=o.useState(!1),[E,ae]=o.useState([]),[pe,fe]=o.useState([]),[H,Te]=o.useState([]),[xe,me]=o.useState(!1),[be,we]=o.useState(!1),[Ne,oe]=o.useState(!1),[W,K]=o.useState(null),[Me,Se]=o.useState("0"),[c,I]=o.useState(null),[G,ye]=o.useState(null),[m,C]=o.useState(null),R=async()=>{if(!window.ethereum)throw new Error("Wallet not found");return new Re(window.ethereum).getSigner()},N=async s=>{var g,T;if(s.length===0){t("Please select at least one NFT to swap");return}if(s.length>10){t("You can only swap up to 10 NFTs at once.");return}if(H.length<s.length){H.length===0?t("❌ Cannot swap: Pool is empty! You need to stake some NFTs first to create liquidity for swapping."):t(`❌ Insufficient liquidity: Only ${H.length} NFT${H.length!==1?"s":""} available in pool, but you selected ${s.length}. Stake more NFTs or reduce your selection.`);return}l(!0),t("");try{const b=await R(),S=new B(n,ke,b),ee=new B(M,["function approve(address,uint256)","function getApproved(uint256) view returns (address)","function ownerOf(uint256) view returns (address)","function setApprovalForAll(address,bool)","function isApprovedForAll(address,address) view returns (bool)"],b),J=await b.getAddress();t("Verifying ownership and token validity...");for(const k of s)try{const ce=await ee.ownerOf(k);if(ce.toLowerCase()!==J.toLowerCase()){t(`❌ You don't own NFT #${k}`),l(!1);return}const ne=await S.getPoolTokens(),Y=ne.map(X=>X.toString());if(console.log(`🔍 Debug - Token #${k} check:`,{tokenId:k.toString(),owner:ce,poolTokensCount:ne.length,isInPool:Y.includes(k.toString())}),Y.includes(k.toString())){t(`❌ NFT #${k} is already in the pool and cannot be swapped`),l(!1);return}}catch(ce){(g=ce.reason)!=null&&g.includes("ERC721: invalid token ID")||(T=ce.reason)!=null&&T.includes("ERC721: owner query for nonexistent token")?t(`❌ NFT #${k} does not exist`):t(`❌ Failed to verify NFT #${k}: ${ce.message}`),l(!1);return}if(t("Checking approvals..."),!await ee.isApprovedForAll(J,n))try{t("Requesting approval for all NFTs..."),await(await ee.setApprovalForAll(n,!0)).wait(),t("✅ Approval granted for all NFTs")}catch(k){if(k.code==="ACTION_REJECTED"){t("❌ User cancelled approval transaction"),l(!1);return}t(`❌ Failed to approve NFTs: ${k.message}`),l(!1);return}t("Validating contract state...");try{if(!await S.initialized()){t("❌ Pool is not initialized"),l(!1);return}}catch(k){console.warn("Could not check initialized state:",k)}try{if(await S.paused()){t("❌ Pool is currently paused"),l(!1);return}}catch(k){console.warn("Could not check paused state:",k)}const z=await S.getPoolTokens();if(console.log("🏊 Pool liquidity check:",{availableTokens:z.length,requestedSwaps:s.length,hasEnoughLiquidity:z.length>=s.length}),z.length<s.length){t(`❌ Insufficient pool liquidity: Only ${z.length} NFT${z.length!==1?"s":""} available, need ${s.length}`),l(!1);return}if(z.length===0){t("❌ Pool is empty - no NFTs available for swapping"),l(!1);return}const te=await S.swapFeeInWei();console.log("Swap fee per NFT:",he(te),"ETH");const L=await r.getBalance(J),D=te*BigInt(s.length);if(L<D){t(`❌ Insufficient balance. Need ${he(D)} ETH, have ${he(L)} ETH`),l(!1);return}t(`Swapping ${s.length} NFT${s.length>1?"s":""}...`),t("Estimating transaction cost...");let $;try{if(s.length>1&&S.swapNFTBatch){const k=await S.swapNFTBatch.estimateGas(s,{value:D});console.log("Batch swap gas estimate:",k.toString()),$=await S.swapNFTBatch(s,{value:D})}else{const k=await S.swapNFT.estimateGas(s[0],{value:te});console.log("Single swap gas estimate:",k.toString()),$=await S.swapNFT(s[0],{value:te})}}catch(k){console.error("Gas estimation failed:",k),k.reason?t(`❌ Transaction would fail: ${k.reason}`):k.message.includes("insufficient funds")?t("❌ Insufficient funds for gas + swap fee"):k.message.includes("execution reverted")?t("❌ Transaction would be reverted by contract"):k.data?t(`❌ Contract error: ${k.data}`):t(`❌ Transaction validation failed: ${k.message}`),l(!1);return}await $.wait(),t(`✅ Successfully swapped ${s.length} NFT${s.length>1?"s":""}!`),await U()}catch(b){if(console.error("Swap error:",b),b.code==="ACTION_REJECTED")t("❌ User cancelled transaction");else if(b.data==="0xa17e11d5"||b.message.includes("InsufficientLiquidity"))t(`❌ Insufficient liquidity: Not enough NFTs in pool for ${s.length} swap${s.length>1?"s":""}`);else if(b.data==="0xa0712d68"||b.message.includes("SameTokenSwap"))t("❌ Cannot swap: One of your NFTs is already in the pool");else if(b.data==="0x82b42900"||b.message.includes("TokenNotApproved"))t("❌ NFT not approved for transfer");else if(b.data==="0x8baa579f"||b.message.includes("NotTokenOwner"))t("❌ You do not own one or more of the selected NFTs");else if(b.data==="0x025dbdd4"||b.message.includes("IncorrectFee"))t("❌ Incorrect swap fee sent");else if(b.data==="0xd05cb609"||b.message.includes("NotInitialized"))t("❌ Pool not initialized");else{const S=b.reason||b.message||"Unknown error";t("❌ Swap failed: "+S)}}l(!1)},w=async s=>{var T,b;if(s.length===0){t("Please select at least one NFT to stake");return}if(s.length>10){t("You can only stake up to 10 NFTs at once.");return}if(new Set(s).size!==s.length){t("Duplicate NFTs selected. Please select each NFT only once.");return}l(!0),t("");try{const S=await R(),ee=new B(n,ke,S),J=new B(M,["function approve(address,uint256)","function getApproved(uint256) view returns (address)","function ownerOf(uint256) view returns (address)","function setApprovalForAll(address,bool)","function isApprovedForAll(address,address) view returns (bool)"],S),ge=await S.getAddress();t("Verifying ownership and token validity...");for(const L of s)try{if((await J.ownerOf(L)).toLowerCase()!==ge.toLowerCase()){t(`❌ You don't own NFT #${L}`),l(!1);return}}catch(D){(T=D.reason)!=null&&T.includes("ERC721: invalid token ID")||(b=D.reason)!=null&&b.includes("ERC721: owner query for nonexistent token")?t(`❌ NFT #${L} does not exist`):t(`❌ Failed to verify NFT #${L}: ${D.message}`),l(!1);return}if(t("Checking approvals..."),!await J.isApprovedForAll(ge,n))try{t("Requesting approval for all NFTs..."),await(await J.setApprovalForAll(n,!0)).wait(),t("✅ Approval granted for all NFTs")}catch(L){if(L.code==="ACTION_REJECTED"){t("❌ User cancelled approval transaction"),l(!1);return}t(`❌ Failed to approve NFTs: ${L.message}`),l(!1);return}t(`Staking ${s.length} NFT${s.length>1?"s":""}...`);let te;s.length>1?te=await ee.stakeNFTBatch(s):te=await ee.stakeNFT(s[0]),await te.wait(),t(`✅ Successfully staked ${s.length} NFT${s.length>1?"s":""}!`),await U()}catch(S){if(console.error("Stake error:",S),S.code==="ACTION_REJECTED")t("❌ User cancelled transaction");else{const ee=S.reason||S.message||"Unknown error";t("❌ Stake failed: "+ee)}}l(!1)},F=async s=>{if(s.length===0){t("Please select at least one NFT to unstake");return}if(s.length>10){t("You can only unstake up to 10 NFTs at once.");return}l(!0),t("");try{const g=await R(),T=new B(n,ke,g);t(`Unstaking ${s.length} NFT${s.length>1?"s":""}...`);let b;s.length>1&&T.unstakeNFTBatch?b=await T.unstakeNFTBatch(s):b=await T.unstakeNFT(s[0]),await b.wait(),t(`✅ Successfully unstaked ${s.length} NFT${s.length>1?"s":""}!`),await U()}catch(g){if(console.error("Unstake error:",g),g.code==="ACTION_REJECTED")t("❌ User cancelled transaction");else{const T=g.reason||g.message||"Unknown error";t("❌ Unstake failed: "+T)}}l(!1)},q=async()=>{l(!0),t("Claiming rewards..."),console.log("💰 Starting reward claim process...");try{const s=await R();console.log("💰 Got signer, creating swap pool contract...");const g=new B(n,ke,s),T=await g.earned(i);if(console.log(`💰 Pending rewards: ${he(T)} S`),T.toString()==="0"){t("No rewards to claim"),console.log("💰 No rewards available to claim"),l(!1);return}console.log("💰 Calling claimRewards on swap pool...");const b=await g.claimRewards();console.log("💰 Transaction sent, waiting for confirmation...",b.hash),await b.wait(),console.log("💰 Rewards claimed successfully!"),t("Rewards claimed successfully! ✅"),await j()}catch(s){console.error("💰 Claim rewards error:",s);const g=s.reason||s.message||"Unknown error";t(`Claim failed: ${g}`)}l(!1)},Q=async()=>{P(!0);try{const s=await R();await(await new B(M,["function setApprovalForAll(address,bool) external"],s).setApprovalForAll(n,!0)).wait(),ie(!0),t("Approval successful! You can now stake NFTs.")}catch(s){t(`Approval failed: ${s.reason||s.message}`)}P(!1)},U=async()=>{console.log("Refreshing NFT data...",{account:i,isConnected:p}),me(!0),we(!0),oe(!0),v([]),fe([]),Te([]),await new Promise(g=>setTimeout(g,100));const s=r||(window.ethereum?new Re(window.ethereum):null);if(!s){console.warn("No provider available for NFT fetching"),me(!1),we(!1),oe(!1);return}if(!p||!i){console.log("No wallet connected, fetching pool NFTs only"),v([]),me(!1),fe([]),we(!1),ae([]),await _(s);return}console.log("Wallet connected, fetching all NFT data for:",i),await Promise.all([de(i,s),Z(i,s),_(s),se(i,s)]),await j()},de=async(s,g)=>{try{const b=await new B(n,ke,g).nftCollection();if(O(b),!b){console.log("❌ Could not get NFT collection address from SwapPool"),v([]),me(!1);return}const S=new B(b,["function balanceOf(address) view returns (uint256)","function ownerOf(uint256) view returns (address)","function tokenOfOwnerByIndex(address,uint256) view returns (uint256)","function tokenURI(uint256) view returns (string)","function getApproved(uint256) view returns (address)","function isApprovedForAll(address,address) view returns (bool)","function totalSupply() view returns (uint256)"],g),ee=await S.balanceOf(s),J=Number(ee);if(console.log(`🎯 Collection NFT Balance for ${s}: ${J}`),J===0){console.log("📭 No NFTs owned by user (balance=0)"),v([]),V({}),me(!1);return}let ge=!1;try{ge=await S.isApprovedForAll(s,n)}catch{}ie(!!ge);let z=[];if(J>0&&J<=1e3)try{console.log(`🔍 Trying enumerable approach for ${ee.toString()} tokens...`);const $=[];for(let k=0;k<J;k++)$.push(S.tokenOfOwnerByIndex(s,k));z=await Promise.all($),console.log("✅ Enumerable approach successful, found tokens:",z.map(k=>k.toString()))}catch{console.log("❌ tokenOfOwnerByIndex not supported, using fallback scan"),z=[]}if(z.length===0){console.log("🎯 Starting direct ownership scan...");let $=2e3;try{const X=await S.totalSupply();$=Math.min(Number(X)+100,2e3),console.log(`📈 Total supply: ${X.toString()}, scanning up to token ${$}`)}catch{console.log(`📈 Total supply not available, scanning up to token ${$}`)}const k=new Set,ce=20;let ne=0;const Y=Number(J);for(let X=1;X<=$&&ne<Y;X+=ce){const ve=Math.min(X+ce-1,$),ue=[];for(let je=X;je<=ve;je++)ue.push(S.ownerOf(je).then(Ae=>({tokenId:je,owner:Ae.toLowerCase()})).catch(()=>({tokenId:je,owner:null})));try{const je=await Promise.all(ue);for(const{tokenId:Ae,owner:at}of je)if(at===s.toLowerCase()&&(k.add(Ae.toString()),ne++,console.log(`✅ Found owned token: #${Ae} (${ne}/${Y})`),ne>=Y))break}catch(je){console.warn(`Batch ${X}-${ve} failed:`,je.message)}if(ne>=Y)break;await new Promise(je=>setTimeout(je,50))}z=Array.from(k).map(X=>BigInt(X)),console.log(`✅ Direct ownership scan complete, found ${z.length} tokens`)}const te=z.map(async $=>{try{const k=$.toString();let ce="",ne="";try{if(ce=await S.tokenURI($),ce){let X=ce;ce.startsWith("ipfs://")&&(X=ce.replace("ipfs://","https://ipfs.io/ipfs/"));try{const ue=await(await fetch(X)).json();ue.image&&(ne=ue.image,ne.startsWith("ipfs://")&&(ne=ne.replace("ipfs://","https://ipfs.io/ipfs/")))}catch(ve){console.warn(`Failed to fetch metadata for wallet token ${$}:`,ve)}}}catch{}let Y=!1;try{Y=(await S.getApproved($)).toLowerCase()===n.toLowerCase()}catch{}return{tokenId:k,image:ne||"",approved:Y}}catch(k){return console.warn(`Failed to fetch metadata for token ${$}:`,k),{tokenId:$.toString(),image:"",approved:!1}}}),L=await Promise.all(te);console.log("📦 Wallet NFTs loaded:",L.length);const D={};L.forEach($=>{D[$.tokenId]=$.approved}),v(L),V(D)}catch(T){console.error("Failed to fetch wallet NFTs:",T),v([]),V({})}finally{me(!1)}},Z=async(s,g)=>{console.log(`🧾 Starting fetchReceiptNFTs for address: ${s}`);try{const T=new B(a,["function balanceOf(address) view returns (uint256)","function tokenOfOwnerByIndex(address,uint256) view returns (uint256)"],g),b=new B(n,["function getPoolTokens() view returns (uint256[])","function nftCollection() view returns (address)","function receiptToSlot(uint256) view returns (uint256)"],g),S=await T.balanceOf(s);console.log(`🧾 Receipt balance for ${s}: ${S.toString()}`);const ee=await b.getPoolTokens(),J=await b.nftCollection();console.log(`🧾 Pool has ${ee.length} tokens, collection: ${J}`);const ge=new B(J,["function tokenURI(uint256) view returns (string)"],g),z=[];for(let te=0;te<Number(S);te++)try{console.log(`🧾 Fetching receipt token ${te+1}/${S}`);const L=await T.tokenOfOwnerByIndex(s,te);console.log(`🧾 Receipt token ID: ${L.toString()}`);let D=L.toString(),$="",k=`Staked NFT #${L}`;try{console.log(`🧾 Trying receiptToSlot approach for receipt ${L}...`);const ne=await b.receiptToSlot(L);if(console.log(`🧾 Receipt ${L} maps to slot ${ne}`),ne<ee.length){D=ee[ne].toString(),console.log(`🧾 ✅ Slot ${ne} contains NFT token ID: ${D}`);try{console.log(`🧾 Fetching tokenURI for NFT #${D}...`);const Y=await ge.tokenURI(D);if(console.log(`🧾 ✅ NFT token URI for #${D}: ${Y}`),Y&&Y.trim()!==""){let X=Y;Y.startsWith("ipfs://")&&(X=Y.replace("ipfs://","https://ipfs.io/ipfs/"),console.log(`🧾 Converted IPFS URL to: ${X}`)),console.log(`🧾 Fetching metadata from: ${X}`);const ve=await fetch(X);if(!ve.ok)throw new Error(`HTTP ${ve.status}: ${ve.statusText}`);const ue=await ve.json();console.log(`🧾 ✅ Fetched metadata for #${D}:`,ue),ue.image&&($=ue.image,$.startsWith("ipfs://")&&($=$.replace("ipfs://","https://ipfs.io/ipfs/")),console.log(`🧾 ✅ Image URL: ${$}`)),ue.name&&(k=ue.name,console.log(`🧾 ✅ Name: ${k}`))}else console.warn(`🧾 ⚠️ Empty or invalid tokenURI for NFT #${D}`)}catch(Y){console.error(`🧾 ❌ Failed to fetch metadata for NFT #${D}:`,Y)}}else{console.warn(`🧾 ⚠️ Slot ${ne} is out of bounds for poolTokens array (length: ${ee.length})`);try{console.log(`🧾 🔧 Attempting fallback: using receipt token ID ${L} as original token ID`);const Y=await ge.tokenURI(L);if(Y&&Y.trim()!==""){D=L.toString(),console.log(`🧾 ✅ Fallback successful: NFT token URI for #${D}: ${Y}`);let X=Y;Y.startsWith("ipfs://")&&(X=Y.replace("ipfs://","https://ipfs.io/ipfs/"));const ve=await fetch(X);if(ve.ok){const ue=await ve.json();console.log(`🧾 ✅ Fallback metadata for #${D}:`,ue),ue.image&&($=ue.image,$.startsWith("ipfs://")&&($=$.replace("ipfs://","https://ipfs.io/ipfs/")),console.log(`🧾 ✅ Fallback image URL: ${$}`)),ue.name&&(k=ue.name,console.log(`🧾 ✅ Fallback name: ${k}`))}}else console.warn(`🧾 ⚠️ Fallback failed: no tokenURI for receipt token ${L}`)}catch(Y){console.warn(`🧾 ⚠️ Fallback approach failed for receipt ${L}:`,Y.message),D=L.toString()}}}catch(ne){console.error(`🧾 ❌ Failed to get slot ID for receipt ${L}:`,ne)}const ce={tokenId:L.toString(),originalTokenId:D.toString(),image:$,isReceiptToken:!0,name:k,description:`Receipt for ${k} (Token #${D})`};z.push(ce),console.log("🧾 Added receipt token with NFT data:",ce)}catch(L){console.error(`🧾 Error fetching receipt token ${te}:`,L.message)}console.log("🧾 Receipt NFTs loaded:",z.length,z),console.log("🧾 Setting receiptNFTs state with:",z),fe(z),setTimeout(()=>{console.log("🧾 Receipt state after update (async check):",z.length)},100)}catch(T){console.error("Failed to fetch receipt NFTs:",T),fe([])}finally{we(!1)}},_=async s=>{try{console.log("🏊 Fetching pool NFTs for pool:",n);const g=new B(n,ke,s),T=await g.getPoolTokens(),b=await g.nftCollection();if(console.log("🏊 Collection address:",b),!b){console.warn("🏊 No collection address found"),Te([]),oe(!1);return}const S=new B(b,["function tokenURI(uint256) view returns (string)"],s),ee=T.map(async ge=>{try{let z="",te="";try{if(z=await S.tokenURI(ge),z){let L=z;z.startsWith("ipfs://")&&(L=z.replace("ipfs://","https://ipfs.io/ipfs/"));try{const $=await(await fetch(L)).json();$.image&&(te=$.image,te.startsWith("ipfs://")&&(te=te.replace("ipfs://","https://ipfs.io/ipfs/")))}catch(D){console.warn(`Failed to fetch metadata for token ${ge}:`,D)}}}catch(L){console.warn(`Failed to get tokenURI for token ${ge}:`,L)}return{tokenId:ge.toString(),image:te||""}}catch(z){return console.warn(`Failed to fetch pool NFT metadata for token ${ge}:`,z),{tokenId:ge.toString(),image:""}}}),J=await Promise.all(ee);console.log("🏊 Pool NFTs loaded:",J.length),Te(J)}catch(g){console.error("Failed to fetch pool NFTs:",g),Te([])}finally{oe(!1)}},se=async(s,g)=>{try{const b=await new B(n,ke,g).getUserStakes(s);ae(b.map(S=>S.toString())),console.log("🔒 Staked NFTs loaded:",b.length)}catch(T){console.error("Failed to fetch staked NFTs:",T),ae([])}},j=async()=>{if(!i||!n||!p){Se("0");return}try{const s=await R(),g=new B(n,ke,s);try{const T=await g.earned(i);Se(he(T))}catch{try{const b=await g.pendingRewards(i);Se(he(b))}catch{Se("0")}}}catch(s){console.error("Failed to fetch pending rewards:",s),Se("0")}},le=async()=>{if(n)try{const s=r||new Ye("https://rpc.soniclabs.com"),g=new B(n,ke,s),T=await g.swapFeeInWei(),b=he(T);I(b);const S=await g.stonerShare(),ee=Number(S),J=100-ee;ye(ee),C(J),console.log(`💰 Fee split: ${ee}% to stoner pool, ${J}% to stakers`)}catch(s){console.log("Error fetching swap fee:",s),I(null),ye(null),C(null)}};return o.useEffect(()=>{n&&(U(),j(),le())},[n,a]),o.useEffect(()=>{n&&r&&U()},[r]),o.useEffect(()=>{n&&(console.log("Wallet connection changed:",{account:i,isConnected:p}),U(),j())},[i,p,n,a]),o.useEffect(()=>{const s=setInterval(()=>{j()},3e4);return()=>clearInterval(s)},[i,a]),o.useEffect(()=>{console.log("🧾 receiptNFTs state changed:",pe.length,pe)},[pe]),y==="swap"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>u(null),className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-gray-500 hover:bg-gray-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Actions"]}),e.jsx(vt,{walletNFTs:h,poolNFTs:H,loading:d||xe||Ne,onSwap:N,status:f,swapFee:c,provider:r,userAddress:i})]}):y==="stake"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>u(null),className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-gray-500 hover:bg-gray-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Actions"]}),e.jsx(Tt,{walletNFTs:h,receiptNFTs:pe,stakedNFTs:E,loading:d,receiptLoading:be,onStake:w,onUnstake:F,onClaimRewards:q,status:f,approvedMap:x,isApprovedForAll:re,onApproveAll:Q,approvingAll:A,nftCollection:M,swapPool:n,provider:r,pendingRewards:Me,stakerShare:m,swapFee:c})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-600 via-blue-500 to-teal-400 bg-clip-text text-transparent mb-4",children:"What would you like to do?"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Choose your action to get started with the swap pool"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{className:"group",children:e.jsx("button",{onClick:()=>u("swap"),className:"w-full p-8 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-2xl border-2 border-blue-200 dark:border-blue-700 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-300 hover:shadow-xl hover:shadow-blue-500/20 group-hover:scale-105",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 1H4m0 0l4 4M4 12l4-4"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200 mb-2",children:"Swap NFTs"}),e.jsx("p",{className:"text-blue-600 dark:text-blue-400 leading-relaxed",children:"Exchange your NFTs with those available in the pool. Perfect for finding specific traits or collecting new pieces."})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 font-medium",children:[e.jsx("span",{children:"Start Swapping"}),e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-blue-500 dark:text-blue-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Instant Trading"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2z",clipRule:"evenodd"})}),e.jsx("span",{children:"Secure Exchange"})]})]})]})})}),e.jsx("div",{className:"group",children:e.jsx("button",{onClick:()=>u("stake"),className:"w-full p-8 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-2xl border-2 border-green-200 dark:border-green-700 hover:border-green-400 dark:hover:border-green-500 transition-all duration-300 hover:shadow-xl hover:shadow-green-500/20 group-hover:scale-105",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-800 dark:text-green-200 mb-2",children:"Stake NFTs"}),e.jsx("p",{className:"text-green-600 dark:text-green-400 leading-relaxed",children:"Stake your NFTs to earn rewards from swap fees and contribute to pool liquidity. Passive rewards from your collection."})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 font-medium",children:[e.jsx("span",{children:"Start Earning"}),e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-green-500 dark:text-green-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"})]}),e.jsx("span",{children:"Earn Rewards"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Pool Liquidity"})]})]})]})})})]}),e.jsxs("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center",children:"Pool Overview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:H.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Available to Swap"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:E.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Currently Staked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:h.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"In Your Wallet"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:pe.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Your Receipts"})]})]})]}),f&&e.jsx("div",{className:`p-4 rounded-xl border transition-all duration-300 ${f.includes("successful")||f.includes("✅")?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200":f.includes("failed")||f.includes("error")?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200"}`,children:e.jsx("div",{className:"text-center font-medium",children:f})})]})}const St={"0xB6748d708B5Cda0eA8c53e7072566971FCCb6b49":{name:"Stoner NFT",image:"https://nftstorage.link/stoner.png",fallback:"/images/collections/stoner.png",description:"The original Stoner NFT collection"},"0xE3941DB58B9D35410A66636da07c9B28b878B89E":{name:"Boat NFT",image:"https://nftstorage.link/boat.png",fallback:"/images/collections/boat.png",description:"Boat NFT collection"},"0x75f5ee19bc352d19b1791684fadf23b948edaba3":{name:"BOAT MONEY",image:"/images/collections/meme-runner.png",description:"MEME RUNNER - The premium boat NFT collection",customGradient:"from-cyan-400 to-blue-600"}},Oe={defaultImage:"/images/collections/default.png",defaultGradients:["from-blue-400 to-purple-600","from-purple-400 to-pink-600","from-pink-400 to-red-600","from-red-400 to-orange-600","from-orange-400 to-yellow-600","from-yellow-400 to-green-600","from-green-400 to-teal-600","from-teal-400 to-blue-600","from-indigo-400 to-purple-600","from-violet-400 to-pink-600","from-cyan-400 to-blue-600","from-emerald-400 to-teal-600"]};function et(n){return n&&St[n.toLowerCase()]||null}function Ct(n){const a=et(n);return a?{primary:a.image,fallback:a.fallback,default:Oe.defaultImage}:null}function Mt(n){if(!n)return"from-gray-400 to-gray-600";const a=n.split("").reduce((r,i)=>i.charCodeAt(0)+((r<<5)-r),0);return Oe.defaultGradients[Math.abs(a)%Oe.defaultGradients.length]}function Ft(n){if(!n||n==="Unknown Collection"||n==="Loading...")return"?";const a=n.trim().split(/\s+/);return a.length===1?a[0].substring(0,2).toUpperCase():a.slice(0,2).map(r=>r.charAt(0).toUpperCase()).join("")}function tt({address:n,collectionName:a,size:r=48,showTooltip:i=!1}){const[p,y]=o.useState(0),[u,f]=o.useState(!1),[t,d]=o.useState(!0),[l,h]=o.useState(!1),v=et(n),x=Ct(n),V=[];x!=null&&x.primary&&V.push(x.primary);const M=V[p],O=()=>{p<V.length-1?(y(A=>A+1),d(!0)):(f(!0),d(!1))},re=()=>{d(!1),f(!1)};if(o.useEffect(()=>{y(0),f(!1),d(!0)},[n]),!M||u){const A=Ft((v==null?void 0:v.name)||a),P=(v==null?void 0:v.customGradient)||Mt(a||n),E=r<=32?"text-xs":r<=48?"text-sm":"text-base",ae=e.jsx("div",{style:{width:r,height:r},className:`bg-gradient-to-br ${P} rounded-lg flex items-center justify-center text-white font-bold ${E} shadow-lg cursor-pointer transition-transform hover:scale-105`,onMouseEnter:()=>i&&h(!0),onMouseLeave:()=>h(!1),children:A});return i&&(v!=null&&v.description)?e.jsxs("div",{className:"relative",children:[ae,l&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg shadow-lg z-50 whitespace-nowrap",children:[v.description,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]}):ae}const ie=e.jsxs("div",{className:"relative",children:[t&&e.jsx("div",{style:{width:r,height:r},className:"absolute inset-0 bg-gray-300 dark:bg-gray-700 rounded-lg animate-pulse"}),e.jsx("img",{src:M,alt:(v==null?void 0:v.name)||a||"NFT Collection",style:{width:r,height:r,borderRadius:8},onError:O,onLoad:re,className:`transition-all duration-200 hover:scale-105 shadow-lg ${t?"opacity-0":"opacity-100"}`})]});return i&&(v!=null&&v.description)?e.jsxs("div",{className:"relative",children:[e.jsx("div",{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:ie}),l&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg shadow-lg z-50 whitespace-nowrap",children:[e.jsx("div",{className:"font-semibold",children:v.name}),e.jsx("div",{className:"text-xs text-gray-300",children:v.description}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]}):ie}function It({pool:n,collectionName:a,onClose:r,provider:i}){const[p,y]=o.useState(null);return o.useEffect(()=>{(async()=>{try{if(!i||!n.swapPool)return;const t=await new B(n.swapPool,ke,i).swapFeeInWei(),d=he(t);y(d)}catch(f){console.error("Error fetching pool fee:",f),y("N/A")}})()},[n.swapPool,i]),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-4xl max-h-[90vh] overflow-y-auto p-4 sm:p-6 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"sticky top-0 bg-white dark:bg-gray-800 pb-4 mb-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400",children:"Pool Details"}),e.jsx("button",{className:"text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition flex-shrink-0",onClick:r,children:"✕ Close"})]})}),"        ",e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 mb-4",children:[e.jsx(tt,{address:n.nftCollection,collectionName:a,size:64}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"font-semibold text-base sm:text-lg text-blue-600 dark:text-blue-400 mb-1",children:["Collection: ",e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:a||"Loading..."})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["SwapPool: ",e.jsxs("span",{className:"font-mono",children:[n.swapPool.slice(0,6),"...",n.swapPool.slice(-4)]})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Receipt: ",e.jsxs("span",{className:"font-mono",children:[n.stakeReceipt.slice(0,6),"...",n.stakeReceipt.slice(-4)]})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Created: ",n.createdAt]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Active: ",n.active?"Yes":"No"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),e.jsxs("span",{className:"text-sm font-semibold text-amber-600 dark:text-amber-400",children:["Swap Fee: ",p?`${parseFloat(p).toFixed(2)} S`:"Loading..."]})]})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3 flex-wrap",children:[e.jsxs("a",{className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-blue-500 hover:bg-blue-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",href:`https://sonicscan.org/address/${n.swapPool}`,target:"_blank",rel:"noreferrer",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Explorer"]}),e.jsxs("a",{className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-purple-500 hover:bg-purple-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",href:`https://nft.paintswap.io/sonic/collections/${n.nftCollection}`,target:"_blank",rel:"noreferrer",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2h4a1 1 0 110 2h-1v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3a1 1 0 110-2h4zM9 3v1h6V3H9zm2 5a1 1 0 100 2 1 1 0 000-2zm0 4a1 1 0 100 2 1 1 0 000-2z"})}),"PaintSwap"]}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg shadow-md hover:shadow-lg transition-all duration-200",onClick:()=>navigator.clipboard.writeText(n.swapPool),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Address"]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(jt,{swapPool:n.swapPool,stakeReceipt:n.stakeReceipt,provider:i})})]})})}async function Rt(n,a){try{return await new B(n,["function name() view returns (string)"],a).name()}catch{return"Unknown Collection"}}function At(){const{address:n,provider:a,signer:r,isConnected:i,isCorrectNetwork:p}=Be(),[y,u]=o.useState([]),[f,t]=o.useState({}),[d,l]=o.useState(!1),[h,v]=o.useState(null),[x,V]=o.useState(null),[M,O]=o.useState(""),[re,ie]=o.useState(!0),[A,P]=o.useState(""),[E,ae]=o.useState(""),[pe,fe]=o.useState(!1),[H,Te]=o.useState(new Set),[xe,me]=o.useState("0"),[be,we]=o.useState(!1),[Ne,oe]=o.useState(""),W="0x1Db92C2F11b7716f3fa6E94969a8649a32adB1De",[K,Me]=o.useState(W),Se=async(m,C)=>{if(!n||!C){console.log("🎯 CheckUserStakes: No address or provider:",{address:n,hasProvider:!!C});return}console.log(`🎯 Checking user stakes for ${m.length} pools for address ${n}`);const R=new Set;try{for(const N of m)try{console.log(`🎯 Checking pool: ${N.swapPool.slice(0,8)}, receipt: ${N.stakeReceipt.slice(0,8)}`);const F=await new B(N.stakeReceipt,["function balanceOf(address) view returns (uint256)","function balanceOf(address owner) view returns (uint256)"],C).balanceOf(n);console.log(`🎯 Pool ${N.swapPool.slice(0,8)}: balance = ${F.toString()}`),Number(F)>0&&(R.add(N.swapPool),console.log(`✅ Added staked pool: ${N.swapPool.slice(0,8)} (balance: ${F.toString()})`))}catch(w){console.warn(`❌ Failed to check stakes for pool ${N.swapPool.slice(0,8)}:`,w.message);try{const F=await C.getCode(N.stakeReceipt);console.warn(F==="0x"?`❌ Receipt contract ${N.stakeReceipt.slice(0,8)} has no code`:`❌ Receipt contract ${N.stakeReceipt.slice(0,8)} exists but balanceOf failed`)}catch(F){console.warn(`❌ Could not check code for ${N.stakeReceipt.slice(0,8)}:`,F.message)}}}catch(N){console.warn("Failed to check user stakes:",N)}console.log(`🎯 Total staked pools found: ${R.size}`,Array.from(R)),Te(R)},c=y.filter(m=>{const C=E.toLowerCase(),R=!E||f[m.nftCollection]&&f[m.nftCollection].toLowerCase().includes(C)||m.nftCollection.toLowerCase().includes(C)||m.swapPool.toLowerCase().includes(C),N=!pe||H.has(m.swapPool);return R&&N});o.useEffect(()=>{(async()=>{ie(!0);let C=!1;try{const R=["https://rpc.soniclabs.com","https://rpc.soniclabs.com","https://sonic.drpc.org","https://sonic.api.onfinality.io/public","https://sonic-rpc.publicnode.com"].filter(Boolean);for(const N of R)try{const w=new Ye(N);await w.getBlockNumber(),V(w),O(""),console.log("Provider set: "+N),C=!0;break}catch(w){console.warn("RPC failed",N,w)}if(window.ethereum&&C)try{const N=await window.ethereum.request({method:"eth_chainId"}),w=parseInt(N,16);w!==146&&console.warn("Wallet connected to chainId",w,"but using RPC for read operations")}catch(N){console.warn("Could not read chainId from wallet",N)}C||console.warn("No working provider found")}catch(R){console.warn("Provider init failed",R)}ie(!1)})()},[]);const I=async()=>{if(!K){console.warn("Factory address not set. Provide VITE_FACTORY_ADDRESS or public/contracts.json");return}if(!x){console.warn("fetchPools called without provider");return}l(!0),P("");try{try{const w=await x.getNetwork();w&&w.chainId&&Number(w.chainId)!==146&&console.warn(`Connected to chain ${w.chainId}, expected 146 (Sonic)`);const F=await x.send("eth_getCode",[K,"latest"]);(!F||F==="0x"||F==="0x0")&&console.warn(`No contract found at ${K}`)}catch(w){console.warn("Network/code check failed",w)}const m=new B(K,gt,x);let C=[];try{C=await m.getAllPools(),C=C.filter(w=>w.active)}catch(w){console.error("Failed to get pools from factory:",w),C=[]}console.log("All active pools from contract:",C);const R=C.map(w=>{console.log(`🗓️ Pool ${w.swapPool.slice(0,8)}... raw createdAt:`,w.createdAt,"Type:",typeof w.createdAt);let F="Unknown";if(w.createdAt&&Number(w.createdAt)>0)try{const q=Number(w.createdAt);F=new Date(q*1e3).toLocaleString(),console.log(`🗓️ Pool ${w.swapPool.slice(0,8)}... formatted date:`,F)}catch(q){console.warn(`🗓️ Failed to format date for pool ${w.swapPool}:`,q)}else console.warn(`🗓️ Pool ${w.swapPool.slice(0,8)}... has invalid createdAt:`,w.createdAt);return{nftCollection:w.nftCollection,swapPool:w.swapPool,stakeReceipt:w.stakeReceipt,createdAt:w.createdAt,createdAtFormatted:F,creator:w.creator,active:w.active,poolAddress:w.swapPool}});console.log("All pools (no deduplication applied):",R),u(R);const N={};for(const w of R)N[w.nftCollection]=await Rt(w.nftCollection,x);t(N),n?(console.log("🎯 About to check user stakes, address:",n),await Se(R,x)):console.log("🎯 No address available, skipping user stakes check")}catch(m){console.error("Failed to fetch pools",m)}l(!1)},G=async()=>{if(!n||!x||H.size===0){me("0");return}try{let m=qe("0");for(const C of y)if(H.has(C.swapPool))try{const N=await new B(C.swapPool,ke,x).earned(n);console.log(`💰 Pool ${C.swapPool.slice(0,8)}... rewards: ${he(N)} S`),m=m+N}catch(R){console.warn(`Failed to get rewards for pool ${C.swapPool}:`,R.message)}me(he(m))}catch(m){console.error("Failed to calculate total rewards:",m),me("0")}},ye=async()=>{if(!(!r||H.size===0)){we(!0),oe("Claiming rewards from all pools...");try{let m=0,C=0;for(const R of y)if(H.has(R.swapPool))try{const N=new B(R.swapPool,ke,r),w=await N.earned(n);console.log(`💰 Checking pool ${R.swapPool.slice(0,8)}... rewards: ${he(w)} S`),w>0&&(await(await N.claimRewards()).wait(),m++,console.log(`✅ Claimed ${he(w)} S from pool: ${R.swapPool}`))}catch(N){C++,console.error(`❌ Failed to claim from pool ${R.swapPool}:`,N)}m>0?(oe(`✅ Successfully claimed rewards from ${m} pool(s)!`),await G()):C>0?oe(`❌ Failed to claim rewards from ${C} pool(s)`):oe("No rewards to claim")}catch(m){oe(`❌ Claim all failed: ${m.reason||m.message}`)}we(!1),setTimeout(()=>oe(""),5e3)}};return o.useEffect(()=>{x&&K&&I()},[x,K]),o.useEffect(()=>{n&&x&&y.length>0&&(console.log("🎯 Address changed, re-checking user stakes:",n),Se(y,x))},[n,x,y]),o.useEffect(()=>{G()},[y,H,n]),o.useEffect(()=>{if(H.size>0){const m=setInterval(G,3e4);return()=>clearInterval(m)}},[H]),e.jsxs("div",{className:"space-y-6",children:[A&&e.jsxs("div",{className:"p-4 bg-red-900/20 border border-red-500/20 text-red-400 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{className:"font-semibold",children:"Error"})]}),e.jsx("p",{className:"text-sm",children:A})]}),re&&e.jsxs("div",{className:"p-6 bg-card/30 rounded-xl text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"font-semibold",children:"Connecting to Sonic Network..."})]}),e.jsx("p",{className:"text-sm text-muted",children:"Please wait while we establish connection"})]}),i&&H.size>0&&e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/20 dark:to-green-900/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-900/30 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15V3m0 12l-4-4m4 4l4-4m5 4v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6m14-4V5a2 2 0 00-2-2H9a2 2 0 00-2 2v6m10 0V9a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-emerald-900 dark:text-emerald-100",children:"Total Pending Rewards"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:[xe," S"]}),e.jsxs("div",{className:"text-sm text-emerald-700 dark:text-emerald-300",children:["From ",H.size," staked pool",H.size!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("button",{onClick:ye,disabled:be||parseFloat(xe)===0,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 disabled:transform-none",children:be?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Claiming..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15V3m0 12l-4-4m4 4l4-4m5 4v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6m14-4V5a2 2 0 00-2-2H9a2 2 0 00-2 2v6m10 0V9a2 2 0 00-2-2h-4a2 2 0 00-2 2v2"})}),"Claim All Rewards"]})}),Ne&&e.jsx("div",{className:`text-sm font-medium ${Ne.includes("✅")?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"}`,children:Ne})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-bold text-accent",children:"Swap Pools"}),e.jsxs("div",{className:"px-3 py-1 bg-accent/10 text-accent rounded-full text-sm font-medium",children:[c.length," ",pe?"staked":"active"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-xs text-muted",children:["Factory: ",e.jsxs("span",{className:"font-mono text-accent",children:[K==null?void 0:K.slice(0,6),"...",(K==null?void 0:K.slice(-4))||"Not set"]})]}),e.jsxs("button",{onClick:I,disabled:d,className:"px-4 py-2 bg-accent text-white rounded-lg shadow hover:bg-accent/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium",children:[d&&e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d?"Loading...":"Refresh Pools"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 p-4 bg-white/50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Search by collection name, address, or pool address...",value:E,onChange:m=>ae(m.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-sm placeholder-gray-500 dark:placeholder-gray-400"}),E&&e.jsx("button",{onClick:()=>ae(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:pe,onChange:m=>fe(m.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-green-500",children:"🎯"}),"My Staked Pools"]})]}),pe&&e.jsxs("div",{className:"px-2 py-1 bg-green-500/10 text-green-600 dark:text-green-400 rounded text-xs font-medium",children:[H.size," staked"]})]})]}),d&&c.length===0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(m=>e.jsx("div",{className:"p-4 sm:p-5 bg-card rounded-2xl shadow-lg animate-pulse",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gray-600 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-600 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-600 rounded w-1/2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-600 rounded w-2/3"}),e.jsx("div",{className:"h-3 bg-gray-600 rounded w-1/2"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-gray-600 rounded w-16"}),e.jsx("div",{className:"h-6 bg-gray-600 rounded w-20"})]})]})},m))}):c.length===0?e.jsx("div",{className:"p-8 bg-white/90 dark:bg-gray-800/90 rounded-2xl text-center border border-gray-200 dark:border-gray-700",children:y.length===0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏊‍♂️"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Swap Pools Found"}),e.jsx("p",{className:"text-muted mb-4",children:K?"No pools are currently registered with this factory.":"Please set a factory address first."}),K&&e.jsx("button",{onClick:I,className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/80 transition-colors",children:"Refresh Pools"})]}):pe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Staked Pools"}),e.jsx("p",{className:"text-muted mb-4",children:"You haven't staked any NFTs in pools yet. Start staking to earn rewards from trading fees!"}),e.jsx("button",{onClick:()=>fe(!1),className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/80 transition-colors",children:"Show All Pools"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Results Found"}),e.jsxs("p",{className:"text-muted mb-4",children:['No pools match your search "',E,'". Try adjusting your search terms.']}),e.jsx("button",{onClick:()=>ae(""),className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/80 transition-colors",children:"Clear Search"})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((m,C)=>e.jsxs("div",{className:"group p-4 sm:p-5 bg-white/95 dark:bg-gray-800/95 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-200 dark:border-gray-700 hover:border-blue-400/50 cursor-pointer",onClick:()=>v(m),children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(tt,{address:m.nftCollection,collectionName:f[m.nftCollection],size:56}),H.has(m.swapPool)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"✓"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-blue-600 dark:text-blue-400 truncate",children:f[m.nftCollection]||"Loading..."}),H.has(m.swapPool)&&e.jsxs("div",{className:"px-2 py-1 bg-green-500/10 text-green-600 dark:text-green-400 rounded-full text-xs font-medium flex items-center gap-1",children:[e.jsx("span",{children:"🎯"}),e.jsx("span",{children:"Staked"})]})]}),e.jsxs("p",{className:"text-xs text-muted font-mono truncate",children:[m.nftCollection.slice(0,8),"...",m.nftCollection.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-muted mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Pool:"}),e.jsxs("span",{className:"font-mono",children:[m.swapPool.slice(0,8),"...",m.swapPool.slice(-6)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Receipt:"}),e.jsxs("span",{className:"font-mono",children:[m.stakeReceipt.slice(0,8),"...",m.stakeReceipt.slice(-6)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Created:"}),e.jsx("span",{children:m.createdAt&&Number(m.createdAt)>0?new Date(Number(m.createdAt)*1e3).toLocaleDateString():"Unknown"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"flex-1 px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",onClick:R=>{R.stopPropagation(),v(m)},children:"View Details"}),e.jsx("button",{className:"px-3 py-2 bg-secondary/50 hover:bg-secondary text-text rounded-lg transition-colors text-xs",onClick:R=>{R.stopPropagation(),navigator.clipboard.writeText(m.swapPool)},title:"Copy pool address",children:"📋"})]})]},`${m.swapPool}-${C}`))})]}),h&&e.jsx(It,{pool:h,collectionName:f[h.nftCollection],onClose:()=>v(null),provider:x})]})}const Pt="modulepreload",$t=function(n){return"/"+n},De={},Et=function(a,r,i){let p=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));p=Promise.allSettled(r.map(t=>{if(t=$t(t),t in De)return;De[t]=!0;const d=t.endsWith(".css"),l=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${l}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Pt,d||(h.as="script"),h.crossOrigin="",h.href=t,f&&h.setAttribute("nonce",f),document.head.appendChild(h),d)return new Promise((v,x)=>{h.addEventListener("load",v),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${t}`)))})}))}function y(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return p.then(u=>{for(const f of u||[])f.status==="rejected"&&y(f.reason);return a().catch(y)})},Fe=[{inputs:[{internalType:"address",name:"_stonerNFT",type:"address"},{internalType:"address",name:"_receiptToken",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyStaked",type:"error"},{inputs:[],name:"DuplicateTokenId",type:"error"},{inputs:[],name:"EmptyArray",type:"error"},{inputs:[],name:"NoERC20Rewards",type:"error"},{inputs:[],name:"NoRewards",type:"error"},{inputs:[],name:"NoStakers",type:"error"},{inputs:[],name:"NotStaked",type:"error"},{inputs:[],name:"NotYourToken",type:"error"},{inputs:[],name:"TokenAlreadyWhitelisted",type:"error"},{inputs:[],name:"TokenNotWhitelisted",type:"error"},{inputs:[],name:"TooManyTokens",type:"error"},{inputs:[],name:"TransferFailed",type:"error"},{inputs:[],name:"ZeroAddress",type:"error"},{inputs:[],name:"ZeroETH",type:"error"},{inputs:[],name:"ZeroTokenAmount",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"ERC20RewardClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"ERC20RewardReceived",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"EmergencyERC20Withdrawal",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"EmergencyETHWithdrawal",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"to",type:"address"}],name:"EmergencyUnstake",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardReceived",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"}],name:"TokenRemovedFromWhitelist",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"}],name:"TokenWhitelisted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Unstaked",type:"event"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"addWhitelistedToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"token",type:"address"}],name:"calculatePendingERC20Rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"calculatePendingRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"claimAllERC20Rewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimAllRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"claimERC20Rewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimRewardsOnly",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"token",type:"address"}],name:"earnedERC20",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"emergencyUnstake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"emergencyUnstakeWithClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"emergencyWithdrawERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"emergencyWithdrawETH",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"erc20RewardCarry",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"erc20RewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"erc20Rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"erc20TotalRewardsClaimed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"erc20UserRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"exit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getAllPendingERC20Rewards",outputs:[{internalType:"address[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"rewardAmounts",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"getERC20PoolInfo",outputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"uint256",name:"totalClaimedAmount",type:"uint256"},{internalType:"uint256",name:"contractBalance",type:"uint256"},{internalType:"bool",name:"isWhitelisted",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolInfo",outputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"totalStakedTokens",type:"uint256"},{internalType:"uint256",name:"totalRewards",type:"uint256"},{internalType:"uint256",name:"contractBalance",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getStakeInfo",outputs:[{internalType:"address",name:"staker",type:"address"},{internalType:"uint256",name:"stakedAt",type:"uint256"},{internalType:"uint256",name:"stakingDuration",type:"uint256"},{internalType:"bool",name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getStakedTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWhitelistedTokens",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"isStaked",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"notifyERC20Reward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"notifyNativeReward",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptIdByOriginal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiptToken",outputs:[{internalType:"contract IStakeReceipt",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"removeWhitelistedToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rewardCarry",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"stake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"stakeMultiple",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"stakedTokens",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"stakerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"stonerNFT",outputs:[{internalType:"contract IERC721",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalRewardsClaimed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalStaked",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"unstake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"unstakeMultiple",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"userRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"whitelistedTokens",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"whitelistedTokensList",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],Ve=[{inputs:[{internalType:"address",name:"_owner",type:"address"},{internalType:"uint256",name:"_startTime",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyExists",type:"error"},{inputs:[],name:"InvalidOwner",type:"error"},{inputs:[],name:"InvalidRecipient",type:"error"},{inputs:[],name:"InvalidSender",type:"error"},{inputs:[],name:"NotFound",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{inputs:[],name:"UnsafeRecipient",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"ERC20Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"ERC721Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"activePhase",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amountOrId",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"availableIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseTokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"phase",type:"uint256"},{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"quantity",type:"uint256"}],name:"canMintAmountInPhase",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_contract",type:"address"}],name:"contractNFTBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_contract",type:"address"}],name:"contractTokenBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_contract",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"enoughTokenBalance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"phase",type:"uint256"},{internalType:"address[]",name:"accounts",type:"address[]"},{internalType:"uint256",name:"quantity",type:"uint256"}],name:"grantPhaseAccess",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"phase",type:"uint256"},{internalType:"address",name:"account",type:"address"}],name:"hasPhaseAccess",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxMintPerTx",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxMintable",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"mintActive",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"mintHasStarted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"minted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"quantity",type:"uint256"}],name:"ownerMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"owner",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"phaseDuration",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"phaseMintsRemaining",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"phases",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"price",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"revokeOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"royaltyAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"uint256",name:"_salePrice",type:"uint256"}],name:"royaltyInfo",outputs:[{internalType:"address",name:"receiver",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"royaltyReceiver",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"secondsUntilStart",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_baseURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxMintPerTx",type:"uint256"}],name:"setMaxPerTx",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"mintActive_",type:"bool"}],name:"setMintActive",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_paused",type:"bool"}],name:"setPaused",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_price",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_royaltyAmount",type:"uint256"}],name:"setRoyaltyAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiver",type:"address"}],name:"setRoyaltyReceiver",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_startTime",type:"uint256"}],name:"setStartTime",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"state",type:"bool"}],name:"setWhitelist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"startTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalAvailableIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"totalNFTsOwned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalNativeSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_owner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"whitelist",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],Lt="0xB6748d708B5Cda0eA8c53e7072566971FCCb6b49",Bt="0x5777fc6ca7f6BDc02dF3323A0C05970bB9D05b74",nt={stonerStakeReceipt:Lt,stonerFeePool:Bt},Ce=nt.stonerFeePool,Wt=nt.stonerStakeReceipt,We="0x9b567e03d891F537b2B7874aA4A3308Cfe2F4FBb";function Ot(){console.log("🎯 StonerFeePoolActions component loaded!");const{address:n,signer:a,provider:r,isConnected:i,isCorrectNetwork:p}=Be(),[y,u]=o.useState(""),[f,t]=o.useState(!1),[d,l]=o.useState([]),[h,v]=o.useState([]),[x,V]=o.useState([]),[M,O]=o.useState([]),[re,ie]=o.useState(!1),[A,P]=o.useState("0"),[E,ae]=o.useState([]),[pe,fe]=o.useState([]),[H,Te]=o.useState(!1),xe=async()=>{if(!a)throw new Error("Wallet not connected");return a},me=async()=>{if(console.log("🎯 fetchNFTs called in StonerFeePoolActions"),!i||!r||!n){console.log("❌ Wallet not connected, skipping NFT fetch");return}try{const c=n,I=new B(We,Ve,r),G=new B(Ce,Fe,r),ye=await I.isApprovedForAll(c,Ce);ie(ye);const m=await I.totalNFTsOwned(c);console.log("🔢 Stoner NFT balance:",m.toString());const C=Number(m),R=1e3;if(C>R){console.log(`⚠️ Balance seems unusually large (${C}), limiting to ${R}`),l([]),v([]),u(`Warning: NFT balance appears corrupted (${C}). Please check the contract.`);return}const N=[];let w=!1;try{await I.tokenOfOwnerByIndex(c,0),w=!0,console.log("✅ Using tokenOfOwnerByIndex approach");for(let F=0;F<Math.min(Number(m),50);F++)try{const q=await I.tokenOfOwnerByIndex(c,F);console.log(`📝 Found wallet token ${F+1}/${m}: #${q.toString()}`);let Q=null;try{let U=await I.tokenURI(q);if(U.startsWith("ipfs://")&&(U=U.replace("ipfs://","https://ipfs.io/ipfs/")),U.startsWith("http")){const Z=await(await fetch(U)).json();Q=Z.image||Z.image_url,Q&&Q.startsWith("ipfs://")&&(Q=Q.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for token",q.toString())}N.push({tokenId:q.toString(),image:Q})}catch(q){console.warn(`Failed to get token at index ${F}:`,q.message);continue}}catch{console.log("❌ tokenOfOwnerByIndex not supported (ERC404 contract), trying event-based approach"),w=!1;try{console.log("🔍 Using direct ownership verification for ERC404 contract...");const q=new Set,Q=Math.max(1e4,Number(m)*50),U=20;let de=0;for(let j=1;j<=Q&&de<Number(m);j+=U){const le=Math.min(j+U-1,Q),s=[];for(let g=j;g<=le;g++)s.push(I.ownerOf(g).then(T=>({tokenId:g,owner:T.toLowerCase()})).catch(()=>({tokenId:g,owner:null})));try{const g=await Promise.all(s);for(const{tokenId:T,owner:b}of g)if(b===c.toLowerCase()&&(q.add(T.toString()),de++,console.log(`✅ Found owned token via direct check: #${T} (${de}/${m})`),de>=Number(m)))break}catch(g){console.warn(`Batch ${j}-${le} failed:`,g.message)}if(de>=Number(m))break;await new Promise(g=>setTimeout(g,10))}console.log(`🎯 Direct check found ${de} total tokens`);const Z=Array.from(q).slice(0,50);console.log(`📋 Validating ${Z.length} tokens and fetching metadata...`);const _=5;let se=0;for(let j=0;j<Z.length;j+=_){const s=Z.slice(j,j+_).map(async g=>{try{if((await I.ownerOf(g)).toLowerCase()!==c.toLowerCase())return null;let b=null;try{let S=await I.tokenURI(g);if(S.startsWith("ipfs://")&&(S=S.replace("ipfs://","https://ipfs.io/ipfs/")),S.startsWith("http")){const J=await(await fetch(S)).json();b=J.image||J.image_url,b&&b.startsWith("ipfs://")&&(b=b.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for token",g)}return{tokenId:g.toString(),image:b}}catch(T){return console.warn(`Token ${g} validation failed:`,T.message),null}});try{const g=await Promise.all(s);for(const T of g)T&&(N.push(T),se++,console.log(`✅ Validated token #${T.tokenId} (${se}/${Z.length})`))}catch(g){console.warn(`Metadata batch ${j} failed:`,g.message)}j+_<Z.length&&await new Promise(g=>setTimeout(g,50))}se>0&&(w=!0,console.log(`🎉 Successfully loaded ${se} Stoner NFTs via direct ownership check`))}catch(q){console.warn("Direct ownership check failed:",q.message)}}if(!w||N.length<Number(m)){console.log("🔍 Trying multicall brute force token discovery...");try{const{Multicall:F}=await Et(async()=>{const{Multicall:j}=await import("./index-Blt0uD8X.js");return{Multicall:j}},__vite__mapDeps([0,1])),q=new F({ethersProvider:r,tryAggregate:!0}),Q=1e3,U=[];for(let j=0;j<=Q;j++)U.push({reference:`ownerOf_${j}`,contractAddress:We,abi:Ve,calls:[{methodName:"ownerOf",methodParameters:[j]}]});const de=await q.call(U),_=Object.entries(de.results).filter(([j,le])=>le.callsReturnContext&&le.callsReturnContext[0].returnValues&&le.callsReturnContext[0].returnValues[0]&&le.callsReturnContext[0].returnValues[0].toLowerCase()===c.toLowerCase()).map(([j])=>parseInt(j.replace("ownerOf_",""))).map(async j=>{if(N.some(g=>g.tokenId===j.toString()))return null;let s=null;try{let g=await I.tokenURI(j);if(g.startsWith("ipfs://")&&(g=g.replace("ipfs://","https://ipfs.io/ipfs/")),g.startsWith("http")){const b=await(await fetch(g)).json();s=b.image||b.image_url,s&&s.startsWith("ipfs://")&&(s=s.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for token",j.toString())}return{tokenId:j.toString(),image:s}});(await Promise.all(_)).forEach(j=>{j&&N.push(j)})}catch(F){console.warn("Multicall failed (network may not support it):",F.message),console.log("📋 Continuing with enumerable results only")}}console.log(`✅ Loaded ${N.length}/${m} wallet Stoner NFTs`),l(N);try{console.log("🔥 Fetching staked NFTs from StakeReceipt contract...");const F=new B(Wt,ht,r);let q=[];try{const[Q,U]=await F.getUserReceipts(c);console.log("🔥 Raw receipts and original tokens from getUserReceipts:",Q,U);const de=Array.from(Q).map(_=>_.toString()),Z=Array.from(U).map(_=>_.toString());console.log("🔥 Staked Stoner NFT token IDs from receipts:",Z);for(let _=0;_<Z.length;_++){const se=Z[_],j=de[_];let le=null;try{let s=await I.tokenURI(se);if(s.startsWith("ipfs://")&&(s=s.replace("ipfs://","https://ipfs.io/ipfs/")),s.startsWith("http")){const T=await(await fetch(s)).json();le=T.image||T.image_url,le&&le.startsWith("ipfs://")&&(le=le.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for staked token",se)}q.push({tokenId:se,receiptId:j,image:le})}}catch{console.log("🔥 getUserReceipts() not available, trying fallback method...");try{const U=await F.balanceOf(c);if(console.log("🔥 StakeReceipt balance:",U.toString()),U>0){const de=[];try{for(let Z=0;Z<Number(U);Z++){const _=await F.tokenOfOwnerByIndex(c,Z);de.push(_.toString())}console.log("🔥 Receipt token IDs:",de)}catch{console.log("🔥 tokenOfOwnerByIndex not available, using brute force for receipts...");for(let _=1;_<=1e3;_++)try{(await F.ownerOf(_)).toLowerCase()===c.toLowerCase()&&de.push(_.toString())}catch{}}for(const Z of de){let _=null;try{_=await F.receiptToOriginalToken(Z)}catch{try{_=await F.getOriginalTokenId(Z)}catch{_=Z}}if(_){let se=null;try{let j=await I.tokenURI(_);if(j.startsWith("ipfs://")&&(j=j.replace("ipfs://","https://ipfs.io/ipfs/")),j.startsWith("http")){const s=await(await fetch(j)).json();se=s.image||s.image_url,se&&se.startsWith("ipfs://")&&(se=se.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for staked token",_.toString())}q.push({tokenId:_.toString(),receiptId:Z,image:se})}}}}catch(U){console.log("🔥 Fallback method also failed:",U)}}console.log(`✅ Loaded ${q.length} staked Stoner NFTs:`,q.map(Q=>Q.tokenId)),v(q)}catch(F){console.warn("Failed to fetch staked NFTs:",F)}}catch(c){console.error("Failed to fetch NFTs:",c)}},be=async()=>{if(console.log("💰 fetchRewards called in StonerFeePoolActions"),!window.ethereum||!i){console.log("❌ Wallet not connected, skipping rewards fetch");return}try{Te(!0);const c=new Re(window.ethereum),G=await(await c.getSigner()).getAddress(),ye=new B(Ce,Fe,c),m=await ye.calculatePendingRewards(G);P(he(m)),console.log("💎 Native S rewards:",he(m));const C=await ye.getWhitelistedTokens();fe(C),console.log("📋 Whitelisted tokens:",C);const R=C.map(async w=>{try{const F=await ye.calculatePendingERC20Rewards(G,w);let q="Unknown",Q=18;try{const U=new B(w,["function symbol() view returns (string)","function decimals() view returns (uint8)"],c);q=await U.symbol(),Q=await U.decimals()}catch(U){console.warn(`Failed to get token info for ${w}:`,U.message)}return{address:w,symbol:q,decimals:Q,earned:lt(F,Q),rawEarned:F.toString()}}catch(F){return console.warn(`Failed to get rewards for token ${w}:`,F.message),null}}),N=(await Promise.all(R)).filter(w=>w!==null);ae(N),console.log("🪙 ERC20 rewards:",N)}catch(c){console.error("Failed to fetch rewards:",c)}finally{Te(!1)}};o.useEffect(()=>{i&&n&&p&&(console.log("🔗 Wallet connected, fetching NFTs and rewards..."),me(),be())},[i,n,p]);const we=async()=>{if(x.length===0){u("Select NFTs to stake first");return}t(!0),u("");try{const c=await xe(),I=new B(Ce,Fe,c);let G;x.length===1?G=await I.stake(x[0]):G=await I.stakeMultiple(x),u("Staking..."),await G.wait(),u("Staking successful!"),V([]),await me()}catch(c){u("Staking failed: "+(c.reason||c.message))}t(!1)},Ne=async()=>{if(M.length===0){u("Select staked NFTs to unstake first");return}t(!0),u("");try{const c=await xe(),I=new B(Ce,Fe,c),G=M.map(m=>{const C=h.find(R=>R.tokenId===m);return C?C.receiptId:m});console.log("🔥 Unstaking with receipt IDs:",G);let ye;G.length===1?ye=await I.unstake(G[0]):ye=await I.unstakeMultiple(G),u("Unstaking..."),await ye.wait(),u("Unstaking successful!"),O([]),await me()}catch(c){console.error("Unstaking failed:",c),u("Unstaking failed: "+(c.reason||c.message))}t(!1)},oe=async()=>{t(!0),u("");try{const c=await xe(),G=await new B(Ce,Fe,c).claimAllRewards();u("Claiming rewards..."),await G.wait(),u("Rewards claimed successfully!"),await be()}catch(c){u("Claim failed: "+(c.reason||c.message))}t(!1)},W=async()=>{t(!0),u("");try{const c=await xe(),G=await new B(Ce,Fe,c).claimRewardsOnly();u("Claiming native rewards..."),await G.wait(),u("Native rewards claimed successfully!"),await be()}catch(c){u("Native claim failed: "+(c.reason||c.message))}t(!1)},K=async c=>{t(!0),u("");try{const I=await xe(),ye=await new B(Ce,Fe,I).claimERC20Rewards(c);u("Claiming ERC20 rewards..."),await ye.wait(),u("ERC20 rewards claimed successfully!"),await be()}catch(I){u("ERC20 claim failed: "+(I.reason||I.message))}t(!1)},Me=async()=>{t(!0);try{const c=await xe();await(await new B(We,["function setApprovalForAll(address,bool) external"],c).setApprovalForAll(Ce,!0)).wait(),ie(!0),u("Approval successful!")}catch(c){u("Approval failed: "+(c.reason||c.message))}t(!1)},Se=!i;return e.jsxs("div",{className:"p-6 bg-white/95 dark:bg-gray-800/95 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 backdrop-blur-sm space-y-6",children:[Se&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 mb-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:"Connect Wallet to Interact"})]}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Connect your wallet using the button in the header to stake NFTs and claim rewards"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"🌿"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-green-400",children:"Stoner NFT Staking"}),e.jsx("p",{className:"text-sm text-muted",children:i?`Connected: ${n.slice(0,6)}...${n.slice(-4)}`:"Preview Mode - Connect wallet to interact"})]})]}),e.jsx("button",{onClick:oe,disabled:f||!i,className:"px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all disabled:opacity-50 font-medium",title:i?"":"Connect wallet to claim rewards",children:"Claim Rewards"})]}),y&&e.jsx("div",{className:`p-3 rounded-lg ${y.includes("successful")||y.includes("claimed")?"bg-green-900/20 border border-green-500/20 text-green-400":y.includes("failed")||y.includes("error")?"bg-red-900/20 border border-red-500/20 text-red-400":"bg-blue-900/20 border border-blue-500/20 text-blue-400"}`,children:y}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/10 to-orange-500/10 rounded-xl border border-yellow-500/20 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-lg",children:"💰"})}),e.jsx("h4",{className:"font-semibold text-yellow-400",children:"Claimable Rewards"})]}),e.jsx("button",{onClick:be,disabled:H||!i,className:"px-3 py-1 bg-yellow-600 text-white rounded text-sm disabled:opacity-50 hover:bg-yellow-700 transition-colors",title:i?"":"Connect wallet to refresh rewards",children:H?"Loading...":"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400 text-lg",children:"⚡"}),e.jsx("span",{className:"font-medium text-blue-400",children:"S Rewards"})]}),e.jsx("button",{onClick:W,disabled:f||parseFloat(A)===0||!i,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm disabled:opacity-50 hover:bg-blue-700 transition-colors",title:i?"":"Connect wallet to claim",children:"Claim S"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[parseFloat(A).toFixed(6)," S"]})]}),E.length>0?e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-400 text-lg",children:"🪙"}),e.jsx("span",{className:"font-medium text-green-400",children:"Token Rewards"})]}),e.jsx("button",{onClick:oe,disabled:f||E.every(c=>parseFloat(c.earned)===0)||!i,className:"px-3 py-1 bg-green-600 text-white rounded text-sm disabled:opacity-50 hover:bg-green-700 transition-colors",title:i?"":"Connect wallet to claim",children:"Claim All"})]}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:E.map((c,I)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-400",children:[c.symbol,":"]}),e.jsx("span",{className:"text-white font-medium",children:parseFloat(c.earned).toFixed(4)})]}),e.jsx("button",{onClick:()=>K(c.address),disabled:f||parseFloat(c.earned)===0||!i,className:"px-2 py-1 bg-green-600/80 text-white rounded text-xs disabled:opacity-50 hover:bg-green-600 transition-colors",title:i?"":"Connect wallet to claim",children:"Claim"})]},c.address))})]}):e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-gray-400 text-lg",children:"🪙"}),e.jsx("span",{className:"font-medium text-gray-400",children:"Token Rewards"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"No whitelisted tokens or rewards available"})]})]}),(parseFloat(A)>0||E.some(c=>parseFloat(c.earned)>0))&&e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:oe,disabled:f||!i,className:"px-6 py-2 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg disabled:opacity-50 hover:from-yellow-600 hover:to-orange-700 transition-all font-semibold",title:i?"":"Connect wallet to claim rewards",children:f?"Claiming...":"Claim All Rewards"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold text-green-400",children:["Stake NFTs (",x.length," selected)"]}),!re&&e.jsx("button",{onClick:Me,disabled:f||!i,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm disabled:opacity-50",title:i?"":"Connect wallet to approve",children:"Approve All"})]}),d.length===0?e.jsxs("div",{className:"p-6 bg-card/30 rounded-xl text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🔍"}),e.jsx("p",{className:"text-muted",children:"No Stoner NFTs found in wallet"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-3",children:d.map(c=>e.jsxs("div",{className:`relative cursor-pointer rounded-lg border-2 transition-all ${x.includes(c.tokenId)?"border-green-400 bg-green-400/10":"border-transparent hover:border-accent/30"}`,onClick:()=>{x.includes(c.tokenId)?V(I=>I.filter(G=>G!==c.tokenId)):V(I=>[...I,c.tokenId])},children:[e.jsx("div",{className:"aspect-square p-2",children:e.jsx(Ie,{image:c.image,tokenId:c.tokenId,size:"100%"})}),e.jsxs("div",{className:"text-xs text-center p-1",children:["#",c.tokenId]})]},c.tokenId))}),e.jsx("button",{onClick:we,disabled:f||x.length===0||!re||!i,className:"w-full px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg disabled:opacity-50",title:i?"":"Connect wallet to stake NFTs",children:f?"Staking...":`Stake ${x.length} NFT${x.length!==1?"s":""}`})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-blue-400",children:["Unstake NFTs (",M.length," selected)"]}),h.length===0?e.jsxs("div",{className:"p-6 bg-card/30 rounded-xl text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"📦"}),e.jsx("p",{className:"text-muted",children:"No staked NFTs"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-3",children:h.slice(0,12).map(c=>e.jsxs("div",{className:`relative cursor-pointer rounded-lg border-2 transition-all ${M.includes(c.tokenId)?"border-blue-400 bg-blue-400/10":"border-transparent hover:border-accent/30"}`,onClick:()=>{M.includes(c.tokenId)?O(I=>I.filter(G=>G!==c.tokenId)):O(I=>[...I,c.tokenId])},children:[e.jsx("div",{className:"aspect-square p-2",children:e.jsx(Ie,{image:c.image,tokenId:c.tokenId,size:"100%"})}),e.jsxs("div",{className:"text-xs text-center p-1",children:["#",c.tokenId]})]},c.tokenId))}),e.jsx("button",{onClick:Ne,disabled:f||M.length===0||!i,className:"w-full px-4 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg disabled:opacity-50",title:i?"":"Connect wallet to unstake NFTs",children:f?"Unstaking...":`Unstake ${M.length} NFT${M.length!==1?"s":""}`})]})]})]})]})}function Ut(){return e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4 animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-2xl",children:"🍃"})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-green-400 via-emerald-500 to-teal-400 bg-clip-text text-transparent",children:"Stoner NFT Staking"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto",children:"Stake your Stoner NFTs to earn multiple token rewards and participate in the ecosystem"})]}),e.jsx(Ot,{})]})}const He={chainId:"0x92",chainName:"Sonic Network",rpcUrls:["https://rpc.sonic.org"],nativeCurrency:{name:"S",symbol:"S",decimals:18},blockExplorerUrls:["https://sonicscan.org"]};function _t({onNetworkReady:n}){const[a,r]=o.useState(null),[i,p]=o.useState(!1),[y,u]=o.useState(!1);o.useEffect(()=>{if(t(),window.ethereum)return window.ethereum.on("chainChanged",f),()=>window.ethereum.removeListener("chainChanged",f)},[]);const f=l=>{const h=parseInt(l,16);r(h),p(h===146),h===146&&(n==null||n(!0))},t=async()=>{if(window.ethereum)try{const l=await window.ethereum.request({method:"eth_chainId"}),h=parseInt(l,16);r(h),p(h===146),h===146&&(n==null||n(!0))}catch(l){console.warn("Failed to check network:",l)}},d=async()=>{if(window.ethereum){u(!0);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:He.chainId}]})}catch(l){if(l.code===4902)try{await window.ethereum.request({method:"wallet_addEthereumChain",params:[He]})}catch(h){console.error("Failed to add Sonic network:",h)}else console.error("Failed to switch to Sonic network:",l)}u(!1)}};return window.ethereum?!i&&a!==null?e.jsx("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm",children:"🔄"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-800 dark:text-orange-200",children:"Wrong Network"}),e.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300",children:"Please switch to Sonic Network (Chain ID: 146)"})]})]}),e.jsx("button",{onClick:d,disabled:y,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium disabled:opacity-50 flex items-center gap-2 transition-colors",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Switching..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🔄"}),"Switch to Sonic"]})})]})}):null:e.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm",children:"🦊"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-amber-800 dark:text-amber-200",children:"Wallet Required"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Please install MetaMask or another Ethereum wallet to continue."})]})]})})}function zt(){const{address:n,isConnecting:a,isCorrectNetwork:r,connectWallet:i,disconnect:p,switchToSonicNetwork:y,isConnected:u}=Be(),f=async()=>{try{await i()}catch(l){console.error("Failed to connect wallet:",l)}},t=async()=>{try{await y()}catch(l){console.error("Failed to switch network:",l)}},d=l=>l?`${l.slice(0,6)}...${l.slice(-4)}`:"";return u&&!r?e.jsx("button",{onClick:t,className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:"⚠️ Switch to Sonic"}):u?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900/50 dark:to-emerald-900/50 text-green-800 dark:text-green-200 rounded-xl font-semibold text-sm shadow-sm border border-green-200 dark:border-green-700",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),d(n)]}),e.jsx("button",{onClick:p,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",title:"Disconnect wallet",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsx("button",{onClick:f,disabled:a,className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Connecting..."]}):e.jsx(e.Fragment,{children:"🔗 Connect Wallet"})})}function Dt(){const n=rt(),[a,r]=o.useState(()=>typeof window<"u"?localStorage.getItem("theme")!=="light":!0);return Pe.useEffect(()=>{document.documentElement.classList.toggle("dark",a),localStorage.setItem("theme",a?"dark":"light")},[a]),e.jsx(Nt,{children:e.jsx(ft,{children:e.jsxs("div",{className:"min-h-screen p-0 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:bg-gradient-to-br dark:from-zinc-900 dark:via-gray-900 dark:to-slate-900 text-gray-900 dark:text-gray-100",children:[e.jsx(_t,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-2 sm:p-4 md:p-6 w-full",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row items-center justify-between mb-8 py-6 px-4 sm:px-6 rounded-2xl shadow-xl bg-white/95 dark:bg-gray-800/95 backdrop-blur-lg gap-4 border border-gray-200 dark:border-gray-700 animate-slide-up",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 via-blue-500 to-teal-500 rounded-xl shadow-lg flex items-center justify-center group-hover:shadow-glow transition-all duration-300 overflow-hidden",children:[e.jsx("img",{src:"/pass-the-jpeg-logo.png",alt:"PASS THE JPEG Logo",className:"w-8 h-8 object-contain",onError:i=>{i.target.style.display="none",i.target.nextSibling.style.display="block"}}),e.jsx("span",{className:"text-white font-bold text-xl hidden",children:"🤝"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-extrabold bg-gradient-to-r from-indigo-600 via-blue-500 to-teal-400 bg-clip-text text-transparent",children:"PASS THE JPEG"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 hidden sm:block",children:"SWAP YOUR NFTS WITH NFTS IN THE SWAP POOLS"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[n.pathname==="/"&&e.jsx(Ue,{to:"/staking",className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:"🍃 Stoner Staking"}),n.pathname==="/staking"&&e.jsx(Ue,{to:"/",className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:"← Back to Swap Pools"}),e.jsx(zt,{}),e.jsx("button",{onClick:()=>r(!a),className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 transition-all duration-200 shadow-sm hover:shadow-md",title:"Toggle theme",children:e.jsx("span",{className:"text-lg",children:a?"🌙":"☀️"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-100 to-blue-100 dark:from-indigo-900/50 dark:to-blue-900/50 text-indigo-800 dark:text-indigo-200 rounded-xl font-semibold text-sm shadow-sm border border-indigo-200 dark:border-indigo-700",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Sonic Network"]})]})]}),e.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-amber-50 via-yellow-50 to-orange-50 dark:from-amber-900/20 dark:via-yellow-900/20 dark:to-orange-900/20 rounded-xl border border-amber-200 dark:border-amber-700/50 shadow-lg animate-slide-up",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-lg",children:"⚠️"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-amber-800 dark:text-amber-200 text-sm mb-1",children:"Experimental Protocol Warning"}),e.jsx("p",{className:"text-amber-700 dark:text-amber-300 text-xs leading-relaxed",children:"This is an experimental protocol that has not been audited. Use at your own risk. Only interact with funds you can afford to lose. Smart contracts may contain bugs or vulnerabilities."})]})]})}),e.jsx("main",{children:e.jsxs(it,{children:[e.jsx(_e,{path:"/",element:e.jsx(At,{})}),e.jsx(_e,{path:"/staking",element:e.jsx(Ut,{})})]})})]})]})})})}Ke(document.getElementById("root")).render(e.jsx(Pe.StrictMode,{children:e.jsx(ot,{children:e.jsx(Dt,{})})}));
