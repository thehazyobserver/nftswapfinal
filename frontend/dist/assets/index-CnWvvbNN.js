const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Blt0uD8X.js","assets/vendor-DnY-W9X-.js"])))=>i.map(i=>d[i]);
import{r as o,a as st,R as Ae,u as rt,L as Ue,b as it,c as _e,B as ot}from"./vendor-DnY-W9X-.js";import{f as ge,p as qe,C as L,B as Re,J as Ye,a as lt}from"./ethers-Bg9Q1_ah.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))i(p);new MutationObserver(p=>{for(const y of p)if(y.type==="childList")for(const u of y.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function r(p){const y={};return p.integrity&&(y.integrity=p.integrity),p.referrerPolicy&&(y.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?y.credentials="include":p.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function i(p){if(p.ep)return;p.ep=!0;const y=r(p);fetch(p.href,y)}})();var Ze={exports:{}},$e={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dt=o,ct=Symbol.for("react.element"),ut=Symbol.for("react.fragment"),pt=Object.prototype.hasOwnProperty,mt=dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yt={key:!0,ref:!0,__self:!0,__source:!0};function Ge(n,a,r){var i,p={},y=null,u=null;r!==void 0&&(y=""+r),a.key!==void 0&&(y=""+a.key),a.ref!==void 0&&(u=a.ref);for(i in a)pt.call(a,i)&&!yt.hasOwnProperty(i)&&(p[i]=a[i]);if(n&&n.defaultProps)for(i in a=n.defaultProps,a)p[i]===void 0&&(p[i]=a[i]);return{$$typeof:ct,type:n,key:y,ref:u,props:p,_owner:mt.current}}$e.Fragment=ut;$e.jsx=Ge;$e.jsxs=Ge;Ze.exports=$e;var e=Ze.exports,Je,De=st;Je=De.createRoot,De.hydrateRoot;const gt=[{inputs:[{internalType:"address",name:"_centralStonerFeePool",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidERC721",type:"error"},{inputs:[],name:"InvalidShareRange",type:"error"},{inputs:[],name:"PoolAlreadyExists",type:"error"},{inputs:[],name:"PoolDoesNotExist",type:"error"},{inputs:[],name:"ZeroAddressNotAllowed",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"swapFeeInWei",type:"uint256"},{indexed:!1,internalType:"uint256",name:"stonerShare",type:"uint256"}],name:"DefaultFeesUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"centralStonerFeePool",type:"address"},{indexed:!0,internalType:"address",name:"deployer",type:"address"}],name:"FactoryDeployed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftCollection",type:"address"},{indexed:!0,internalType:"address",name:"swapPool",type:"address"}],name:"PoolDeactivated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"nftCollection",type:"address"},{indexed:!0,internalType:"address",name:"swapPool",type:"address"},{indexed:!0,internalType:"address",name:"stakeReceipt",type:"address"},{indexed:!1,internalType:"address",name:"creator",type:"address"}],name:"PoolPairCreated",type:"event"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"allCollections",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"allPools",outputs:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"},{internalType:"bool",name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"centralStonerFeePool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"collectionToPool",outputs:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"uint256",name:"customSwapFee",type:"uint256"},{internalType:"uint256",name:"customStonerShare",type:"uint256"}],name:"createPoolPair",outputs:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"}],name:"deactivatePool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"defaultStonerShare",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"defaultSwapFeeInWei",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getActivePools",outputs:[{components:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"},{internalType:"bool",name:"active",type:"bool"}],internalType:"struct MultiPoolFactoryNonProxy.PoolData[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllCollections",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAllPools",outputs:[{components:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"},{internalType:"bool",name:"active",type:"bool"}],internalType:"struct MultiPoolFactoryNonProxy.PoolData[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getFactoryStats",outputs:[{internalType:"uint256",name:"totalPools",type:"uint256"},{internalType:"address",name:"centralPool",type:"address"},{internalType:"uint256",name:"defaultFee",type:"uint256"},{internalType:"uint256",name:"defaultShare",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"collections",type:"address[]"}],name:"getMultiplePoolInfos",outputs:[{components:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"}],internalType:"struct MultiPoolFactoryNonProxy.PoolInfo[]",name:"poolInfos",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"}],name:"getPoolInfo",outputs:[{components:[{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"},{internalType:"bool",name:"exists",type:"bool"},{internalType:"uint256",name:"createdAt",type:"uint256"},{internalType:"address",name:"creator",type:"address"}],internalType:"struct MultiPoolFactoryNonProxy.PoolInfo",name:"poolInfo",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"poolCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"}],name:"poolExists",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"nftCollection",type:"address"},{internalType:"address",name:"swapPool",type:"address"},{internalType:"address",name:"stakeReceipt",type:"address"}],name:"registerPoolPair",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newSwapFeeInWei",type:"uint256"},{internalType:"uint256",name:"newStonerShare",type:"uint256"}],name:"setDefaultFees",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],ht=[{inputs:[{internalType:"string",name:"name_",type:"string"},{internalType:"string",name:"symbol_",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"InvalidURI",type:"error"},{inputs:[],name:"NonTransferable",type:"error"},{inputs:[],name:"OnlyPool",type:"error"},{inputs:[],name:"PoolAlreadySet",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"newBaseURI",type:"string"}],name:"BaseURIUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"pool",type:"address"}],name:"PoolSet",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"receiptTokenId",type:"uint256"},{indexed:!0,internalType:"uint256",name:"originalTokenId",type:"uint256"}],name:"ReceiptBurned",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"originalTokenId",type:"uint256"}],name:"mint",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"originalTokenIds",type:"uint256[]"}],name:"batchMint",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"receiptTokenIds",type:"uint256[]"}],name:"batchBurn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserReceipts",outputs:[{internalType:"uint256[]",name:"receipts",type:"uint256[]"},{internalType:"uint256[]",name:"originalTokens",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"getOriginalTokenId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"getReceiptInfo",outputs:[{internalType:"uint256",name:"originalTokenId",type:"uint256"},{internalType:"uint256",name:"mintTime",type:"uint256"},{internalType:"address",name:"originalMinter",type:"address"},{internalType:"uint256",name:"age",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserReceiptHistory",outputs:[{internalType:"uint256[]",name:"receiptIds",type:"uint256[]"},{internalType:"uint256[]",name:"originalTokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"mintTimes",type:"uint256[]"},{internalType:"uint256[]",name:"ages",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCollectionTimeline",outputs:[{internalType:"uint256",name:"totalMinted",type:"uint256"},{internalType:"uint256",name:"totalBurned",type:"uint256"},{internalType:"uint256",name:"currentSupply",type:"uint256"},{internalType:"uint256",name:"averageAge",type:"uint256"},{internalType:"uint256",name:"oldestActive",type:"uint256"},{internalType:"uint256",name:"newestActive",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserReceiptPortfolio",outputs:[{internalType:"uint256",name:"totalReceipts",type:"uint256"},{internalType:"uint256",name:"averageHoldingTime",type:"uint256"},{internalType:"uint256",name:"totalOriginalValue",type:"uint256"},{internalType:"uint256[]",name:"receiptIds",type:"uint256[]"},{internalType:"uint256[]",name:"originalTokenIds",type:"uint256[]"},{internalType:"uint256[]",name:"holdingDurations",type:"uint256[]"},{internalType:"address[]",name:"poolAddresses",type:"address[]"},{internalType:"uint256",name:"oldestReceiptAge",type:"uint256"},{internalType:"uint256",name:"newestReceiptAge",type:"uint256"},{internalType:"bool",name:"hasLongTermHoldings",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"},{internalType:"address",name:"expectedPool",type:"address"}],name:"validateReceipt",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"uri",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_pool",type:"address"}],name:"setPool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"pool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptToOriginalToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptMintTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptMinter",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"approve",outputs:[],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"bool",name:"",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"pure",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"pure",type:"function"}],ve=[{inputs:[{internalType:"address",name:"_nftCollection",type:"address"},{internalType:"address",name:"_receiptContract",type:"address"},{internalType:"address",name:"_stonerPool",type:"address"},{internalType:"uint256",name:"_swapFeeInWei",type:"uint256"},{internalType:"uint256",name:"_stonerShare",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyInitialized",type:"error"},{inputs:[],name:"IncorrectFee",type:"error"},{inputs:[],name:"InvalidReceiptToken",type:"error"},{inputs:[],name:"InvalidStonerShare",type:"error"},{inputs:[],name:"NoRewardsToClaim",type:"error"},{inputs:[],name:"NoTokensAvailable",type:"error"},{inputs:[],name:"NotInitialized",type:"error"},{inputs:[],name:"NotSlotOwner",type:"error"},{inputs:[],name:"NotTokenOwner",type:"error"},{inputs:[],name:"SameTokenSwap",type:"error"},{inputs:[],name:"SlotNotActive",type:"error"},{inputs:[],name:"TokenNotApproved",type:"error"},{inputs:[],name:"TokenUnavailable",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newMaxBatchSize",type:"uint256"},{indexed:!1,internalType:"uint256",name:"newMaxUnstakeAll",type:"uint256"}],name:"BatchLimitsUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"swapCount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"totalFeePaid",type:"uint256"}],name:"BatchSwapExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256[]",name:"receiptTokenIds",type:"uint256[]"},{indexed:!1,internalType:"uint256[]",name:"tokensReceived",type:"uint256[]"}],name:"BatchUnstaked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"stonerAmount",type:"uint256"},{indexed:!1,internalType:"uint256",name:"rewardsAmount",type:"uint256"}],name:"FeeSplit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardsClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardsDistributed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"slotId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newShare",type:"uint256"}],name:"StonerShareUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenIdIn",type:"uint256"},{indexed:!1,internalType:"uint256",name:"tokenIdOut",type:"uint256"},{indexed:!1,internalType:"uint256",name:"slotId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"feePaid",type:"uint256"}],name:"SwapExecuted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"newFeeInWei",type:"uint256"}],name:"SwapFeeUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"slotId",type:"uint256"},{indexed:!1,internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"Unstaked",type:"event"},{inputs:[],name:"claimRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"emergencyWithdraw",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"emergencyWithdrawETH",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"exit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getContractInfo",outputs:[{internalType:"address",name:"nft",type:"address"},{internalType:"address",name:"receipt",type:"address"},{internalType:"address",name:"stoner",type:"address"},{internalType:"uint256",name:"fee",type:"uint256"},{internalType:"uint256",name:"share",type:"uint256"},{internalType:"uint256",name:"poolSize",type:"uint256"},{internalType:"uint256",name:"stakedCount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolSize",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserActiveSlotCount",outputs:[{internalType:"uint256",name:"count",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserSlots",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getUserStakes",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"initialized",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"lastUpdateTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxBatchSize",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxUnstakeAllLimit",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextSlotId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftCollection",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"pendingRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"poolSlots",outputs:[{internalType:"address",name:"originalStaker",type:"address"},{internalType:"uint256",name:"stakedAt",type:"uint256"},{internalType:"bool",name:"active",type:"bool"},{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"poolTokens",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiptContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptToSlot",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rewardPerToken",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"newMaxBatchSize",type:"uint256"},{internalType:"uint256",name:"newMaxUnstakeAll",type:"uint256"}],name:"setBatchLimits",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newShare",type:"uint256"}],name:"setStonerShare",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newFeeInWei",type:"uint256"}],name:"setSwapFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"stakeNFT",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"stakeNFTBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"stonerPool",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"stonerShare",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"swapFeeInWei",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenIdIn",type:"uint256"}],name:"swapNFT",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIdsIn",type:"uint256[]"}],name:"swapNFTBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"tokenIndexInPool",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalActiveSlots",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalRewardsDistributed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unstakeAllNFTs",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"receiptTokenId",type:"uint256"}],name:"unstakeNFT",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"receiptTokenIds",type:"uint256[]"}],name:"unstakeNFTBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"userRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"userSlots",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}];function Fe({image:n,tokenId:a,size:r=64,isReceiptToken:i=!1,poolSlotId:p,name:y}){const[u,f]=Ae.useState(!1),[t,d]=Ae.useState(!0);return i&&n&&!u?e.jsxs("div",{className:"relative",style:{width:r,height:r},children:[t&&e.jsx("div",{style:{width:r,height:r},className:"absolute inset-0 bg-gradient-to-br from-yellow-100 to-amber-200 dark:from-yellow-900/30 dark:to-amber-900/30 rounded-lg flex items-center justify-center animate-pulse border-2 border-yellow-300 dark:border-yellow-600",children:e.jsx("div",{className:"w-4 h-4 border-2 border-yellow-500 border-t-transparent rounded-full animate-spin"})}),e.jsx("img",{src:n,alt:y||`Receipt Token #${a}`,style:{width:r,height:r},className:`object-cover rounded-lg border-2 border-yellow-400 dark:border-yellow-500 shadow-md ${t?"opacity-0":"opacity-100"} transition-opacity duration-200`,onLoad:()=>d(!1),onError:()=>f(!0)}),e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-yellow-500 rounded-full flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-[8px]",children:"🧾"})})]}):!n||u?i?e.jsx("div",{style:{width:r,height:r},className:"bg-gradient-to-br from-yellow-100 to-amber-200 dark:from-yellow-900/30 dark:to-amber-900/30 rounded-lg flex items-center justify-center text-yellow-800 dark:text-yellow-200 text-xs font-mono border-2 border-yellow-300 dark:border-yellow-600 shadow-md",title:y||`Receipt Token #${a}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"🧾"}),e.jsxs("div",{className:"text-[10px]",children:["#",p||a]})]})}):e.jsx("div",{style:{width:r,height:r},className:"bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 rounded-lg flex items-center justify-center text-gray-600 dark:text-gray-400 text-xs font-mono border border-gray-300 dark:border-gray-600 shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg mb-1",children:"🖼️"}),e.jsxs("div",{children:["#",a]})]})}):e.jsxs("div",{className:"relative",style:{width:r,height:r},children:[t&&e.jsx("div",{style:{width:r,height:r},className:"absolute inset-0 bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-700 dark:to-gray-800 rounded-lg flex items-center justify-center animate-pulse",children:e.jsx("div",{className:"w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin"})}),e.jsx("img",{src:n,alt:`NFT #${a}`,style:{width:r,height:r},className:"rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 object-cover",onError:()=>f(!0),onLoad:()=>d(!1)})]})}function Ee({count:n=6,size:a=56}){return e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:Array.from({length:n}).map((r,i)=>e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("div",{className:"shimmer rounded-xl border-2 border-gray-200 dark:border-gray-700 shadow-sm",style:{width:a+8,height:a+32},children:[e.jsx("div",{className:"bg-gray-300 dark:bg-gray-600 rounded-lg m-1 animate-pulse",style:{width:a,height:a}}),e.jsx("div",{className:"h-3 bg-gray-300 dark:bg-gray-600 rounded mx-2 mt-2 animate-pulse"})]})},i))})}const Ke=o.createContext(),Le=()=>{const n=o.useContext(Ke);if(!n)throw new Error("useToast must be used within a ToastProvider");return n};function xt({children:n}){const[a,r]=o.useState([]),i=o.useCallback((d,l="info",h=5e3,v=null)=>{const x=Date.now()+Math.random(),_={id:x,message:d,type:l,txHash:v,createdAt:Date.now()};return r(M=>[...M,_]),h>0&&setTimeout(()=>{r(M=>M.filter(W=>W.id!==x))},h),x},[]),p=o.useCallback(d=>{r(l=>l.filter(h=>h.id!==d))},[]),y=o.useCallback((d,l=null,h=5e3)=>i(d,"success",h,l),[i]),u=o.useCallback((d,l=7e3)=>i(d,"error",l),[i]),f=o.useCallback((d,l=5e3)=>i(d,"info",l),[i]),t=o.useCallback((d,l=null)=>i(d,"loading",0,l),[i]);return e.jsxs(Ke.Provider,{value:{success:y,error:u,info:f,loading:t,removeToast:p},children:[n,e.jsx(ft,{toasts:a,onRemove:p})]})}function ft({toasts:n,onRemove:a}){return e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 pointer-events-none",children:n.map(r=>e.jsx(bt,{toast:r,onRemove:a},r.id))})}function bt({toast:n,onRemove:a}){const r=()=>{switch(n.type){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200";case"loading":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200";default:return"bg-gray-50 dark:bg-gray-900/20 border-gray-200 dark:border-gray-800 text-gray-800 dark:text-gray-200"}},i=()=>{switch(n.type){case"success":return e.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})});case"error":return e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})});case"loading":return e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"});default:return e.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs",children:"ℹ"})})}};return e.jsx("div",{className:`max-w-md w-full p-4 rounded-xl border shadow-lg backdrop-blur-sm pointer-events-auto transform transition-all duration-300 animate-slide-in ${r()}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[i(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium leading-relaxed",children:n.message}),n.txHash&&e.jsx("a",{href:`https://sonicscan.org/tx/${n.txHash}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs underline opacity-75 hover:opacity-100 transition-opacity mt-1 inline-block",children:"View Transaction →"})]}),e.jsx("button",{onClick:()=>a(n.id),className:"opacity-50 hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})}function wt(){const[n,a]=o.useState({}),r=Le();return{startTransaction:(d,l="Transaction pending...")=>{const h=r.loading(l);a(v=>({...v,[d]:{status:"pending",message:l,toastId:h,startTime:Date.now()}}))},updateTransaction:(d,l,h)=>{a(v=>{const x=v[d];if(!x)return v;r.removeToast(x.toastId);const _=r.success(h,l);return{...v,[d]:{...x,status:"success",txHash:l,message:h,toastId:_}}})},failTransaction:(d,l)=>{a(h=>{const v=h[d];if(!v)return h;r.removeToast(v.toastId);let x="Transaction failed";l!=null&&l.message&&(l.message.includes("user rejected")?x="Transaction cancelled by user":l.message.includes("insufficient funds")?x="Insufficient funds for transaction":x=l.message);const _=r.error(x);return{...h,[d]:{...v,status:"failed",message:x,toastId:_}}})},clearTransaction:d=>{a(l=>{const h=l[d];h!=null&&h.toastId&&r.removeToast(h.toastId);const{[d]:v,...x}=l;return x})},isTransactionPending:d=>{var l;return((l=n[d])==null?void 0:l.status)==="pending"},getTransactionState:d=>n[d]||null}}function Qe(){const n=wt();return Le(),{...n,executeTransaction:async(r,i,p={})=>{const{pendingMessage:y="Transaction pending...",successMessage:u="Transaction successful!",onSuccess:f,onError:t}=p;try{n.startTransaction(r,y);const d=await i();let l=null,h=u;if(d!=null&&d.hash&&(l=d.hash,d.wait&&(await d.wait()).status===0))throw new Error("Transaction failed during execution");return n.updateTransaction(r,l,h),f&&f(d),d}catch(d){throw console.error(`Transaction ${r} failed:`,d),n.failTransaction(r,d),t&&t(d),d}}}}function vt({walletNFTs:n,poolNFTs:a,loading:r,onSwap:i,status:p,swapFee:y,provider:u,userAddress:f}){const[t,d]=o.useState([]),[l,h]=o.useState("0"),[v,x]=o.useState(!1),_=Le(),{executeTransaction:M,isTransactionPending:W}=Qe(),ne=async()=>{if(!u||!f||!y||t.length===0){x(!1);return}try{const A=await u.getBalance(f);h(A.toString());const E=qe((parseFloat(y)*t.length).toString()),ee=A<E;x(ee)}catch(A){console.error("Error checking balance:",A),x(!1)}};o.useEffect(()=>{ne()},[t.length,y,f,u]);const ae=async()=>{if(t.length===0){_.error("Please select NFTs to swap");return}try{await M("swap",()=>i(t),{pendingMessage:`Swapping ${t.length} NFT${t.length>1?"s":""}...`,successMessage:`Successfully swapped ${t.length} NFT${t.length>1?"s":""}!`,onSuccess:()=>{d([])},onError:A=>{console.error("Swap failed:",A)}})}catch{}},P=W("swap");return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 1H4m0 0l4 4M4 12l4-4"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-indigo-400 bg-clip-text text-transparent",children:"Swap Your NFTs"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Exchange your NFTs with those available in the pool"})]})]})}),e.jsx("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-3 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selected:"}),e.jsxs("div",{className:`px-2 py-1 rounded-full text-sm font-medium ${t.length>8?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300":t.length>0?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400"}`,children:[t.length,"/10 NFTs"]})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Max 10 per batch"})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("h3",{className:"text-base font-semibold text-gray-800 dark:text-gray-200",children:["Your NFTs (",n.length,")"]})]}),e.jsx("div",{className:"bg-white/75 dark:bg-gray-800/75 rounded-xl p-3 border border-gray-200 dark:border-gray-700",children:r?e.jsx(Ee,{count:6,size:56}):n.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-3xl mb-2",children:"🖼️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No NFTs found in your wallet"})]}):e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:n.map(A=>e.jsxs("button",{className:`relative border-2 rounded-lg p-1.5 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-sm transition-all duration-200 ${t.includes(A.tokenId)?"border-blue-400 scale-105 ring-2 ring-blue-400/50 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-blue-300 hover:shadow-md"} ${t.length>=10&&!t.includes(A.tokenId)?"opacity-50 cursor-not-allowed":"cursor-pointer"}`,onClick:()=>{t.includes(A.tokenId)?d(E=>E.filter(ee=>ee!==A.tokenId)):t.length<10&&d(E=>[...E,A.tokenId])},disabled:r||t.length>=10&&!t.includes(A.tokenId),children:[e.jsx(Fe,{image:A.image,tokenId:A.tokenId,size:56}),e.jsxs("div",{className:"text-xs text-center mt-1 font-mono text-gray-500 dark:text-gray-400",children:["#",A.tokenId]}),t.includes(A.tokenId)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},A.tokenId))})})]}),e.jsxs("div",{className:"bg-white/95 dark:bg-gray-800/95 rounded-xl p-4 border border-gray-200 dark:border-gray-700 shadow-sm",children:[t.length>0&&y&&e.jsxs("div",{className:"flex items-center justify-between mb-3 px-3 py-2 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),e.jsxs("span",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:["Total Cost: ",(parseFloat(y)*t.length).toFixed(2)," S"]})]}),e.jsxs("span",{className:"text-xs text-amber-600 dark:text-amber-400",children:[t.length," × ",parseFloat(y).toFixed(2)," S"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{className:`flex-1 px-6 py-4 text-white rounded-xl shadow-lg font-semibold text-lg tracking-wide transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 ${a.length===0?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":P?"bg-gradient-to-r from-blue-400 to-indigo-400 animate-pulse-glow":"bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 hover:shadow-xl hover:scale-105"}`,onClick:ae,disabled:P||t.length===0||a.length===0,title:a.length===0?"Pool is empty - stake NFTs first to enable swapping":"",children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Swapping"})]}):a.length===0?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Pool Empty - Stake NFTs First"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 1H4m0 0l4 4M4 12l4-4"})}),y?`Swap ${t.length} NFT${t.length>1?"s":""} (${(parseFloat(y)*t.length).toFixed(2)} S)`:`Swap Selected NFTs (${t.length})`]})}),t.length>0&&!P&&e.jsxs("button",{className:"px-4 py-4 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl shadow hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-2",onClick:()=>d([]),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})]}),v&&t.length>0&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 mt-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 dark:bg-red-900/40 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-4 h-4 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-red-800 dark:text-red-200 mb-1",children:"Insufficient Balance"}),e.jsxs("p",{className:"text-xs text-red-700 dark:text-red-300",children:["You need ",(parseFloat(y)*t.length).toFixed(4)," S to swap ",t.length," NFT",t.length>1?"s":"",", but you only have ",ge(l)," S available."]}),e.jsx("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:"Please add more funds to your wallet or reduce the number of NFTs to swap."})]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-r from-purple-500 to-indigo-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsxs("h3",{className:"text-base font-semibold text-gray-800 dark:text-gray-200",children:["Available in Pool (",a.length,")"]})]}),e.jsx("div",{className:"bg-white/75 dark:bg-gray-800/75 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:r?e.jsx(Ee,{count:6,size:48}):a.length===0?e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"text-3xl mb-2",children:"🏊‍♂️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Pool is empty - stake NFTs first to enable swapping"})]}):e.jsx("div",{className:"max-h-[300px] overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2",children:a.map(A=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-1.5 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-sm",children:[e.jsx(Fe,{image:A.image,tokenId:A.tokenId,size:48}),e.jsxs("div",{className:"text-xs text-center mt-1 font-mono text-gray-500 dark:text-gray-400",children:["#",A.tokenId]})]},A.tokenId))})})})]}),p&&e.jsx("div",{className:`p-4 rounded-xl border transition-all duration-300 ${p.includes("successful")||p.includes("Swap successful")?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200":p.includes("failed")||p.includes("error")||p.includes("❌")?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":p.includes("Swapping")?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200":"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-800 dark:text-amber-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:p.includes("successful")||p.includes("Swap successful")?e.jsx("div",{className:"w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):p.includes("failed")||p.includes("error")||p.includes("❌")?e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}):p.includes("Swapping")?e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):e.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm leading-5",children:p}),p.includes("Swapping")&&e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"This may take a few moments to complete..."})]})]})})]})}function kt({nftAddress:n,tokenId:a,spender:r,provider:i,onApproved:p,disabled:y}){const[u,f]=o.useState(!1),[t,d]=o.useState(!1),[l,h]=o.useState("");o.useEffect(()=>{if(d(!1),h(""),!n||!a||!r||!i)return;(async()=>{try{const M=await new L(n,["function getApproved(uint256) view returns (address)","function approve(address,uint256) external"],i).getApproved(a);d(M.toLowerCase()===r.toLowerCase())}catch{h("Failed to check approval")}})()},[n,a,r,i]);const v=async()=>{f(!0),h("");try{if(!window.ethereum)throw new Error("Wallet not found");const x=new Re(window.ethereum).getSigner();await(await new L(n,["function approve(address,uint256) external"],await x).approve(r,a)).wait(),d(!0),p&&p()}catch(x){h(x.reason||x.message)}f(!1)};return a?t?e.jsxs("div",{className:"flex items-center gap-1 ml-2 px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded-lg text-xs font-medium border border-green-200 dark:border-green-700",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Approved"]}):e.jsx("button",{className:"ml-2 px-3 py-1.5 bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 text-white rounded-lg text-xs font-medium shadow-sm transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",onClick:v,disabled:u||y,children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve"]})}):null}function Tt({walletNFTs:n,receiptNFTs:a,stakedNFTs:r,loading:i,receiptLoading:p,onStake:y,onUnstake:u,onClaimRewards:f,status:t,approvedMap:d,isApprovedForAll:l,onApproveAll:h,approvingAll:v,nftCollection:x,swapPool:_,provider:M,pendingRewards:W="0",stakerShare:ne=null,swapFee:ae=null}){console.log("🖼️ StakingInterface received props:",{walletNFTs:(n==null?void 0:n.length)||0,receiptNFTs:(a==null?void 0:a.length)||0,stakedNFTs:(r==null?void 0:r.length)||0,receiptLoading:p,pendingRewards:W});const[P,A]=o.useState([]),[E,ee]=o.useState([]),ue=Le(),{executeTransaction:xe,isTransactionPending:z}=Qe(),ke=async()=>{if(P.length===0){ue.error("Please select NFTs to stake");return}try{await xe("stake",()=>y(P),{pendingMessage:`Staking ${P.length} NFT${P.length>1?"s":""}...`,successMessage:`Successfully staked ${P.length} NFT${P.length>1?"s":""}!`,onSuccess:()=>{A([])}})}catch{}},fe=async()=>{if(E.length===0){ue.error("Please select staked NFTs to unstake");return}try{await xe("unstake",()=>u(E),{pendingMessage:`Unstaking ${E.length} NFT${E.length>1?"s":""}...`,successMessage:`Successfully unstaked ${E.length} NFT${E.length>1?"s":""}!`,onSuccess:()=>{ee([])}})}catch{}},pe=async()=>{if(W==="0"||W==="0.0"){ue.info("No rewards to claim at the moment");return}try{await xe("claim",()=>f(),{pendingMessage:"Claiming rewards...",successMessage:`Successfully claimed ${W} S tokens!`})}catch{}},be=P.length>0&&P.every(B=>d[B]||l),we=z("stake"),Te=z("unstake"),ie=z("claim");return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-green-400 to-emerald-400 bg-clip-text text-transparent",children:"Stake Your NFTs"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Stake NFTs to earn rewards and contribute to the swap pool"})]})]})}),r.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 rounded-xl p-6 border border-yellow-200 dark:border-yellow-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-xl flex items-center justify-center shadow-md",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"💰"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-yellow-800 dark:text-yellow-200",children:"Staking Rewards"}),e.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Earn from swap fees and trading activity"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-yellow-800 dark:text-yellow-200",children:[parseFloat(W).toFixed(4)," S"]}),e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Pending Rewards"})]})]}),e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-yellow-600/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-500/20 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-yellow-400 text-sm",children:"💎"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-yellow-200",children:"Swap Fee Earnings"}),e.jsx("div",{className:"text-xs text-yellow-300/70",children:"From your staked NFTs generating trading fees"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-yellow-200",children:[r.length," NFT",r.length!==1?"s":""]}),e.jsx("div",{className:"text-xs text-yellow-300/70",children:"Currently Staked"})]})]}),ne!==null&&ae!==null&&e.jsx("div",{className:"mb-3 p-3 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg border border-blue-500/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400 text-sm",children:"📊"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-blue-200",children:"Staker Fee Share"}),e.jsxs("div",{className:"text-xs text-blue-300/70",children:["Of each ",ae," S swap fee"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-200",children:[ne,"%"]}),e.jsx("div",{className:"text-xs text-blue-300/70",children:"Goes to Stakers"})]})]})}),e.jsx("button",{onClick:pe,disabled:ie||parseFloat(W)===0,className:`w-full px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${ie?"bg-gradient-to-r from-yellow-400 to-amber-400 animate-pulse-glow":"bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600"}`,children:ie?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Claiming"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),parseFloat(W)>0?`Claim ${parseFloat(W).toFixed(4)} S`:"No Rewards Available"]})})]}),parseFloat(W)===0&&r.length>0&&e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"text-xs text-yellow-300/60 bg-yellow-900/30 px-3 py-2 rounded-lg border border-yellow-700/30",children:["💡 ",e.jsx("strong",{children:"Tip:"})," Rewards accumulate as users swap NFTs in this pool. Check back later!"]})})]}),e.jsx("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selected to Stake:"}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${P.length>0?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-300":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 border border-gray-300"}`,children:[P.length," NFTs"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Selected to Unstake:"}),e.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${E.length>0?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-300":"bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 border border-gray-300"}`,children:[E.length," NFTs"]})]})]})}),n.length>0&&!l&&e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4 border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-800 dark:text-blue-200",children:"Approval Required"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Approve all NFTs for easier staking"})]})]}),e.jsx("button",{onClick:h,disabled:v,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Approving..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve All"]})})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Available to Stake (",n.length,")"]})]}),e.jsx("div",{className:"min-h-[120px] bg-white/75 dark:bg-gray-800/75 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:i?e.jsx(Ee,{count:6,size:64}):n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🖼️"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No NFTs available to stake"})]}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:n.map(B=>e.jsxs("div",{className:"relative",children:[e.jsxs("button",{className:`relative border-2 rounded-xl p-2 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 shadow-sm transition-all duration-200 w-full ${P.includes(B.tokenId)?"border-green-400 scale-105 ring-2 ring-green-400/50 shadow-lg":"border-gray-200 dark:border-gray-700 hover:border-green-300 hover:shadow-md"}`,onClick:()=>{P.includes(B.tokenId)?A(G=>G.filter(Me=>Me!==B.tokenId)):A(G=>[...G,B.tokenId])},disabled:i,children:[e.jsx(Fe,{image:B.image,tokenId:B.tokenId,size:64}),e.jsxs("div",{className:"text-xs text-center mt-2 font-mono text-gray-600 dark:text-gray-400",children:["#",B.tokenId]}),P.includes(B.tokenId)&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),!l&&!d[B.tokenId]&&P.includes(B.tokenId)&&e.jsx("div",{className:"mt-2",children:e.jsx(kt,{nftAddress:x,tokenId:B.tokenId,spender:_,provider:M,disabled:i})})]},B.tokenId))})})]}),console.log("🧪 Checking receiptNFTs for render:",a,a==null?void 0:a.length,(a==null?void 0:a.length)>0),a.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-yellow-500 to-amber-500 rounded-lg flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Currently Staked (",a.length,")"]})]}),e.jsx("div",{className:"min-h-[120px] bg-white/75 dark:bg-gray-800/75 rounded-xl p-4 border border-gray-200 dark:border-gray-700",children:p?e.jsx(Ee,{count:6,size:64}):e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3",children:a.map(B=>e.jsxs("button",{className:`relative border-2 rounded-xl p-2 bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 shadow-sm transition-all duration-200 ${E.includes(B.tokenId)?"border-red-400 scale-105 ring-2 ring-red-400/50 shadow-lg":"border-yellow-200 dark:border-yellow-700 hover:border-red-300 hover:shadow-md"}`,onClick:()=>{E.includes(B.tokenId)?ee(G=>G.filter(Me=>Me!==B.tokenId)):ee(G=>[...G,B.tokenId])},disabled:i,children:[e.jsx(Fe,{image:B.image,tokenId:B.tokenId,size:64,isReceiptToken:B.isReceiptToken,poolSlotId:B.poolSlotId,name:B.name}),e.jsxs("div",{className:"text-xs text-center mt-2 font-mono text-yellow-700 dark:text-yellow-300",children:["#",B.tokenId]}),E.includes(B.tokenId)&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsx("div",{className:"absolute -bottom-1 -left-1 bg-yellow-500 text-white text-xs px-1 py-0.5 rounded text-[10px] font-bold",children:"STAKED"})]},B.tokenId))})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:`w-full px-6 py-4 text-white rounded-xl shadow-lg font-semibold text-lg tracking-wide transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 ${P.length===0||!be?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":we?"bg-gradient-to-r from-green-400 to-emerald-400 animate-pulse-glow":"bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 hover:shadow-xl hover:scale-105"}`,onClick:ke,disabled:we||P.length===0||!be,children:we?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Staking"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"Stake Selected (",P.length,")"]})}),P.length>0&&e.jsxs("button",{className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center justify-center gap-2",onClick:()=>A([]),disabled:i,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear Selection"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{className:`w-full px-6 py-4 text-white rounded-xl shadow-lg font-semibold text-lg tracking-wide transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 ${E.length===0?"bg-gradient-to-r from-gray-400 to-gray-500 cursor-not-allowed":Te?"bg-gradient-to-r from-red-400 to-pink-400 animate-pulse-glow":"bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 hover:shadow-xl hover:scale-105"}`,onClick:fe,disabled:Te||E.length===0,children:Te?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"loading-dots",children:"Unstaking"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"Unstake Selected (",E.length,")"]})}),E.length>0&&e.jsxs("button",{className:"w-full px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center justify-center gap-2",onClick:()=>ee([]),disabled:i,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear Selection"]})]})]}),t&&e.jsx("div",{className:`p-4 rounded-xl border transition-all duration-300 ${t.includes("successful")||t.includes("claimed")||t.includes("Stake successful")||t.includes("Unstake successful")||t.includes("Rewards claimed")?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200":t.includes("failed")||t.includes("error")||t.includes("❌")||t.includes("Cannot")?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":t.includes("Staking...")||t.includes("Unstaking...")||t.includes("Claiming")?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200":"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800 text-amber-800 dark:text-amber-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:t.includes("successful")||t.includes("claimed")||t.includes("Stake successful")||t.includes("Unstake successful")||t.includes("Rewards claimed")?e.jsx("div",{className:"w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}):t.includes("failed")||t.includes("error")||t.includes("❌")||t.includes("Cannot")?e.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}):t.includes("Staking...")||t.includes("Unstaking...")||t.includes("Claiming")?e.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):e.jsx("div",{className:"w-5 h-5 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm leading-5",children:t}),(t.includes("Staking...")||t.includes("Unstaking...")||t.includes("Claiming"))&&e.jsx("div",{className:"text-xs opacity-75 mt-1",children:"This may take a few moments to complete..."})]})]})})]})}const Xe=o.createContext(),Be=()=>{const n=o.useContext(Xe);if(!n)throw new Error("useWallet must be used within a WalletProvider");return n},Nt=({children:n})=>{const[a,r]=o.useState(""),[i,p]=o.useState(null),[y,u]=o.useState(null),[f,t]=o.useState(!1),[d,l]=o.useState(!1);o.useEffect(()=>{(async()=>{if(window.ethereum)try{(await window.ethereum.request({method:"eth_accounts"})).length>0&&await h()}catch{console.log("No existing wallet connection found")}})()},[]),o.useEffect(()=>{const M=async ne=>{ne.length===0?v():ne[0]!==a&&await h()},W=()=>{window.location.reload()};return window.ethereum&&(window.ethereum.on("accountsChanged",M),window.ethereum.on("chainChanged",W)),()=>{window.ethereum&&(window.ethereum.removeListener("accountsChanged",M),window.ethereum.removeListener("chainChanged",W))}},[a]);const h=async()=>{if(!window.ethereum)throw new Error("Please install MetaMask or another wallet");t(!0);try{await window.ethereum.request({method:"eth_requestAccounts"});const M=new Re(window.ethereum),W=await M.getSigner(),ne=await W.getAddress(),ae=await M.getNetwork(),P=ae.chainId===146n;return p(M),u(W),r(ne),l(P),console.log(`🔗 Wallet connected: ${ne}`),console.log(`🌐 Network: ${ae.name} (${ae.chainId})`),P||console.warn("⚠️ Not on Sonic network"),{address:ne,provider:M,signer:W,isCorrectNetwork:P}}catch(M){throw console.error("Wallet connection failed:",M),M}finally{t(!1)}},v=()=>{r(""),p(null),u(null),l(!1),console.log("🔌 Wallet disconnected")},_={address:a,provider:i,signer:y,isConnecting:f,isCorrectNetwork:d,connectWallet:h,disconnect:v,switchToSonicNetwork:async()=>{if(!window.ethereum)return!1;try{return await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x92"}]}),!0}catch(M){if(M.code===4902)try{return await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x92",chainName:"Sonic Network",nativeCurrency:{name:"Sonic",symbol:"S",decimals:18},rpcUrls:["https://rpc.soniclabs.com/"],blockExplorerUrls:["https://sonicscan.org/"]}]}),!0}catch(W){return console.error("Failed to add Sonic network:",W),!1}return console.error("Failed to switch to Sonic network:",M),!1}},isConnected:!!a};return e.jsx(Xe.Provider,{value:_,children:n})};function jt({swapPool:n,stakeReceipt:a,provider:r}){const{address:i,isConnected:p}=Be(),[y,u]=o.useState(null),[f,t]=o.useState(""),[d,l]=o.useState(!1),[h,v]=o.useState([]),[x,_]=o.useState({}),[M,W]=o.useState(null),[ne,ae]=o.useState(!1),[P,A]=o.useState(!1),[E,ee]=o.useState([]),[ue,xe]=o.useState([]),[z,ke]=o.useState([]),[fe,pe]=o.useState(!1),[be,we]=o.useState(!1),[Te,ie]=o.useState(!1),[B,G]=o.useState(null),[Me,Ne]=o.useState("0"),[c,F]=o.useState(null),[H,me]=o.useState(null),[m,C]=o.useState(null),R=async()=>{if(!window.ethereum)throw new Error("Wallet not found");return new Re(window.ethereum).getSigner()},N=async s=>{var g,T;if(s.length===0){t("Please select at least one NFT to swap");return}if(s.length>10){t("You can only swap up to 10 NFTs at once.");return}if(z.length<s.length){z.length===0?t("❌ Cannot swap: Pool is empty! You need to stake some NFTs first to create liquidity for swapping."):t(`❌ Insufficient liquidity: Only ${z.length} NFT${z.length!==1?"s":""} available in pool, but you selected ${s.length}. Stake more NFTs or reduce your selection.`);return}l(!0),t("");try{const b=await R(),S=new L(n,ve,b),se=new L(M,["function approve(address,uint256)","function getApproved(uint256) view returns (address)","function ownerOf(uint256) view returns (address)","function setApprovalForAll(address,bool)","function isApprovedForAll(address,address) view returns (bool)"],b),Y=await b.getAddress();t("Verifying ownership and token validity...");for(const k of s)try{const re=await se.ownerOf(k);if(re.toLowerCase()!==Y.toLowerCase()){t(`❌ You don't own NFT #${k}`),l(!1);return}const de=await S.getPoolTokens(),he=de.map(K=>K.toString());if(console.log(`🔍 Debug - Token #${k} check:`,{tokenId:k.toString(),owner:re,poolTokensCount:de.length,isInPool:he.includes(k.toString())}),he.includes(k.toString())){t(`❌ NFT #${k} is already in the pool and cannot be swapped`),l(!1);return}}catch(re){(g=re.reason)!=null&&g.includes("ERC721: invalid token ID")||(T=re.reason)!=null&&T.includes("ERC721: owner query for nonexistent token")?t(`❌ NFT #${k} does not exist`):t(`❌ Failed to verify NFT #${k}: ${re.message}`),l(!1);return}if(t("Checking approvals..."),!await se.isApprovedForAll(Y,n))try{t("Requesting approval for all NFTs..."),await(await se.setApprovalForAll(n,!0)).wait(),t("✅ Approval granted for all NFTs")}catch(k){if(k.code==="ACTION_REJECTED"){t("❌ User cancelled approval transaction"),l(!1);return}t(`❌ Failed to approve NFTs: ${k.message}`),l(!1);return}t("Validating contract state...");try{if(!await S.initialized()){t("❌ Pool is not initialized"),l(!1);return}}catch(k){console.warn("Could not check initialized state:",k)}try{if(await S.paused()){t("❌ Pool is currently paused"),l(!1);return}}catch(k){console.warn("Could not check paused state:",k)}const D=await S.getPoolTokens();if(console.log("🏊 Pool liquidity check:",{availableTokens:D.length,requestedSwaps:s.length,hasEnoughLiquidity:D.length>=s.length}),D.length<s.length){t(`❌ Insufficient pool liquidity: Only ${D.length} NFT${D.length!==1?"s":""} available, need ${s.length}`),l(!1);return}if(D.length===0){t("❌ Pool is empty - no NFTs available for swapping"),l(!1);return}const X=await S.swapFeeInWei();console.log("Swap fee per NFT:",ge(X),"ETH");const q=await r.getBalance(Y),Z=X*BigInt(s.length);if(q<Z){t(`❌ Insufficient balance. Need ${ge(Z)} ETH, have ${ge(q)} ETH`),l(!1);return}t(`Swapping ${s.length} NFT${s.length>1?"s":""}...`),t("Estimating transaction cost...");let $;try{if(s.length>1&&S.swapNFTBatch){const k=await S.swapNFTBatch.estimateGas(s,{value:Z});console.log("Batch swap gas estimate:",k.toString()),$=await S.swapNFTBatch(s,{value:Z})}else{const k=await S.swapNFT.estimateGas(s[0],{value:X});console.log("Single swap gas estimate:",k.toString()),$=await S.swapNFT(s[0],{value:X})}}catch(k){console.error("Gas estimation failed:",k),k.reason?t(`❌ Transaction would fail: ${k.reason}`):k.message.includes("insufficient funds")?t("❌ Insufficient funds for gas + swap fee"):k.message.includes("execution reverted")?t("❌ Transaction would be reverted by contract"):k.data?t(`❌ Contract error: ${k.data}`):t(`❌ Transaction validation failed: ${k.message}`),l(!1);return}await $.wait(),t(`✅ Successfully swapped ${s.length} NFT${s.length>1?"s":""}!`),await O()}catch(b){if(console.error("Swap error:",b),b.code==="ACTION_REJECTED")t("❌ User cancelled transaction");else if(b.data==="0xa17e11d5"||b.message.includes("InsufficientLiquidity"))t(`❌ Insufficient liquidity: Not enough NFTs in pool for ${s.length} swap${s.length>1?"s":""}`);else if(b.data==="0xa0712d68"||b.message.includes("SameTokenSwap"))t("❌ Cannot swap: One of your NFTs is already in the pool");else if(b.data==="0x82b42900"||b.message.includes("TokenNotApproved"))t("❌ NFT not approved for transfer");else if(b.data==="0x8baa579f"||b.message.includes("NotTokenOwner"))t("❌ You do not own one or more of the selected NFTs");else if(b.data==="0x025dbdd4"||b.message.includes("IncorrectFee"))t("❌ Incorrect swap fee sent");else if(b.data==="0xd05cb609"||b.message.includes("NotInitialized"))t("❌ Pool not initialized");else{const S=b.reason||b.message||"Unknown error";t("❌ Swap failed: "+S)}}l(!1)},w=async s=>{var T,b;if(s.length===0){t("Please select at least one NFT to stake");return}if(s.length>10){t("You can only stake up to 10 NFTs at once.");return}if(new Set(s).size!==s.length){t("Duplicate NFTs selected. Please select each NFT only once.");return}l(!0),t("");try{const S=await R(),se=new L(n,ve,S),Y=new L(M,["function approve(address,uint256)","function getApproved(uint256) view returns (address)","function ownerOf(uint256) view returns (address)","function setApprovalForAll(address,bool)","function isApprovedForAll(address,address) view returns (bool)"],S),ye=await S.getAddress();t("Verifying ownership and token validity...");for(const q of s)try{if((await Y.ownerOf(q)).toLowerCase()!==ye.toLowerCase()){t(`❌ You don't own NFT #${q}`),l(!1);return}}catch(Z){(T=Z.reason)!=null&&T.includes("ERC721: invalid token ID")||(b=Z.reason)!=null&&b.includes("ERC721: owner query for nonexistent token")?t(`❌ NFT #${q} does not exist`):t(`❌ Failed to verify NFT #${q}: ${Z.message}`),l(!1);return}if(t("Checking approvals..."),!await Y.isApprovedForAll(ye,n))try{t("Requesting approval for all NFTs..."),await(await Y.setApprovalForAll(n,!0)).wait(),t("✅ Approval granted for all NFTs")}catch(q){if(q.code==="ACTION_REJECTED"){t("❌ User cancelled approval transaction"),l(!1);return}t(`❌ Failed to approve NFTs: ${q.message}`),l(!1);return}t(`Staking ${s.length} NFT${s.length>1?"s":""}...`);let X;s.length>1?X=await se.stakeNFTBatch(s):X=await se.stakeNFT(s[0]),await X.wait(),t(`✅ Successfully staked ${s.length} NFT${s.length>1?"s":""}!`),await O()}catch(S){if(console.error("Stake error:",S),S.code==="ACTION_REJECTED")t("❌ User cancelled transaction");else{const se=S.reason||S.message||"Unknown error";t("❌ Stake failed: "+se)}}l(!1)},I=async s=>{if(s.length===0){t("Please select at least one NFT to unstake");return}if(s.length>10){t("You can only unstake up to 10 NFTs at once.");return}l(!0),t("");try{const g=await R(),T=new L(n,ve,g);t(`Unstaking ${s.length} NFT${s.length>1?"s":""}...`);let b;s.length>1&&T.unstakeNFTBatch?b=await T.unstakeNFTBatch(s):b=await T.unstakeNFT(s[0]),await b.wait(),t(`✅ Successfully unstaked ${s.length} NFT${s.length>1?"s":""}!`),await O()}catch(g){if(console.error("Unstake error:",g),g.code==="ACTION_REJECTED")t("❌ User cancelled transaction");else{const T=g.reason||g.message||"Unknown error";t("❌ Unstake failed: "+T)}}l(!1)},V=async()=>{l(!0),t("Claiming rewards..."),console.log("💰 Starting reward claim process...");try{const s=await R();console.log("💰 Got signer, creating swap pool contract...");const g=new L(n,ve,s),T=await g.earned(i);if(console.log(`💰 Pending rewards: ${ge(T)} S`),T.toString()==="0"){t("No rewards to claim"),console.log("💰 No rewards available to claim"),l(!1);return}console.log("💰 Calling claimRewards on swap pool...");const b=await g.claimRewards();console.log("💰 Transaction sent, waiting for confirmation...",b.hash),await b.wait(),console.log("💰 Rewards claimed successfully!"),t("Rewards claimed successfully! ✅"),await j()}catch(s){console.error("💰 Claim rewards error:",s);const g=s.reason||s.message||"Unknown error";t(`Claim failed: ${g}`)}l(!1)},Q=async()=>{A(!0);try{const s=await R();await(await new L(M,["function setApprovalForAll(address,bool) external"],s).setApprovalForAll(n,!0)).wait(),ae(!0),t("Approval successful! You can now stake NFTs.")}catch(s){t(`Approval failed: ${s.reason||s.message}`)}A(!1)},O=async()=>{console.log("Refreshing NFT data...",{account:i,isConnected:p}),pe(!0),we(!0),ie(!0),v([]),xe([]),ke([]),await new Promise(g=>setTimeout(g,100));const s=r||(window.ethereum?new Re(window.ethereum):null);if(!s){console.warn("No provider available for NFT fetching"),pe(!1),we(!1),ie(!1);return}if(!p||!i){console.log("No wallet connected, fetching pool NFTs only"),v([]),pe(!1),xe([]),we(!1),ee([]),await U(s);return}console.log("Wallet connected, fetching all NFT data for:",i),await Promise.all([le(i,s),J(i,s),U(s),te(i,s)]),await j()},le=async(s,g)=>{try{const b=await new L(n,ve,g).nftCollection();if(W(b),!b){console.log("❌ Could not get NFT collection address from SwapPool"),v([]),pe(!1);return}const S=new L(b,["function balanceOf(address) view returns (uint256)","function ownerOf(uint256) view returns (address)","function tokenOfOwnerByIndex(address,uint256) view returns (uint256)","function tokenURI(uint256) view returns (string)","function getApproved(uint256) view returns (address)","function isApprovedForAll(address,address) view returns (bool)","function totalSupply() view returns (uint256)"],g),se=await S.balanceOf(s),Y=Number(se);if(console.log(`🎯 Collection NFT Balance for ${s}: ${Y}`),Y===0){console.log("📭 No NFTs owned by user (balance=0)"),v([]),_({}),pe(!1);return}let ye=!1;try{ye=await S.isApprovedForAll(s,n)}catch{}ae(!!ye);let D=[];if(Y>0&&Y<=1e3)try{console.log(`🔍 Trying enumerable approach for ${se.toString()} tokens...`);const $=[];for(let k=0;k<Y;k++)$.push(S.tokenOfOwnerByIndex(s,k));D=await Promise.all($),console.log("✅ Enumerable approach successful, found tokens:",D.map(k=>k.toString()))}catch{console.log("❌ tokenOfOwnerByIndex not supported, using fallback scan"),D=[]}if(D.length===0){console.log("🎯 Starting direct ownership scan...");let $=2e3;try{const K=await S.totalSupply();$=Math.min(Number(K)+100,2e3),console.log(`📈 Total supply: ${K.toString()}, scanning up to token ${$}`)}catch{console.log(`📈 Total supply not available, scanning up to token ${$}`)}const k=new Set,re=20;let de=0;const he=Number(Y);for(let K=1;K<=$&&de<he;K+=re){const je=Math.min(K+re-1,$),Se=[];for(let ce=K;ce<=je;ce++)Se.push(S.ownerOf(ce).then(Pe=>({tokenId:ce,owner:Pe.toLowerCase()})).catch(()=>({tokenId:ce,owner:null})));try{const ce=await Promise.all(Se);for(const{tokenId:Pe,owner:at}of ce)if(at===s.toLowerCase()&&(k.add(Pe.toString()),de++,console.log(`✅ Found owned token: #${Pe} (${de}/${he})`),de>=he))break}catch(ce){console.warn(`Batch ${K}-${je} failed:`,ce.message)}if(de>=he)break;await new Promise(ce=>setTimeout(ce,50))}D=Array.from(k).map(K=>BigInt(K)),console.log(`✅ Direct ownership scan complete, found ${D.length} tokens`)}const X=D.map(async $=>{try{const k=$.toString();let re="",de="";try{if(re=await S.tokenURI($),re){let K=re;re.startsWith("ipfs://")&&(K=re.replace("ipfs://","https://ipfs.io/ipfs/"));try{const Se=await(await fetch(K)).json();Se.image&&(de=Se.image,de.startsWith("ipfs://")&&(de=de.replace("ipfs://","https://ipfs.io/ipfs/")))}catch(je){console.warn(`Failed to fetch metadata for wallet token ${$}:`,je)}}}catch{}let he=!1;try{he=(await S.getApproved($)).toLowerCase()===n.toLowerCase()}catch{}return{tokenId:k,image:de||"",approved:he}}catch(k){return console.warn(`Failed to fetch metadata for token ${$}:`,k),{tokenId:$.toString(),image:"",approved:!1}}}),q=await Promise.all(X);console.log("📦 Wallet NFTs loaded:",q.length);const Z={};q.forEach($=>{Z[$.tokenId]=$.approved}),v(q),_(Z)}catch(T){console.error("Failed to fetch wallet NFTs:",T),v([]),_({})}finally{pe(!1)}},J=async(s,g)=>{console.log(`🧾 Starting fetchReceiptNFTs for address: ${s}`);try{const T=new L(a,["function balanceOf(address) view returns (uint256)","function tokenOfOwnerByIndex(address,uint256) view returns (uint256)","function getPoolSlotId(uint256) view returns (uint256)"],g),b=new L(n,["function getPoolTokens() view returns (uint256[])","function nftCollection() view returns (address)","function poolTokens(uint256) view returns (uint256)"],g),S=await T.balanceOf(s);console.log(`🧾 Receipt balance for ${s}: ${S.toString()}`);const se=await b.getPoolTokens(),Y=await b.nftCollection();console.log(`🧾 Pool has ${se.length} tokens, collection: ${Y}`);const ye=new L(Y,["function tokenURI(uint256) view returns (string)"],g),D=[];for(let X=0;X<Number(S);X++)try{console.log(`🧾 Fetching receipt token ${X+1}/${S}`);const q=await T.tokenOfOwnerByIndex(s,X);console.log(`🧾 Receipt token ID: ${q.toString()}`);let Z;try{Z=await T.getPoolSlotId(q),console.log(`🧾 Pool slot ID: ${Z.toString()}`)}catch{console.log("🧾 getPoolSlotId failed, using receiptTokenId as fallback"),Z=q}let $=Z,k="",re=`Staked NFT #${Z}`;try{console.log(`🧾 Calling poolContract.poolTokens(${Z})...`),$=await b.poolTokens(Z),console.log(`🧾 ✅ Slot ${Z} contains NFT token ID: ${$}`);try{console.log(`🧾 Fetching tokenURI for NFT #${$}...`);const K=await ye.tokenURI($);if(console.log(`🧾 ✅ NFT token URI for #${$}: ${K}`),K&&K.trim()!==""){let je=K;K.startsWith("ipfs://")&&(je=K.replace("ipfs://","https://ipfs.io/ipfs/"),console.log(`🧾 Converted IPFS URL to: ${je}`)),console.log(`🧾 Fetching metadata from: ${je}`);const Se=await fetch(je);if(!Se.ok)throw new Error(`HTTP ${Se.status}: ${Se.statusText}`);const ce=await Se.json();console.log(`🧾 ✅ Fetched metadata for #${$}:`,ce),ce.image&&(k=ce.image,k.startsWith("ipfs://")&&(k=k.replace("ipfs://","https://ipfs.io/ipfs/")),console.log(`🧾 ✅ Image URL: ${k}`)),ce.name&&(re=ce.name,console.log(`🧾 ✅ Name: ${re}`))}else console.warn(`🧾 ⚠️ Empty or invalid tokenURI for NFT #${$}`)}catch(K){console.error(`🧾 ❌ Failed to fetch metadata for NFT #${$}:`,K)}}catch(he){console.error(`🧾 ❌ Failed to get NFT token ID from pool slot ${Z}:`,he)}const de={tokenId:q.toString(),originalTokenId:$.toString(),poolSlotId:Z.toString(),image:k,isReceiptToken:!0,name:re,description:`Receipt for ${re} (Token #${$})`};D.push(de),console.log("🧾 Added receipt token with NFT data:",de)}catch(q){console.error(`🧾 Error fetching receipt token ${X}:`,q.message)}console.log("🧾 Receipt NFTs loaded:",D.length,D),console.log("🧾 Setting receiptNFTs state with:",D),xe(D),setTimeout(()=>{console.log("🧾 Receipt state after update (async check):",D.length)},100)}catch(T){console.error("Failed to fetch receipt NFTs:",T),xe([])}finally{we(!1)}},U=async s=>{try{console.log("🏊 Fetching pool NFTs for pool:",n);const g=new L(n,ve,s),T=await g.getPoolTokens(),b=await g.nftCollection();if(console.log("🏊 Collection address:",b),!b){console.warn("🏊 No collection address found"),ke([]),ie(!1);return}const S=new L(b,["function tokenURI(uint256) view returns (string)"],s),se=T.map(async ye=>{try{let D="",X="";try{if(D=await S.tokenURI(ye),D){let q=D;D.startsWith("ipfs://")&&(q=D.replace("ipfs://","https://ipfs.io/ipfs/"));try{const $=await(await fetch(q)).json();$.image&&(X=$.image,X.startsWith("ipfs://")&&(X=X.replace("ipfs://","https://ipfs.io/ipfs/")))}catch(Z){console.warn(`Failed to fetch metadata for token ${ye}:`,Z)}}}catch(q){console.warn(`Failed to get tokenURI for token ${ye}:`,q)}return{tokenId:ye.toString(),image:X||""}}catch(D){return console.warn(`Failed to fetch pool NFT metadata for token ${ye}:`,D),{tokenId:ye.toString(),image:""}}}),Y=await Promise.all(se);console.log("🏊 Pool NFTs loaded:",Y.length),ke(Y)}catch(g){console.error("Failed to fetch pool NFTs:",g),ke([])}finally{ie(!1)}},te=async(s,g)=>{try{const b=await new L(n,ve,g).getUserStakes(s);ee(b.map(S=>S.toString())),console.log("🔒 Staked NFTs loaded:",b.length)}catch(T){console.error("Failed to fetch staked NFTs:",T),ee([])}},j=async()=>{if(!i||!n||!p){Ne("0");return}try{const s=await R(),g=new L(n,ve,s);try{const T=await g.earned(i);Ne(ge(T))}catch{try{const b=await g.pendingRewards(i);Ne(ge(b))}catch{Ne("0")}}}catch(s){console.error("Failed to fetch pending rewards:",s),Ne("0")}},oe=async()=>{if(n)try{const s=r||new Ye("https://rpc.soniclabs.com"),g=new L(n,ve,s),T=await g.swapFeeInWei(),b=ge(T);F(b);const S=await g.stonerShare(),se=Number(S),Y=100-se;me(se),C(Y),console.log(`💰 Fee split: ${se}% to stoner pool, ${Y}% to stakers`)}catch(s){console.log("Error fetching swap fee:",s),F(null),me(null),C(null)}};return o.useEffect(()=>{n&&(O(),j(),oe())},[n,a]),o.useEffect(()=>{n&&r&&O()},[r]),o.useEffect(()=>{n&&(console.log("Wallet connection changed:",{account:i,isConnected:p}),O(),j())},[i,p,n,a]),o.useEffect(()=>{const s=setInterval(()=>{j()},3e4);return()=>clearInterval(s)},[i,a]),o.useEffect(()=>{console.log("🧾 receiptNFTs state changed:",ue.length,ue)},[ue]),y==="swap"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>u(null),className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-gray-500 hover:bg-gray-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Actions"]}),e.jsx(vt,{walletNFTs:h,poolNFTs:z,loading:d||fe||Te,onSwap:N,status:f,swapFee:c,provider:r,userAddress:i})]}):y==="stake"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>u(null),className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-gray-500 hover:bg-gray-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Actions"]}),e.jsx(Tt,{walletNFTs:h,receiptNFTs:ue,stakedNFTs:E,loading:d,receiptLoading:be,onStake:w,onUnstake:I,onClaimRewards:V,status:f,approvedMap:x,isApprovedForAll:ne,onApproveAll:Q,approvingAll:P,nftCollection:M,swapPool:n,provider:r,pendingRewards:Me,stakerShare:m,swapFee:c})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-indigo-600 via-blue-500 to-teal-400 bg-clip-text text-transparent mb-4",children:"What would you like to do?"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:"Choose your action to get started with the swap pool"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{className:"group",children:e.jsx("button",{onClick:()=>u("swap"),className:"w-full p-8 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-2xl border-2 border-blue-200 dark:border-blue-700 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-300 hover:shadow-xl hover:shadow-blue-500/20 group-hover:scale-105",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 1H4m0 0l4 4M4 12l4-4"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-blue-800 dark:text-blue-200 mb-2",children:"Swap NFTs"}),e.jsx("p",{className:"text-blue-600 dark:text-blue-400 leading-relaxed",children:"Exchange your NFTs with those available in the pool. Perfect for finding specific traits or collecting new pieces."})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 font-medium",children:[e.jsx("span",{children:"Start Swapping"}),e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-blue-500 dark:text-blue-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"Instant Trading"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2z",clipRule:"evenodd"})}),e.jsx("span",{children:"Secure Exchange"})]})]})]})})}),e.jsx("div",{className:"group",children:e.jsx("button",{onClick:()=>u("stake"),className:"w-full p-8 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-2xl border-2 border-green-200 dark:border-green-700 hover:border-green-400 dark:hover:border-green-500 transition-all duration-300 hover:shadow-xl hover:shadow-green-500/20 group-hover:scale-105",children:e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-shadow",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-800 dark:text-green-200 mb-2",children:"Stake NFTs"}),e.jsx("p",{className:"text-green-600 dark:text-green-400 leading-relaxed",children:"Stake your NFTs to earn rewards from swap fees and contribute to pool liquidity. Passive rewards from your collection."})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 font-medium",children:[e.jsx("span",{children:"Start Earning"}),e.jsx("svg",{className:"w-4 h-4 transition-transform group-hover:translate-x-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-green-500 dark:text-green-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:[e.jsx("path",{d:"M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"}),e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z",clipRule:"evenodd"})]}),e.jsx("span",{children:"Earn Rewards"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Pool Liquidity"})]})]})]})})})]}),e.jsxs("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-2xl p-6 border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center",children:"Pool Overview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:z.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Available to Swap"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:E.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Currently Staked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:h.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"In Your Wallet"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:ue.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Your Receipts"})]})]})]}),f&&e.jsx("div",{className:`p-4 rounded-xl border transition-all duration-300 ${f.includes("successful")||f.includes("✅")?"bg-emerald-50 dark:bg-emerald-900/20 border-emerald-200 dark:border-emerald-800 text-emerald-800 dark:text-emerald-200":f.includes("failed")||f.includes("error")?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200":"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200"}`,children:e.jsx("div",{className:"text-center font-medium",children:f})})]})}const St={"0xB6748d708B5Cda0eA8c53e7072566971FCCb6b49":{name:"Stoner NFT",image:"https://nftstorage.link/stoner.png",fallback:"/images/collections/stoner.png",description:"The original Stoner NFT collection"},"0xE3941DB58B9D35410A66636da07c9B28b878B89E":{name:"Boat NFT",image:"https://nftstorage.link/boat.png",fallback:"/images/collections/boat.png",description:"Boat NFT collection"},"0x75f5ee19bc352d19b1791684fadf23b948edaba3":{name:"BOAT MONEY",image:"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400&h=400&fit=crop&crop=center",fallback:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiByeD0iOCIgZmlsbD0idXJsKCNncmFkaWVudDApIi8+CjxwYXRoIGQ9Ik0xMCAyNUwxNSAyMEwyNSAyMkwzMCAyNUgxMFoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8cGF0aCBkPSJNMTUgMjBWMTVMMjAgMTJMMjUgMTVWMjAiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMiIgZmlsbD0ibm9uZSIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJncmFkaWVudDAiIHgxPSIwIiB5MT0iMCIgeDI9IjQwIiB5Mj0iNDAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iIzM5ODNGNiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMwRkJCRjkiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K",description:"Luxury yacht collection for boat enthusiasts",customGradient:"from-blue-400 to-cyan-600"}},Oe={defaultImage:"/images/collections/default.png",defaultGradients:["from-blue-400 to-purple-600","from-purple-400 to-pink-600","from-pink-400 to-red-600","from-red-400 to-orange-600","from-orange-400 to-yellow-600","from-yellow-400 to-green-600","from-green-400 to-teal-600","from-teal-400 to-blue-600","from-indigo-400 to-purple-600","from-violet-400 to-pink-600","from-cyan-400 to-blue-600","from-emerald-400 to-teal-600"]};function et(n){return n&&St[n.toLowerCase()]||null}function Ct(n){const a=et(n);return a?{primary:a.image,fallback:a.fallback,default:Oe.defaultImage}:null}function Mt(n){if(!n)return"from-gray-400 to-gray-600";const a=n.split("").reduce((r,i)=>i.charCodeAt(0)+((r<<5)-r),0);return Oe.defaultGradients[Math.abs(a)%Oe.defaultGradients.length]}function It(n){if(!n||n==="Unknown Collection"||n==="Loading...")return"?";const a=n.trim().split(/\s+/);return a.length===1?a[0].substring(0,2).toUpperCase():a.slice(0,2).map(r=>r.charAt(0).toUpperCase()).join("")}function tt({address:n,collectionName:a,size:r=48,showTooltip:i=!1}){const[p,y]=o.useState(0),[u,f]=o.useState(!1),[t,d]=o.useState(!0),[l,h]=o.useState(!1),v=et(n),x=Ct(n),_=[];x!=null&&x.primary&&_.push(x.primary),x!=null&&x.fallback&&_.push(x.fallback),x!=null&&x.default&&_.push(x.default);const M=_[p],W=()=>{p<_.length-1?(y(P=>P+1),d(!0)):(f(!0),d(!1))},ne=()=>{d(!1),f(!1)};if(o.useEffect(()=>{y(0),f(!1),d(!0)},[n]),!M||u){const P=It((v==null?void 0:v.name)||a),A=(v==null?void 0:v.customGradient)||Mt(a||n),E=r<=32?"text-xs":r<=48?"text-sm":"text-base",ee=e.jsx("div",{style:{width:r,height:r},className:`bg-gradient-to-br ${A} rounded-lg flex items-center justify-center text-white font-bold ${E} shadow-lg cursor-pointer transition-transform hover:scale-105`,onMouseEnter:()=>i&&h(!0),onMouseLeave:()=>h(!1),children:P});return i&&(v!=null&&v.description)?e.jsxs("div",{className:"relative",children:[ee,l&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg shadow-lg z-50 whitespace-nowrap",children:[v.description,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]}):ee}const ae=e.jsxs("div",{className:"relative",children:[t&&e.jsx("div",{style:{width:r,height:r},className:"absolute inset-0 bg-gray-300 dark:bg-gray-700 rounded-lg animate-pulse"}),e.jsx("img",{src:M,alt:(v==null?void 0:v.name)||a||"NFT Collection",style:{width:r,height:r,borderRadius:8},onError:W,onLoad:ne,className:`transition-all duration-200 hover:scale-105 shadow-lg ${t?"opacity-0":"opacity-100"}`})]});return i&&(v!=null&&v.description)?e.jsxs("div",{className:"relative",children:[e.jsx("div",{onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:ae}),l&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg shadow-lg z-50 whitespace-nowrap",children:[e.jsx("div",{className:"font-semibold",children:v.name}),e.jsx("div",{className:"text-xs text-gray-300",children:v.description}),e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]}):ae}function Ft({pool:n,collectionName:a,onClose:r,provider:i}){const[p,y]=o.useState(null);return o.useEffect(()=>{(async()=>{try{if(!i||!n.swapPool)return;const t=await new L(n.swapPool,ve,i).swapFeeInWei(),d=ge(t);y(d)}catch(f){console.error("Error fetching pool fee:",f),y("N/A")}})()},[n.swapPool,i]),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-4xl max-h-[90vh] overflow-y-auto p-4 sm:p-6 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"sticky top-0 bg-white dark:bg-gray-800 pb-4 mb-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-600 dark:text-blue-400",children:"Pool Details"}),e.jsx("button",{className:"text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 px-3 py-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition flex-shrink-0",onClick:r,children:"✕ Close"})]})}),"        ",e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 mb-4",children:[e.jsx(tt,{address:n.nftCollection,collectionName:a,size:64}),e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"font-semibold text-base sm:text-lg text-blue-600 dark:text-blue-400 mb-1",children:["Collection: ",e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:a||"Loading..."})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["SwapPool: ",e.jsxs("span",{className:"font-mono",children:[n.swapPool.slice(0,6),"...",n.swapPool.slice(-4)]})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Receipt: ",e.jsxs("span",{className:"font-mono",children:[n.stakeReceipt.slice(0,6),"...",n.stakeReceipt.slice(-4)]})]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Created: ",n.createdAt]}),e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Active: ",n.active?"Yes":"No"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-600 dark:text-amber-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),e.jsxs("span",{className:"text-sm font-semibold text-amber-600 dark:text-amber-400",children:["Swap Fee: ",p?`${parseFloat(p).toFixed(2)} S`:"Loading..."]})]})]})]}),e.jsxs("div",{className:"mt-6 flex gap-3 flex-wrap",children:[e.jsxs("a",{className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-blue-500 hover:bg-blue-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",href:`https://sonicscan.org/address/${n.swapPool}`,target:"_blank",rel:"noreferrer",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),"Explorer"]}),e.jsxs("a",{className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-purple-500 hover:bg-purple-600 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",href:`https://nft.paintswap.io/sonic/collections/${n.nftCollection}`,target:"_blank",rel:"noreferrer",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2h4a1 1 0 110 2h-1v12a2 2 0 01-2 2H6a2 2 0 01-2-2V6H3a1 1 0 110-2h4zM9 3v1h6V3H9zm2 5a1 1 0 100 2 1 1 0 000-2zm0 4a1 1 0 100 2 1 1 0 000-2z"})}),"PaintSwap"]}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2.5 text-sm font-medium bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg shadow-md hover:shadow-lg transition-all duration-200",onClick:()=>navigator.clipboard.writeText(n.swapPool),children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Address"]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(jt,{swapPool:n.swapPool,stakeReceipt:n.stakeReceipt,provider:i})})]})})}async function Rt(n,a){try{return await new L(n,["function name() view returns (string)"],a).name()}catch{return"Unknown Collection"}}function Pt(){const{address:n,provider:a,signer:r,isConnected:i,isCorrectNetwork:p}=Be(),[y,u]=o.useState([]),[f,t]=o.useState({}),[d,l]=o.useState(!1),[h,v]=o.useState(null),[x,_]=o.useState(null),[M,W]=o.useState(""),[ne,ae]=o.useState(!0),[P,A]=o.useState(""),[E,ee]=o.useState(""),[ue,xe]=o.useState(!1),[z,ke]=o.useState(new Set),[fe,pe]=o.useState("0"),[be,we]=o.useState(!1),[Te,ie]=o.useState(""),B="0x1Db92C2F11b7716f3fa6E94969a8649a32adB1De",[G,Me]=o.useState(B),Ne=async(m,C)=>{if(!n||!C){console.log("🎯 CheckUserStakes: No address or provider:",{address:n,hasProvider:!!C});return}console.log(`🎯 Checking user stakes for ${m.length} pools for address ${n}`);const R=new Set;try{for(const N of m)try{console.log(`🎯 Checking pool: ${N.swapPool.slice(0,8)}, receipt: ${N.stakeReceipt.slice(0,8)}`);const I=await new L(N.stakeReceipt,["function balanceOf(address) view returns (uint256)","function balanceOf(address owner) view returns (uint256)"],C).balanceOf(n);console.log(`🎯 Pool ${N.swapPool.slice(0,8)}: balance = ${I.toString()}`),Number(I)>0&&(R.add(N.swapPool),console.log(`✅ Added staked pool: ${N.swapPool.slice(0,8)} (balance: ${I.toString()})`))}catch(w){console.warn(`❌ Failed to check stakes for pool ${N.swapPool.slice(0,8)}:`,w.message);try{const I=await C.getCode(N.stakeReceipt);console.warn(I==="0x"?`❌ Receipt contract ${N.stakeReceipt.slice(0,8)} has no code`:`❌ Receipt contract ${N.stakeReceipt.slice(0,8)} exists but balanceOf failed`)}catch(I){console.warn(`❌ Could not check code for ${N.stakeReceipt.slice(0,8)}:`,I.message)}}}catch(N){console.warn("Failed to check user stakes:",N)}console.log(`🎯 Total staked pools found: ${R.size}`,Array.from(R)),ke(R)},c=y.filter(m=>{const C=E.toLowerCase(),R=!E||f[m.nftCollection]&&f[m.nftCollection].toLowerCase().includes(C)||m.nftCollection.toLowerCase().includes(C)||m.swapPool.toLowerCase().includes(C),N=!ue||z.has(m.swapPool);return R&&N});o.useEffect(()=>{(async()=>{ae(!0);let C=!1;try{const R=["https://rpc.soniclabs.com","https://rpc.soniclabs.com","https://sonic.drpc.org","https://sonic.api.onfinality.io/public","https://sonic-rpc.publicnode.com"].filter(Boolean);for(const N of R)try{const w=new Ye(N);await w.getBlockNumber(),_(w),W(""),console.log("Provider set: "+N),C=!0;break}catch(w){console.warn("RPC failed",N,w)}if(window.ethereum&&C)try{const N=await window.ethereum.request({method:"eth_chainId"}),w=parseInt(N,16);w!==146&&console.warn("Wallet connected to chainId",w,"but using RPC for read operations")}catch(N){console.warn("Could not read chainId from wallet",N)}C||console.warn("No working provider found")}catch(R){console.warn("Provider init failed",R)}ae(!1)})()},[]);const F=async()=>{if(!G){console.warn("Factory address not set. Provide VITE_FACTORY_ADDRESS or public/contracts.json");return}if(!x){console.warn("fetchPools called without provider");return}l(!0),A("");try{try{const w=await x.getNetwork();w&&w.chainId&&Number(w.chainId)!==146&&console.warn(`Connected to chain ${w.chainId}, expected 146 (Sonic)`);const I=await x.send("eth_getCode",[G,"latest"]);(!I||I==="0x"||I==="0x0")&&console.warn(`No contract found at ${G}`)}catch(w){console.warn("Network/code check failed",w)}const m=new L(G,gt,x);let C=[];try{C=await m.getAllPools(),C=C.filter(w=>w.active)}catch(w){console.error("Failed to get pools from factory:",w),C=[]}console.log("All active pools from contract:",C);const R=C.map(w=>{console.log(`🗓️ Pool ${w.swapPool.slice(0,8)}... raw createdAt:`,w.createdAt,"Type:",typeof w.createdAt);let I="Unknown";if(w.createdAt&&Number(w.createdAt)>0)try{const V=Number(w.createdAt);I=new Date(V*1e3).toLocaleString(),console.log(`🗓️ Pool ${w.swapPool.slice(0,8)}... formatted date:`,I)}catch(V){console.warn(`🗓️ Failed to format date for pool ${w.swapPool}:`,V)}else console.warn(`🗓️ Pool ${w.swapPool.slice(0,8)}... has invalid createdAt:`,w.createdAt);return{nftCollection:w.nftCollection,swapPool:w.swapPool,stakeReceipt:w.stakeReceipt,createdAt:w.createdAt,createdAtFormatted:I,creator:w.creator,active:w.active,poolAddress:w.swapPool}});console.log("All pools (no deduplication applied):",R),u(R);const N={};for(const w of R)N[w.nftCollection]=await Rt(w.nftCollection,x);t(N),n?(console.log("🎯 About to check user stakes, address:",n),await Ne(R,x)):console.log("🎯 No address available, skipping user stakes check")}catch(m){console.error("Failed to fetch pools",m)}l(!1)},H=async()=>{if(!n||!x||z.size===0){pe("0");return}try{let m=qe("0");for(const C of y)if(z.has(C.swapPool))try{const N=await new L(C.swapPool,ve,x).earned(n);console.log(`💰 Pool ${C.swapPool.slice(0,8)}... rewards: ${ge(N)} S`),m=m+N}catch(R){console.warn(`Failed to get rewards for pool ${C.swapPool}:`,R.message)}pe(ge(m))}catch(m){console.error("Failed to calculate total rewards:",m),pe("0")}},me=async()=>{if(!(!r||z.size===0)){we(!0),ie("Claiming rewards from all pools...");try{let m=0,C=0;for(const R of y)if(z.has(R.swapPool))try{const N=new L(R.swapPool,ve,r),w=await N.earned(n);console.log(`💰 Checking pool ${R.swapPool.slice(0,8)}... rewards: ${ge(w)} S`),w>0&&(await(await N.claimRewards()).wait(),m++,console.log(`✅ Claimed ${ge(w)} S from pool: ${R.swapPool}`))}catch(N){C++,console.error(`❌ Failed to claim from pool ${R.swapPool}:`,N)}m>0?(ie(`✅ Successfully claimed rewards from ${m} pool(s)!`),await H()):C>0?ie(`❌ Failed to claim rewards from ${C} pool(s)`):ie("No rewards to claim")}catch(m){ie(`❌ Claim all failed: ${m.reason||m.message}`)}we(!1),setTimeout(()=>ie(""),5e3)}};return o.useEffect(()=>{x&&G&&F()},[x,G]),o.useEffect(()=>{n&&x&&y.length>0&&(console.log("🎯 Address changed, re-checking user stakes:",n),Ne(y,x))},[n,x,y]),o.useEffect(()=>{H()},[y,z,n]),o.useEffect(()=>{if(z.size>0){const m=setInterval(H,3e4);return()=>clearInterval(m)}},[z]),e.jsxs("div",{className:"space-y-6",children:[P&&e.jsxs("div",{className:"p-4 bg-red-900/20 border border-red-500/20 text-red-400 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{children:"⚠️"}),e.jsx("span",{className:"font-semibold",children:"Error"})]}),e.jsx("p",{className:"text-sm",children:P})]}),ne&&e.jsxs("div",{className:"p-6 bg-card/30 rounded-xl text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"font-semibold",children:"Connecting to Sonic Network..."})]}),e.jsx("p",{className:"text-sm text-muted",children:"Please wait while we establish connection"})]}),i&&z.size>0&&e.jsx("div",{className:"bg-gradient-to-r from-emerald-50 to-green-50 dark:from-emerald-900/20 dark:to-green-900/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-100 dark:bg-emerald-900/30 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-emerald-600 dark:text-emerald-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold text-emerald-900 dark:text-emerald-100",children:"Total Pending Rewards"}),e.jsxs("div",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-400",children:[fe," S"]}),e.jsxs("div",{className:"text-sm text-emerald-700 dark:text-emerald-300",children:["From ",z.size," staked pool",z.size!==1?"s":""]})]})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("button",{onClick:me,disabled:be||parseFloat(fe)===0,className:"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-bold rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 disabled:transform-none",children:be?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Claiming..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})}),"Claim All Rewards"]})}),Te&&e.jsx("div",{className:`text-sm font-medium ${Te.includes("✅")?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"}`,children:Te})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-xl font-bold text-accent",children:"Swap Pools"}),e.jsxs("div",{className:"px-3 py-1 bg-accent/10 text-accent rounded-full text-sm font-medium",children:[c.length," ",ue?"staked":"active"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-xs text-muted",children:["Factory: ",e.jsxs("span",{className:"font-mono text-accent",children:[G==null?void 0:G.slice(0,6),"...",(G==null?void 0:G.slice(-4))||"Not set"]})]}),e.jsxs("button",{onClick:F,disabled:d,className:"px-4 py-2 bg-accent text-white rounded-lg shadow hover:bg-accent/80 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-medium",children:[d&&e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d?"Loading...":"Refresh Pools"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 p-4 bg-white/50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Search by collection name, address, or pool address...",value:E,onChange:m=>ee(m.target.value),className:"w-full pl-10 pr-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-sm placeholder-gray-500 dark:placeholder-gray-400"}),E&&e.jsx("button",{onClick:()=>ee(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:ue,onChange:m=>xe(m.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-green-500",children:"🎯"}),"My Staked Pools"]})]}),ue&&e.jsxs("div",{className:"px-2 py-1 bg-green-500/10 text-green-600 dark:text-green-400 rounded text-xs font-medium",children:[z.size," staked"]})]})]}),d&&c.length===0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3].map(m=>e.jsx("div",{className:"p-4 sm:p-5 bg-card rounded-2xl shadow-lg animate-pulse",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gray-600 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-600 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-600 rounded w-1/2"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-3 bg-gray-600 rounded w-2/3"}),e.jsx("div",{className:"h-3 bg-gray-600 rounded w-1/2"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-gray-600 rounded w-16"}),e.jsx("div",{className:"h-6 bg-gray-600 rounded w-20"})]})]})},m))}):c.length===0?e.jsx("div",{className:"p-8 bg-white/90 dark:bg-gray-800/90 rounded-2xl text-center border border-gray-200 dark:border-gray-700",children:y.length===0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🏊‍♂️"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Swap Pools Found"}),e.jsx("p",{className:"text-muted mb-4",children:G?"No pools are currently registered with this factory.":"Please set a factory address first."}),G&&e.jsx("button",{onClick:F,className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/80 transition-colors",children:"Refresh Pools"})]}):ue?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🎯"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Staked Pools"}),e.jsx("p",{className:"text-muted mb-4",children:"You haven't staked any NFTs in pools yet. Start staking to earn rewards from trading fees!"}),e.jsx("button",{onClick:()=>xe(!1),className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/80 transition-colors",children:"Show All Pools"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-6xl mb-4",children:"🔍"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Results Found"}),e.jsxs("p",{className:"text-muted mb-4",children:['No pools match your search "',E,'". Try adjusting your search terms.']}),e.jsx("button",{onClick:()=>ee(""),className:"px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent/80 transition-colors",children:"Clear Search"})]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((m,C)=>e.jsxs("div",{className:"group p-4 sm:p-5 bg-white/95 dark:bg-gray-800/95 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 border border-gray-200 dark:border-gray-700 hover:border-blue-400/50 cursor-pointer",onClick:()=>v(m),children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(tt,{address:m.nftCollection,collectionName:f[m.nftCollection],size:56}),z.has(m.swapPool)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"✓"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-blue-600 dark:text-blue-400 truncate",children:f[m.nftCollection]||"Loading..."}),z.has(m.swapPool)&&e.jsxs("div",{className:"px-2 py-1 bg-green-500/10 text-green-600 dark:text-green-400 rounded-full text-xs font-medium flex items-center gap-1",children:[e.jsx("span",{children:"🎯"}),e.jsx("span",{children:"Staked"})]})]}),e.jsxs("p",{className:"text-xs text-muted font-mono truncate",children:[m.nftCollection.slice(0,8),"...",m.nftCollection.slice(-6)]})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-muted mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Pool:"}),e.jsxs("span",{className:"font-mono",children:[m.swapPool.slice(0,8),"...",m.swapPool.slice(-6)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Receipt:"}),e.jsxs("span",{className:"font-mono",children:[m.stakeReceipt.slice(0,8),"...",m.stakeReceipt.slice(-6)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Created:"}),e.jsx("span",{children:m.createdAt&&Number(m.createdAt)>0?new Date(Number(m.createdAt)*1e3).toLocaleDateString():"Unknown"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"flex-1 px-3 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm",onClick:R=>{R.stopPropagation(),v(m)},children:"View Details"}),e.jsx("button",{className:"px-3 py-2 bg-secondary/50 hover:bg-secondary text-text rounded-lg transition-colors text-xs",onClick:R=>{R.stopPropagation(),navigator.clipboard.writeText(m.swapPool)},title:"Copy pool address",children:"📋"})]})]},`${m.swapPool}-${C}`))})]}),h&&e.jsx(Ft,{pool:h,collectionName:f[h.nftCollection],onClose:()=>v(null),provider:x})]})}const At="modulepreload",Et=function(n){return"/"+n},ze={},$t=function(a,r,i){let p=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),f=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));p=Promise.allSettled(r.map(t=>{if(t=Et(t),t in ze)return;ze[t]=!0;const d=t.endsWith(".css"),l=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${l}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":At,d||(h.as="script"),h.crossOrigin="",h.href=t,f&&h.setAttribute("nonce",f),document.head.appendChild(h),d)return new Promise((v,x)=>{h.addEventListener("load",v),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${t}`)))})}))}function y(u){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=u,window.dispatchEvent(f),!f.defaultPrevented)throw u}return p.then(u=>{for(const f of u||[])f.status==="rejected"&&y(f.reason);return a().catch(y)})},Ie=[{inputs:[{internalType:"address",name:"_stonerNFT",type:"address"},{internalType:"address",name:"_receiptToken",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyStaked",type:"error"},{inputs:[],name:"DuplicateTokenId",type:"error"},{inputs:[],name:"EmptyArray",type:"error"},{inputs:[],name:"NoERC20Rewards",type:"error"},{inputs:[],name:"NoRewards",type:"error"},{inputs:[],name:"NoStakers",type:"error"},{inputs:[],name:"NotStaked",type:"error"},{inputs:[],name:"NotYourToken",type:"error"},{inputs:[],name:"TokenAlreadyWhitelisted",type:"error"},{inputs:[],name:"TokenNotWhitelisted",type:"error"},{inputs:[],name:"TooManyTokens",type:"error"},{inputs:[],name:"TransferFailed",type:"error"},{inputs:[],name:"ZeroAddress",type:"error"},{inputs:[],name:"ZeroETH",type:"error"},{inputs:[],name:"ZeroTokenAmount",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"ERC20RewardClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"ERC20RewardReceived",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"EmergencyERC20Withdrawal",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"EmergencyETHWithdrawal",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!0,internalType:"address",name:"to",type:"address"}],name:"EmergencyUnstake",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardClaimed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"RewardReceived",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Staked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"}],name:"TokenRemovedFromWhitelist",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"token",type:"address"}],name:"TokenWhitelisted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Unstaked",type:"event"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"addWhitelistedToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"token",type:"address"}],name:"calculatePendingERC20Rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"calculatePendingRewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"claimAllERC20Rewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimAllRewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"claimERC20Rewards",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimRewardsOnly",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"earned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"token",type:"address"}],name:"earnedERC20",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"emergencyUnstake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"emergencyUnstakeWithClaim",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"emergencyWithdrawERC20",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"emergencyWithdrawETH",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"erc20RewardCarry",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"erc20RewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"erc20Rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"erc20TotalRewardsClaimed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"erc20UserRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"exit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getAllPendingERC20Rewards",outputs:[{internalType:"address[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"rewardAmounts",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"getERC20PoolInfo",outputs:[{internalType:"address",name:"tokenAddress",type:"address"},{internalType:"uint256",name:"totalClaimedAmount",type:"uint256"},{internalType:"uint256",name:"contractBalance",type:"uint256"},{internalType:"bool",name:"isWhitelisted",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolInfo",outputs:[{internalType:"address",name:"nftAddress",type:"address"},{internalType:"uint256",name:"totalStakedTokens",type:"uint256"},{internalType:"uint256",name:"totalRewards",type:"uint256"},{internalType:"uint256",name:"contractBalance",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getStakeInfo",outputs:[{internalType:"address",name:"staker",type:"address"},{internalType:"uint256",name:"stakedAt",type:"uint256"},{internalType:"uint256",name:"stakingDuration",type:"uint256"},{internalType:"bool",name:"active",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getStakedTokens",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWhitelistedTokens",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"isStaked",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"notifyERC20Reward",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"notifyNativeReward",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"receiptIdByOriginal",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"receiptToken",outputs:[{internalType:"contract IStakeReceipt",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"registerMe",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"}],name:"removeWhitelistedToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"rewardCarry",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"rewardPerTokenStored",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"rewards",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"stake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"stakeMultiple",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"stakedTokens",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"stakerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"stonerNFT",outputs:[{internalType:"contract IERC721",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalRewardsClaimed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalStaked",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"unstake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"tokenIds",type:"uint256[]"}],name:"unstakeMultiple",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"userRewardPerTokenPaid",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"whitelistedTokens",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"whitelistedTokensList",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],Ve=[{inputs:[{internalType:"address",name:"_owner",type:"address"},{internalType:"uint256",name:"_startTime",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyExists",type:"error"},{inputs:[],name:"InvalidOwner",type:"error"},{inputs:[],name:"InvalidRecipient",type:"error"},{inputs:[],name:"InvalidSender",type:"error"},{inputs:[],name:"NotFound",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{inputs:[],name:"UnsafeRecipient",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"ERC20Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"ERC721Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"activePhase",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amountOrId",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"availableIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseTokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"phase",type:"uint256"},{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"quantity",type:"uint256"}],name:"canMintAmountInPhase",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_contract",type:"address"}],name:"contractNFTBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_contract",type:"address"}],name:"contractTokenBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_contract",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"enoughTokenBalance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"phase",type:"uint256"},{internalType:"address[]",name:"accounts",type:"address[]"},{internalType:"uint256",name:"quantity",type:"uint256"}],name:"grantPhaseAccess",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"phase",type:"uint256"},{internalType:"address",name:"account",type:"address"}],name:"hasPhaseAccess",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxMintPerTx",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"maxMintable",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"quantity",type:"uint256"}],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"mintActive",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"mintHasStarted",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"minted",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"quantity",type:"uint256"}],name:"ownerMint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"owner",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"phaseDuration",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"},{internalType:"address",name:"",type:"address"}],name:"phaseMintsRemaining",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"phases",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"price",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"revokeOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"royaltyAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"uint256",name:"_salePrice",type:"uint256"}],name:"royaltyInfo",outputs:[{internalType:"address",name:"receiver",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"royaltyReceiver",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"secondsUntilStart",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_baseURI",type:"string"}],name:"setBaseURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_maxMintPerTx",type:"uint256"}],name:"setMaxPerTx",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"mintActive_",type:"bool"}],name:"setMintActive",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_paused",type:"bool"}],name:"setPaused",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_price",type:"uint256"}],name:"setPrice",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_royaltyAmount",type:"uint256"}],name:"setRoyaltyAmount",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_receiver",type:"address"}],name:"setRoyaltyReceiver",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_startTime",type:"uint256"}],name:"setStartTime",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"state",type:"bool"}],name:"setWhitelist",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"startTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"id",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalAvailableIds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"totalNFTsOwned",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalNativeSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_owner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"whitelist",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],Lt="0xB6748d708B5Cda0eA8c53e7072566971FCCb6b49",Bt="0x5777fc6ca7f6BDc02dF3323A0C05970bB9D05b74",nt={stonerStakeReceipt:Lt,stonerFeePool:Bt},Ce=nt.stonerFeePool,Wt=nt.stonerStakeReceipt,We="0x9b567e03d891F537b2B7874aA4A3308Cfe2F4FBb";function Ot(){console.log("🎯 StonerFeePoolActions component loaded!");const{address:n,signer:a,provider:r,isConnected:i,isCorrectNetwork:p}=Be(),[y,u]=o.useState(""),[f,t]=o.useState(!1),[d,l]=o.useState([]),[h,v]=o.useState([]),[x,_]=o.useState([]),[M,W]=o.useState([]),[ne,ae]=o.useState(!1),[P,A]=o.useState("0"),[E,ee]=o.useState([]),[ue,xe]=o.useState([]),[z,ke]=o.useState(!1),fe=async()=>{if(!a)throw new Error("Wallet not connected");return a},pe=async()=>{if(console.log("🎯 fetchNFTs called in StonerFeePoolActions"),!i||!r||!n){console.log("❌ Wallet not connected, skipping NFT fetch");return}try{const c=n,F=new L(We,Ve,r),H=new L(Ce,Ie,r),me=await F.isApprovedForAll(c,Ce);ae(me);const m=await F.totalNFTsOwned(c);console.log("🔢 Stoner NFT balance:",m.toString());const C=Number(m),R=1e3;if(C>R){console.log(`⚠️ Balance seems unusually large (${C}), limiting to ${R}`),l([]),v([]),u(`Warning: NFT balance appears corrupted (${C}). Please check the contract.`);return}const N=[];let w=!1;try{await F.tokenOfOwnerByIndex(c,0),w=!0,console.log("✅ Using tokenOfOwnerByIndex approach");for(let I=0;I<Math.min(Number(m),50);I++)try{const V=await F.tokenOfOwnerByIndex(c,I);console.log(`📝 Found wallet token ${I+1}/${m}: #${V.toString()}`);let Q=null;try{let O=await F.tokenURI(V);if(O.startsWith("ipfs://")&&(O=O.replace("ipfs://","https://ipfs.io/ipfs/")),O.startsWith("http")){const J=await(await fetch(O)).json();Q=J.image||J.image_url,Q&&Q.startsWith("ipfs://")&&(Q=Q.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for token",V.toString())}N.push({tokenId:V.toString(),image:Q})}catch(V){console.warn(`Failed to get token at index ${I}:`,V.message);continue}}catch{console.log("❌ tokenOfOwnerByIndex not supported (ERC404 contract), trying event-based approach"),w=!1;try{console.log("🔍 Using direct ownership verification for ERC404 contract...");const V=new Set,Q=Math.max(1e4,Number(m)*50),O=20;let le=0;for(let j=1;j<=Q&&le<Number(m);j+=O){const oe=Math.min(j+O-1,Q),s=[];for(let g=j;g<=oe;g++)s.push(F.ownerOf(g).then(T=>({tokenId:g,owner:T.toLowerCase()})).catch(()=>({tokenId:g,owner:null})));try{const g=await Promise.all(s);for(const{tokenId:T,owner:b}of g)if(b===c.toLowerCase()&&(V.add(T.toString()),le++,console.log(`✅ Found owned token via direct check: #${T} (${le}/${m})`),le>=Number(m)))break}catch(g){console.warn(`Batch ${j}-${oe} failed:`,g.message)}if(le>=Number(m))break;await new Promise(g=>setTimeout(g,10))}console.log(`🎯 Direct check found ${le} total tokens`);const J=Array.from(V).slice(0,50);console.log(`📋 Validating ${J.length} tokens and fetching metadata...`);const U=5;let te=0;for(let j=0;j<J.length;j+=U){const s=J.slice(j,j+U).map(async g=>{try{if((await F.ownerOf(g)).toLowerCase()!==c.toLowerCase())return null;let b=null;try{let S=await F.tokenURI(g);if(S.startsWith("ipfs://")&&(S=S.replace("ipfs://","https://ipfs.io/ipfs/")),S.startsWith("http")){const Y=await(await fetch(S)).json();b=Y.image||Y.image_url,b&&b.startsWith("ipfs://")&&(b=b.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for token",g)}return{tokenId:g.toString(),image:b}}catch(T){return console.warn(`Token ${g} validation failed:`,T.message),null}});try{const g=await Promise.all(s);for(const T of g)T&&(N.push(T),te++,console.log(`✅ Validated token #${T.tokenId} (${te}/${J.length})`))}catch(g){console.warn(`Metadata batch ${j} failed:`,g.message)}j+U<J.length&&await new Promise(g=>setTimeout(g,50))}te>0&&(w=!0,console.log(`🎉 Successfully loaded ${te} Stoner NFTs via direct ownership check`))}catch(V){console.warn("Direct ownership check failed:",V.message)}}if(!w||N.length<Number(m)){console.log("🔍 Trying multicall brute force token discovery...");try{const{Multicall:I}=await $t(async()=>{const{Multicall:j}=await import("./index-Blt0uD8X.js");return{Multicall:j}},__vite__mapDeps([0,1])),V=new I({ethersProvider:r,tryAggregate:!0}),Q=1e3,O=[];for(let j=0;j<=Q;j++)O.push({reference:`ownerOf_${j}`,contractAddress:We,abi:Ve,calls:[{methodName:"ownerOf",methodParameters:[j]}]});const le=await V.call(O),U=Object.entries(le.results).filter(([j,oe])=>oe.callsReturnContext&&oe.callsReturnContext[0].returnValues&&oe.callsReturnContext[0].returnValues[0]&&oe.callsReturnContext[0].returnValues[0].toLowerCase()===c.toLowerCase()).map(([j])=>parseInt(j.replace("ownerOf_",""))).map(async j=>{if(N.some(g=>g.tokenId===j.toString()))return null;let s=null;try{let g=await F.tokenURI(j);if(g.startsWith("ipfs://")&&(g=g.replace("ipfs://","https://ipfs.io/ipfs/")),g.startsWith("http")){const b=await(await fetch(g)).json();s=b.image||b.image_url,s&&s.startsWith("ipfs://")&&(s=s.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for token",j.toString())}return{tokenId:j.toString(),image:s}});(await Promise.all(U)).forEach(j=>{j&&N.push(j)})}catch(I){console.warn("Multicall failed (network may not support it):",I.message),console.log("📋 Continuing with enumerable results only")}}console.log(`✅ Loaded ${N.length}/${m} wallet Stoner NFTs`),l(N);try{console.log("🔥 Fetching staked NFTs from StakeReceipt contract...");const I=new L(Wt,ht,r);let V=[];try{const[Q,O]=await I.getUserReceipts(c);console.log("🔥 Raw receipts and original tokens from getUserReceipts:",Q,O);const le=Array.from(Q).map(U=>U.toString()),J=Array.from(O).map(U=>U.toString());console.log("🔥 Staked Stoner NFT token IDs from receipts:",J);for(let U=0;U<J.length;U++){const te=J[U],j=le[U];let oe=null;try{let s=await F.tokenURI(te);if(s.startsWith("ipfs://")&&(s=s.replace("ipfs://","https://ipfs.io/ipfs/")),s.startsWith("http")){const T=await(await fetch(s)).json();oe=T.image||T.image_url,oe&&oe.startsWith("ipfs://")&&(oe=oe.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for staked token",te)}V.push({tokenId:te,receiptId:j,image:oe})}}catch{console.log("🔥 getUserReceipts() not available, trying fallback method...");try{const O=await I.balanceOf(c);if(console.log("🔥 StakeReceipt balance:",O.toString()),O>0){const le=[];try{for(let J=0;J<Number(O);J++){const U=await I.tokenOfOwnerByIndex(c,J);le.push(U.toString())}console.log("🔥 Receipt token IDs:",le)}catch{console.log("🔥 tokenOfOwnerByIndex not available, using brute force for receipts...");for(let U=1;U<=1e3;U++)try{(await I.ownerOf(U)).toLowerCase()===c.toLowerCase()&&le.push(U.toString())}catch{}}for(const J of le){let U=null;try{U=await I.receiptToOriginalToken(J)}catch{try{U=await I.getOriginalTokenId(J)}catch{U=J}}if(U){let te=null;try{let j=await F.tokenURI(U);if(j.startsWith("ipfs://")&&(j=j.replace("ipfs://","https://ipfs.io/ipfs/")),j.startsWith("http")){const s=await(await fetch(j)).json();te=s.image||s.image_url,te&&te.startsWith("ipfs://")&&(te=te.replace("ipfs://","https://ipfs.io/ipfs/"))}}catch{console.warn("Failed to fetch metadata for staked token",U.toString())}V.push({tokenId:U.toString(),receiptId:J,image:te})}}}}catch(O){console.log("🔥 Fallback method also failed:",O)}}console.log(`✅ Loaded ${V.length} staked Stoner NFTs:`,V.map(Q=>Q.tokenId)),v(V)}catch(I){console.warn("Failed to fetch staked NFTs:",I)}}catch(c){console.error("Failed to fetch NFTs:",c)}},be=async()=>{if(console.log("💰 fetchRewards called in StonerFeePoolActions"),!window.ethereum||!i){console.log("❌ Wallet not connected, skipping rewards fetch");return}try{ke(!0);const c=new Re(window.ethereum),H=await(await c.getSigner()).getAddress(),me=new L(Ce,Ie,c),m=await me.calculatePendingRewards(H);A(ge(m)),console.log("💎 Native S rewards:",ge(m));const C=await me.getWhitelistedTokens();xe(C),console.log("📋 Whitelisted tokens:",C);const R=C.map(async w=>{try{const I=await me.calculatePendingERC20Rewards(H,w);let V="Unknown",Q=18;try{const O=new L(w,["function symbol() view returns (string)","function decimals() view returns (uint8)"],c);V=await O.symbol(),Q=await O.decimals()}catch(O){console.warn(`Failed to get token info for ${w}:`,O.message)}return{address:w,symbol:V,decimals:Q,earned:lt(I,Q),rawEarned:I.toString()}}catch(I){return console.warn(`Failed to get rewards for token ${w}:`,I.message),null}}),N=(await Promise.all(R)).filter(w=>w!==null);ee(N),console.log("🪙 ERC20 rewards:",N)}catch(c){console.error("Failed to fetch rewards:",c)}finally{ke(!1)}};o.useEffect(()=>{i&&n&&p&&(console.log("🔗 Wallet connected, fetching NFTs and rewards..."),pe(),be())},[i,n,p]);const we=async()=>{if(x.length===0){u("Select NFTs to stake first");return}t(!0),u("");try{const c=await fe(),F=new L(Ce,Ie,c);let H;x.length===1?H=await F.stake(x[0]):H=await F.stakeMultiple(x),u("Staking..."),await H.wait(),u("Staking successful!"),_([]),await pe()}catch(c){u("Staking failed: "+(c.reason||c.message))}t(!1)},Te=async()=>{if(M.length===0){u("Select staked NFTs to unstake first");return}t(!0),u("");try{const c=await fe(),F=new L(Ce,Ie,c),H=M.map(m=>{const C=h.find(R=>R.tokenId===m);return C?C.receiptId:m});console.log("🔥 Unstaking with receipt IDs:",H);let me;H.length===1?me=await F.unstake(H[0]):me=await F.unstakeMultiple(H),u("Unstaking..."),await me.wait(),u("Unstaking successful!"),W([]),await pe()}catch(c){console.error("Unstaking failed:",c),u("Unstaking failed: "+(c.reason||c.message))}t(!1)},ie=async()=>{t(!0),u("");try{const c=await fe(),H=await new L(Ce,Ie,c).claimAllRewards();u("Claiming rewards..."),await H.wait(),u("Rewards claimed successfully!"),await be()}catch(c){u("Claim failed: "+(c.reason||c.message))}t(!1)},B=async()=>{t(!0),u("");try{const c=await fe(),H=await new L(Ce,Ie,c).claimRewardsOnly();u("Claiming native rewards..."),await H.wait(),u("Native rewards claimed successfully!"),await be()}catch(c){u("Native claim failed: "+(c.reason||c.message))}t(!1)},G=async c=>{t(!0),u("");try{const F=await fe(),me=await new L(Ce,Ie,F).claimERC20Rewards(c);u("Claiming ERC20 rewards..."),await me.wait(),u("ERC20 rewards claimed successfully!"),await be()}catch(F){u("ERC20 claim failed: "+(F.reason||F.message))}t(!1)},Me=async()=>{t(!0);try{const c=await fe();await(await new L(We,["function setApprovalForAll(address,bool) external"],c).setApprovalForAll(Ce,!0)).wait(),ae(!0),u("Approval successful!")}catch(c){u("Approval failed: "+(c.reason||c.message))}t(!1)},Ne=!i;return e.jsxs("div",{className:"p-6 bg-white/95 dark:bg-gray-800/95 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 backdrop-blur-sm space-y-6",children:[Ne&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 text-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400 mb-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:"Connect Wallet to Interact"})]}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Connect your wallet using the button in the header to stake NFTs and claim rewards"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"🌿"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl text-green-400",children:"Stoner NFT Staking"}),e.jsx("p",{className:"text-sm text-muted",children:i?`Connected: ${n.slice(0,6)}...${n.slice(-4)}`:"Preview Mode - Connect wallet to interact"})]})]}),e.jsx("button",{onClick:ie,disabled:f||!i,className:"px-4 py-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-all disabled:opacity-50 font-medium",title:i?"":"Connect wallet to claim rewards",children:"Claim Rewards"})]}),y&&e.jsx("div",{className:`p-3 rounded-lg ${y.includes("successful")||y.includes("claimed")?"bg-green-900/20 border border-green-500/20 text-green-400":y.includes("failed")||y.includes("error")?"bg-red-900/20 border border-red-500/20 text-red-400":"bg-blue-900/20 border border-blue-500/20 text-blue-400"}`,children:y}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-500/10 to-orange-500/10 rounded-xl border border-yellow-500/20 p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-yellow-500 to-orange-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-lg",children:"💰"})}),e.jsx("h4",{className:"font-semibold text-yellow-400",children:"Claimable Rewards"})]}),e.jsx("button",{onClick:be,disabled:z||!i,className:"px-3 py-1 bg-yellow-600 text-white rounded text-sm disabled:opacity-50 hover:bg-yellow-700 transition-colors",title:i?"":"Connect wallet to refresh rewards",children:z?"Loading...":"Refresh"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400 text-lg",children:"⚡"}),e.jsx("span",{className:"font-medium text-blue-400",children:"S Rewards"})]}),e.jsx("button",{onClick:B,disabled:f||parseFloat(P)===0||!i,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm disabled:opacity-50 hover:bg-blue-700 transition-colors",title:i?"":"Connect wallet to claim",children:"Claim S"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[parseFloat(P).toFixed(6)," S"]})]}),E.length>0?e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-400 text-lg",children:"🪙"}),e.jsx("span",{className:"font-medium text-green-400",children:"Token Rewards"})]}),e.jsx("button",{onClick:ie,disabled:f||E.every(c=>parseFloat(c.earned)===0)||!i,className:"px-3 py-1 bg-green-600 text-white rounded text-sm disabled:opacity-50 hover:bg-green-700 transition-colors",title:i?"":"Connect wallet to claim",children:"Claim All"})]}),e.jsx("div",{className:"space-y-2 max-h-24 overflow-y-auto",children:E.map((c,F)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-400",children:[c.symbol,":"]}),e.jsx("span",{className:"text-white font-medium",children:parseFloat(c.earned).toFixed(4)})]}),e.jsx("button",{onClick:()=>G(c.address),disabled:f||parseFloat(c.earned)===0||!i,className:"px-2 py-1 bg-green-600/80 text-white rounded text-xs disabled:opacity-50 hover:bg-green-600 transition-colors",title:i?"":"Connect wallet to claim",children:"Claim"})]},c.address))})]}):e.jsxs("div",{className:"bg-black/20 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-gray-400 text-lg",children:"🪙"}),e.jsx("span",{className:"font-medium text-gray-400",children:"Token Rewards"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"No whitelisted tokens or rewards available"})]})]}),(parseFloat(P)>0||E.some(c=>parseFloat(c.earned)>0))&&e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:ie,disabled:f||!i,className:"px-6 py-2 bg-gradient-to-r from-yellow-500 to-orange-600 text-white rounded-lg disabled:opacity-50 hover:from-yellow-600 hover:to-orange-700 transition-all font-semibold",title:i?"":"Connect wallet to claim rewards",children:f?"Claiming...":"Claim All Rewards"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold text-green-400",children:["Stake NFTs (",x.length," selected)"]}),!ne&&e.jsx("button",{onClick:Me,disabled:f||!i,className:"px-3 py-1 bg-blue-600 text-white rounded text-sm disabled:opacity-50",title:i?"":"Connect wallet to approve",children:"Approve All"})]}),d.length===0?e.jsxs("div",{className:"p-6 bg-card/30 rounded-xl text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"🔍"}),e.jsx("p",{className:"text-muted",children:"No Stoner NFTs found in wallet"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-3",children:d.map(c=>e.jsxs("div",{className:`relative cursor-pointer rounded-lg border-2 transition-all ${x.includes(c.tokenId)?"border-green-400 bg-green-400/10":"border-transparent hover:border-accent/30"}`,onClick:()=>{x.includes(c.tokenId)?_(F=>F.filter(H=>H!==c.tokenId)):_(F=>[...F,c.tokenId])},children:[e.jsx("div",{className:"aspect-square p-2",children:e.jsx(Fe,{image:c.image,tokenId:c.tokenId,size:"100%"})}),e.jsxs("div",{className:"text-xs text-center p-1",children:["#",c.tokenId]})]},c.tokenId))}),e.jsx("button",{onClick:we,disabled:f||x.length===0||!ne||!i,className:"w-full px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg disabled:opacity-50",title:i?"":"Connect wallet to stake NFTs",children:f?"Staking...":`Stake ${x.length} NFT${x.length!==1?"s":""}`})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-blue-400",children:["Unstake NFTs (",M.length," selected)"]}),h.length===0?e.jsxs("div",{className:"p-6 bg-card/30 rounded-xl text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"📦"}),e.jsx("p",{className:"text-muted",children:"No staked NFTs"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-4 gap-3",children:h.slice(0,12).map(c=>e.jsxs("div",{className:`relative cursor-pointer rounded-lg border-2 transition-all ${M.includes(c.tokenId)?"border-blue-400 bg-blue-400/10":"border-transparent hover:border-accent/30"}`,onClick:()=>{M.includes(c.tokenId)?W(F=>F.filter(H=>H!==c.tokenId)):W(F=>[...F,c.tokenId])},children:[e.jsx("div",{className:"aspect-square p-2",children:e.jsx(Fe,{image:c.image,tokenId:c.tokenId,size:"100%"})}),e.jsxs("div",{className:"text-xs text-center p-1",children:["#",c.tokenId]})]},c.tokenId))}),e.jsx("button",{onClick:Te,disabled:f||M.length===0||!i,className:"w-full px-4 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg disabled:opacity-50",title:i?"":"Connect wallet to unstake NFTs",children:f?"Unstaking...":`Unstake ${M.length} NFT${M.length!==1?"s":""}`})]})]})]})]})}function Ut(){return e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4 animate-fade-in",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-2xl",children:"🍃"})}),e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-green-400 via-emerald-500 to-teal-400 bg-clip-text text-transparent",children:"Stoner NFT Staking"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto",children:"Stake your Stoner NFTs to earn multiple token rewards and participate in the ecosystem"})]}),e.jsx(Ot,{})]})}const He={chainId:"0x92",chainName:"Sonic Network",rpcUrls:["https://rpc.sonic.org"],nativeCurrency:{name:"S",symbol:"S",decimals:18},blockExplorerUrls:["https://sonicscan.org"]};function _t({onNetworkReady:n}){const[a,r]=o.useState(null),[i,p]=o.useState(!1),[y,u]=o.useState(!1);o.useEffect(()=>{if(t(),window.ethereum)return window.ethereum.on("chainChanged",f),()=>window.ethereum.removeListener("chainChanged",f)},[]);const f=l=>{const h=parseInt(l,16);r(h),p(h===146),h===146&&(n==null||n(!0))},t=async()=>{if(window.ethereum)try{const l=await window.ethereum.request({method:"eth_chainId"}),h=parseInt(l,16);r(h),p(h===146),h===146&&(n==null||n(!0))}catch(l){console.warn("Failed to check network:",l)}},d=async()=>{if(window.ethereum){u(!0);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:He.chainId}]})}catch(l){if(l.code===4902)try{await window.ethereum.request({method:"wallet_addEthereumChain",params:[He]})}catch(h){console.error("Failed to add Sonic network:",h)}else console.error("Failed to switch to Sonic network:",l)}u(!1)}};return window.ethereum?!i&&a!==null?e.jsx("div",{className:"p-4 bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm",children:"🔄"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-800 dark:text-orange-200",children:"Wrong Network"}),e.jsx("p",{className:"text-sm text-orange-700 dark:text-orange-300",children:"Please switch to Sonic Network (Chain ID: 146)"})]})]}),e.jsx("button",{onClick:d,disabled:y,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg font-medium disabled:opacity-50 flex items-center gap-2 transition-colors",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Switching..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"🔄"}),"Switch to Sonic"]})})]})}):null:e.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm",children:"🦊"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-amber-800 dark:text-amber-200",children:"Wallet Required"}),e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Please install MetaMask or another Ethereum wallet to continue."})]})]})})}function Dt(){const{address:n,isConnecting:a,isCorrectNetwork:r,connectWallet:i,disconnect:p,switchToSonicNetwork:y,isConnected:u}=Be(),f=async()=>{try{await i()}catch(l){console.error("Failed to connect wallet:",l)}},t=async()=>{try{await y()}catch(l){console.error("Failed to switch network:",l)}},d=l=>l?`${l.slice(0,6)}...${l.slice(-4)}`:"";return u&&!r?e.jsx("button",{onClick:t,className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:"⚠️ Switch to Sonic"}):u?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-100 to-emerald-100 dark:from-green-900/50 dark:to-emerald-900/50 text-green-800 dark:text-green-200 rounded-xl font-semibold text-sm shadow-sm border border-green-200 dark:border-green-700",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),d(n)]}),e.jsx("button",{onClick:p,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",title:"Disconnect wallet",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsx("button",{onClick:f,disabled:a,className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 disabled:cursor-not-allowed",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Connecting..."]}):e.jsx(e.Fragment,{children:"🔗 Connect Wallet"})})}function zt(){const n=rt(),[a,r]=o.useState(()=>typeof window<"u"?localStorage.getItem("theme")!=="light":!0);return Ae.useEffect(()=>{document.documentElement.classList.toggle("dark",a),localStorage.setItem("theme",a?"dark":"light")},[a]),e.jsx(Nt,{children:e.jsx(xt,{children:e.jsxs("div",{className:"min-h-screen p-0 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:bg-gradient-to-br dark:from-zinc-900 dark:via-gray-900 dark:to-slate-900 text-gray-900 dark:text-gray-100",children:[e.jsx(_t,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-2 sm:p-4 md:p-6 w-full",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row items-center justify-between mb-8 py-6 px-4 sm:px-6 rounded-2xl shadow-xl bg-white/95 dark:bg-gray-800/95 backdrop-blur-lg gap-4 border border-gray-200 dark:border-gray-700 animate-slide-up",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 via-blue-500 to-teal-500 rounded-xl shadow-lg flex items-center justify-center group-hover:shadow-glow transition-all duration-300 overflow-hidden",children:[e.jsx("img",{src:"/pass-the-jpeg-logo.png",alt:"PASS THE JPEG Logo",className:"w-8 h-8 object-contain",onError:i=>{i.target.style.display="none",i.target.nextSibling.style.display="block"}}),e.jsx("span",{className:"text-white font-bold text-xl hidden",children:"🤝"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-extrabold bg-gradient-to-r from-indigo-600 via-blue-500 to-teal-400 bg-clip-text text-transparent",children:"PASS THE JPEG"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 hidden sm:block",children:"SWAP YOUR NFTS WITH NFTS IN THE SWAP POOLS"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[n.pathname==="/"&&e.jsx(Ue,{to:"/staking",className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:"🍃 Stoner Staking"}),n.pathname==="/staking"&&e.jsx(Ue,{to:"/",className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-600 hover:to-blue-600 text-white font-semibold text-sm shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:"← Back to Swap Pools"}),e.jsx(Dt,{}),e.jsx("button",{onClick:()=>r(!a),className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 transition-all duration-200 shadow-sm hover:shadow-md",title:"Toggle theme",children:e.jsx("span",{className:"text-lg",children:a?"🌙":"☀️"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-indigo-100 to-blue-100 dark:from-indigo-900/50 dark:to-blue-900/50 text-indigo-800 dark:text-indigo-200 rounded-xl font-semibold text-sm shadow-sm border border-indigo-200 dark:border-indigo-700",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Sonic Network"]})]})]}),e.jsx("main",{children:e.jsxs(it,{children:[e.jsx(_e,{path:"/",element:e.jsx(Pt,{})}),e.jsx(_e,{path:"/staking",element:e.jsx(Ut,{})})]})})]})]})})})}Je(document.getElementById("root")).render(e.jsx(Ae.StrictMode,{children:e.jsx(ot,{children:e.jsx(zt,{})})}));
